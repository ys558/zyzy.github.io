{"meta":{"title":"è‡ªç”±ã®ç¿¼å°æ ˆ","subtitle":"æŠ€æœ¯&ç”Ÿæ´»åˆ†äº«","description":"1111111111","author":"è‡ªç”±ã®ç¿¼","url":"https://zyzy.info","root":"/"},"pages":[],"posts":[{"title":"ç”¨esbuildåˆ›å»ºè‡ªå·±çš„jsç±»åº“npmåŒ…(æ›´æ–°ä¸­,æœªå®Œ)","slug":"ã€2022-03-20ã€‘ç”¨esbuildåˆ›å»ºè‡ªå·±çš„jsç±»åº“npmåŒ…(æ›´æ–°ä¸­,æœªå®Œ)","date":"2022-03-20T01:46:15.000Z","updated":"2022-03-26T03:26:24.864Z","comments":true,"path":"2022/03/20/ã€2022-03-20ã€‘ç”¨esbuildåˆ›å»ºè‡ªå·±çš„jsç±»åº“npmåŒ…(æ›´æ–°ä¸­,æœªå®Œ)/","link":"","permalink":"https://zyzy.info/2022/03/20/%E3%80%902022-03-20%E3%80%91%E7%94%A8esbuild%E5%88%9B%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84js%E7%B1%BB%E5%BA%93npm%E5%8C%85(%E6%9B%B4%E6%96%B0%E4%B8%AD,%E6%9C%AA%E5%AE%8C)/","excerpt":"å¾ˆä¹…æ²¡æœ‰æ›´æ–°, è¿™æ¬¡è¶ç€å‘¨æœ«æœ‰ç©º, èµ¶ç´§æŠŠå·¥ä½œä¸­ç¢°åˆ°çš„é—®é¢˜è¿›è¡Œä¸€æ¬¡æ€»ç»“. å¹¶è®°å½•ä¸‹æ¥.æœ€è¿‘ç¢°åˆ°éœ€è¦åˆ›å»ºnpmåŒ…çš„éœ€æ±‚, è¿™é‡ŒæŠŠä»–å½¢æˆæ–‡æ¡£è®°å½•ä¸‹æ¥.","text":"å¾ˆä¹…æ²¡æœ‰æ›´æ–°, è¿™æ¬¡è¶ç€å‘¨æœ«æœ‰ç©º, èµ¶ç´§æŠŠå·¥ä½œä¸­ç¢°åˆ°çš„é—®é¢˜è¿›è¡Œä¸€æ¬¡æ€»ç»“. å¹¶è®°å½•ä¸‹æ¥.æœ€è¿‘ç¢°åˆ°éœ€è¦åˆ›å»ºnpmåŒ…çš„éœ€æ±‚, è¿™é‡ŒæŠŠä»–å½¢æˆæ–‡æ¡£è®°å½•ä¸‹æ¥. å‰ç«¯çš„å˜åŒ–å®åœ¨æ˜¯å¿«, 1å¹´å¤šå‰ä»æ˜¯babelçš„å¤©ä¸‹, ç°åœ¨æ€å‡ºä¸ª esbuild , babelç”¨jsç¼–å†™, è€Œ esbuildç”¨æ›´å¿«çš„goè¯­éŸ³ç¼–å†™, ä»–ä¿©åœ¨webpackä¸­å‡æœ‰å¯¹åº”çš„æ’ä»¶å…³äºæ–°çš„æ‰“åŒ…å·¥å…· esbuild, ä»–æ”¯æŒæœ€åŸç”Ÿçš„es moduleè¯­æ³•.åœ¨æˆ‘çš„è¿™ç¯‡æ–‡ç« é‡Œå·²æœ‰å°†å…¶é…ç½®äºCRAçƒ­æ›´æ–°çš„æ“ä½œ, å¤§å®¶å¯ä»¥åšå‚è€ƒ.å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„åœ¨äºç»“åˆesbuildå®˜ç½‘, èµ°ä¸€éè‡ªå·±çš„é…ç½®çš„è¿‡ç¨‹, é¡ºä¾¿æŠŠwebpackçš„é…ç½®è¿›ä¸€ä¸‹å¯¹æ¯”. æœ€åŸºç¡€çš„webpackåŠesbuildé…ç½® ä»æœ€åŸºç¡€çš„é…ç½®å¼€å§‹, yarn init ç”Ÿæˆ package.json æ–‡ä»¶, å¹¶å®‰è£… yarn add esbuild webpack webpack-cli ä¸¤ä¸ªå·¥å…·. å°†åŒ…åæ”¹ä¸ºmylib, åŠ ä¸Š script , é…ç½® &quot;type&quot;: &quot;module&quot;ä¸ºå¯ä»¥ç”¨esmè¯­æ³• 1234567891011121314151617&#123; &quot;name&quot;: &quot;mylib&quot;, &quot;version&quot;: &quot;1.0.0&quot;, &quot;description&quot;: &quot;&quot;, &quot;main&quot;: &quot;index.js&quot;, &quot;author&quot;: &quot;ys558&quot;, &quot;scripts&quot;: &#123; &quot;wp-build&quot;: &quot;webpack&quot;, &quot;es-build&quot;: &quot;esbuild --bundle src/index.js --outfile=dist/myLib.esbuild.bundle.js --minify&quot; &#125;, &quot;devDependencies&quot;: &#123; &quot;esbuild&quot;: &quot;^0.14.27&quot;, &quot;webpack&quot;: &quot;^5.70.0&quot;, &quot;webpack-cli&quot;: &quot;^4.9.2&quot; &#125;, &quot;type&quot;: &quot;module&quot;&#125; æ–°å»º scr/index.js å’Œ src/moduleA.js, éšä¾¿å†™ä¸‹ä¸€äº›ä¸œè¥¿, ç”¨ä¸Šesmè¯­æ³•: 123// src/moduleA.jsconst moduleA = &#x27;module A&#x27;export default moduleA 1234567891011121314151617181920// src/index.jsimport moduleA from &quot;./moduleA.js&quot;;const valueA = &quot;function A&quot;, valueB = &quot;function B&quot;;export function functionA() &#123; return valueA;&#125;class ClassA &#123; constructor(param)&#123; this.param = param; &#125;&#125;const A = new ClassA(&#x27;a&#x27;);console.log(functionA())console.log(moduleA)console.log(&#x27;param of classA&#x27;, A.param) åˆ†åˆ«è·‘ yarn run wp-build å’Œ yarn run es-build, å¯çœ‹åˆ°æ‰“åŒ…å‡ºæ¥distçš„ä¸¤ä¸ªæ–‡ä»¶, 123dist |__main.js |__myLib.esbuild.bundle.js æ— è®ºwebpackè¿˜æ˜¯esbuild, å‡é»˜è®¤ç”Ÿæˆdist/main.js . æ‰€ä»¥ä¸¤ä¸ªå‘½ä»¤åˆ†åˆ«è¿è¡Œ, ä¼šè¦†ç›–æ‰åŸæ¥çš„dist/main.jsæ–‡ä»¶ myLib.esbuild.bundle.js æ–‡ä»¶ç”±æˆ‘ä»¬æŒ‡å®šçš„es scriptç”Ÿæˆçš„, è€Œwebpackçš„é…ç½®æ˜¯è¦å†™åœ¨ webpack.config.js é‡Œå»é…ç½®. é…ç½® webpack.config.js æ–‡ä»¶å¦‚ä¸‹: 1234567891011121314151617181920// path å’Œ url å‡å±äºnodeçš„å†…ç½®æ¨¡å—, å‡æ˜¯ commonJS æ¨¡å—, æ‰€ä»¥ è¿™é‡Œé‡Œä¸æ”¯æŒç›´æ¥è§£æ„å¯¼å…¥: // import &#123; fileURLToPath &#125; from &#x27;url&#x27;; &lt;-- é”™è¯¯// åªèƒ½å†™æˆä»¥ä¸‹å½¢å¼: å…ˆæ•´ä½“å¯¼å…¥å†è§£æ„:import url from &#x27;url&#x27;;import path from &#x27;path&#x27;;const &#123; fileURLToPath &#125; = urlconst &#123; dirname &#125; = pathconst __filename = fileURLToPath(import.meta.url);const __dirname = dirname(__filename);const webpackConfig = &#123; entry: &#x27;./src/index.js&#x27;, output: &#123; path: path.resolve(__dirname, &#x27;dist&#x27;), filename: &#x27;myLib.webpack.bundle.js&#x27;, &#125;,&#125;;export default webpackConfig å†è·‘ yarn run wp-build å¯å‘ç°æ‰“åŒ…å‡ºäº†ä¸¤ä¸ªæ–‡ä»¶: 123dist |__myLib.webpack.bundle.js |__myLib.esbuild.bundle.js","categories":[],"tags":[{"name":"esbuild","slug":"esbuild","permalink":"https://zyzy.info/tags/esbuild/"},{"name":"webpack","slug":"webpack","permalink":"https://zyzy.info/tags/webpack/"}]},{"title":"Mono Repo ç®€ä»‹åŠå®ç°æ–¹æ³•","slug":"ã€2021-11-09ã€‘MonoRepoç®€ä»‹åŠå®ç°æ–¹æ³• copy","date":"2021-11-09T03:23:15.000Z","updated":"2022-03-26T03:20:31.975Z","comments":true,"path":"2021/11/09/ã€2021-11-09ã€‘MonoRepoç®€ä»‹åŠå®ç°æ–¹æ³• copy/","link":"","permalink":"https://zyzy.info/2021/11/09/%E3%80%902021-11-09%E3%80%91MonoRepo%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95%20copy/","excerpt":"æœ¬æ–‡ä»‹ç»ç§æœ‰ä»“åº“åŒ…çš„ç®¡ç†æ¨¡å¼ mono repo","text":"æœ¬æ–‡ä»‹ç»ç§æœ‰ä»“åº“åŒ…çš„ç®¡ç†æ¨¡å¼ mono repo mono repoçš„å¥½å¤„mono repoçš„å¥½å¤„æ¥æºäºè¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ç”¨è‡ªå·±ç›´ç™½ç‚¹çš„è¯æ€»ç»“äº†ä»¥ä¸‹å‡ ç‚¹ï¼š å¤šä¸ªå†…éƒ¨æ¨¡å—å¯ä»¥é›†ä¸­ç®¡ç† åªéœ€åœ¨æ ¹ç›®å½•å®‰è£… node_modules å³å¯ï¼Œæ— é¡»æ‰€æœ‰æ¨¡å—éƒ½å®‰è£… ä¾‹å¦‚ï¼Œä¸€ä¸ªæœ‰å¤šç«¯çš„é¡¹ç›®ï¼Œè€Œä¸”æ¯ä¸ªç«¯éƒ½é¥®ç”¨äº†å…±æœ‰çš„æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰é¡¹ç›®æˆ–åŒ…æ”¾åˆ°ä¸€ä¸ªpackagesä¸­é›†ä¸­ç®¡ç† ä¾‹å¦‚æˆ‘ä»¬å¹³æ—¶ç†Ÿæ‚‰çš„reactï¼Œbabelç­‰åº“çš„æºç ï¼Œéƒ½æ˜¯é‡‡ç”¨mono repoè¿›è¡Œä»“åº“ç®¡ç†ã€‚ æˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸¤ä¸ªåº“ï¼Œyarn workspace å’Œ lernaï¼Œ ä»¥ä¸‹çš„é¡¹ç›®ç¤ºä¾‹é‡Œï¼Œå‰è€…ç”¨äºä¾èµ–ç®¡ç†ï¼Œåè€…ç”¨äºå¤„ç†å‘å¸ƒé—®é¢˜ï¼Œåœ¨ç‰ˆæœ¬å‘å¸ƒè¿™å—ï¼Œä½¿ç”¨lernaæ›´æ–¹ä¾¿ï¼Œå¯ç”¨äºæ›¿ä»£ä¸€éƒ¨åˆ†çš„gitçš„åŠŸèƒ½ã€‚ å½“ç„¶ lerna ä¹Ÿå¯ä»¥ç›´æ¥æ›¿ä»£ yarn workspace çš„åŠŸèƒ½ã€‚ yarn workspace ç®¡ç†ä¾èµ–123mkdir common servercd common &amp;&amp; yarn init -y &amp;&amp; touch index.jscd ../server/ &amp;&amp; yarn init -y &amp;&amp; touch index.js package.json é…ç½® workspacespackage.jsonï¼Œå°† common, server ä¸¤ä¸ªæ–‡ä»¶å¤¹è§†ä¸ºä¸¤ä¸ªpackageåŒ… 1234&#123; &quot;private&quot;: true, &quot;workspaces&quot;: [ &quot;packages/*&quot; ]&#125; å»ºä¸€ä¸ªç®€å•çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 1234567root |__package.json |__packages |__common |__package.json |__server |__package.json å‡è®¾åœ¨commonåŒ…é‡Œå®‰è£…reactå’Œreact-domï¼Œåˆ™ç›´æ¥æ‰§è¡Œï¼š 1yarn workspace common add react react-dom --dev yarn workspace çš„å…·ä½“ç”¨æ³•ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ è‡ªå·±å†™çš„åŒ…è¦ç›¸äº’å¼•ç”¨çš„æ–¹æ³•æˆ‘ä»¬æŠŠä¸Šé¢çš„ç›®å½•ç»“æ„ common åŒ…å’Œ server å„è‡ªæ·»åŠ index.jsï¼Œå¦‚ä¸‹ï¼š 123456789root |__package.json |__packages |__common |__index.js |__package.json |__server |__index.js |__package.json packages\\common\\index.js é‡Œå†™ç‚¹ç®€å•çš„ä¸œè¥¿ï¼š 1module.exports = () =&gt; console.log(&#x27;hello fr common&#x27;) packages\\server\\index.js 12// è¿™é‡Œçš„ &quot;common&quot; å¯¹åº” common\\package.json é‡Œçš„ &quot;name&quot;ï¼Œå³ç›´æ¥å¼•ç”¨commonä½œä¸ºä¾èµ–åŒ…const commonFn = require(&quot;@mono-repo-by-yarn-lerna/common&quot;); common\\package.json é‡Œï¼Œç¤¾åŒºé‡Œçš„ä¹ æƒ¯æ€§åšæ³•æ˜¯åŠ ä¸Šå‰ç¼€@é¡¹ç›®åç§°/ï¼Œå¦‚ï¼š 123456789&#123; &quot;name&quot;: &quot;@mono-repo-by-yarn-lerna/common&quot;, &quot;version&quot;: &quot;1.0.0&quot;, &quot;main&quot;: &quot;index.js&quot;, &quot;license&quot;: &quot;MIT&quot;, &quot;dependencies&quot;: &#123; &quot;@mono-repo-by-yarn-lerna/common&quot;: &quot;1.0.0&quot; &#125;&#125; server\\package.json è¿è¡Œ yarn installï¼Œä¼šçœ‹åˆ°ä»¥ä¸‹ï¼Œè¯æ˜åœ¨serveræ–‡ä»¶å¤¹æˆåŠŸå®‰è£…commonæ–‡ä»¶å¤¹ä½œä¸ºä¾èµ– 12345678$ yarnyarn install v1.22.10[1/4] Resolving packages...[2/4] Fetching packages...[3/4] Linking dependencies...[4/4] Building fresh packages...success Saved lockfile.Done in 0.16s. è¿”å›æ ¹ç›®å½•è¿è¡Œ ls node_modules/ å¯ä»¥çœ‹åˆ°å¤šäº† â€˜@mono-repo-by-yarn-lernaâ€™ / ä¸ºé¡¹ç›®çš„ä¸œè¥¿ 12$ ls node_modules/&#x27;@mono-repo-by-yarn-lerna&#x27;/ è¿è¡Œ node server/index.js å¯ä»¥çœ‹åˆ°è¿è¡Œçš„ç»“æœï¼š 12$ node packages/server/index.js hello fr common å¦‚æœæ­¤æ—¶æˆ‘ä»¬å†åœ¨ server æ–‡ä»¶å¤¹é‡Œæ·»åŠ å…¶ä»–æ¨¡å—ï¼Œä¾‹å¦‚ babelï¼Œè¿è¡Œ yarn add babelï¼Œ ä¼šå‘ç° server æ–‡ä»¶å¤¹é‡Œçš„ node_modules åªæ”¾äº† babel çš„ä¸€äº›æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶ä½™ babel çš„æ ¸å¿ƒæ–‡ä»¶å…¨éƒ¨è¢«ç§»åŠ¨åˆ°æ ¹ç›®å½•é‡Œçš„ node_modulesï¼Œä»¥æ­¤è¾¾åˆ°é›†ä¸­ç®¡ç†ä¾èµ–çš„ç›®çš„ Lerna A tool for managing JavaScript projects with multiple packages. Lerna æ˜¯å¸Œè…Šç¥è¯é‡Œä¸€å¤šå¤´æ€ªç‰©ï¼Œä¼°è®¡ä½œè€…æƒ³ä»–å¤šå¤´å¤„ç†å¤šä¸ªåŒ… åœ¨æˆ‘ä»¬ä¸Šé¢é¡¹ç›®çš„åŸºç¡€ä¸Šï¼Œæ ¹ç›®å½•æ·»åŠ lernaï¼Œyarn add -D -W lernaï¼Œ-Wè¡¨ç¤ºè·Ÿåœ¨æœ¬é¡¹ç›®çš„ workspace é‡Œç›´æ¥å®‰è£…ï¼Œå³æ ¹ç›®å½• npx lerna init packages\\common\\package.json å’Œ packages\\server\\package.json å‡åŠ ä¸Štestå‘½ä»¤ 123&quot;scripts&quot;: &#123; &quot;test&quot;: &quot;echo testing server with version: $npm_package_version&quot;&#125; 12345678&#123; &quot;packages&quot;: [ &quot;packages/*&quot; ], &quot;version&quot;: &quot;0.0.0&quot;, + &quot;npmClient&quot;: &quot;yarn&quot;, + &quot;useWorkspaces&quot;: true&#125; å¦‚æœè¦æ‰§è¡Œå•ä¸ª package.json é‡Œçš„å‘½ä»¤ï¼Œåˆ™éœ€åŠ ä¸Š --scope=@åŒ…åï¼Œå¦‚ 123&quot;scripts&quot;: &#123; &quot;test&quot;: &quot;lerna run test --scope=@mono-repo-by-yarn-lerna/common&quot;&#125; å¦‚æŒ‡å®šå¤šä¸ªæ¨¡å—ï¼Œåªéœ€æ”¾åœ¨&#123;&#125;é‡Œï¼Œå¦‚ï¼š 123&quot;scripts&quot;: &#123; &quot;test-since&quot;: &quot;lerna run test --scope=&#123;@mono-repo-by-yarn-lerna/common,@mono-repo-by-yarn-lerna/server&#125;&quot;&#125; lerna version å‘å¸ƒç‰ˆæœ¬æ¥ä¸Šé¢ï¼Œç”¨ new-version å‘½ä»¤è¿›è¡Œå‘ç‰ˆï¼Œæ‰§è¡Œçš„æ˜¯ lerna versionã€‚åé¢çš„å‚æ•° convential commits æ˜¯ä¸€ä¸ªç”¨äºä¼˜åŒ– git commit å†…å®¹çš„åº“ï¼Œå¯ä»¥æ·»åŠ commitsæ ‡é¢˜æ­£æ–‡æ³¨è„šä»€ä¹ˆçš„ï¼ŒæŒºæœ‰è¶£ï¼Œvs code é‡Œä¹Ÿæœ‰åŒåçš„æ’ä»¶ test è„šæœ¬åŠ ä¸Š --since å‚æ•°å¯ä»¥çœ‹åˆ°æäº¤ç‰ˆæœ¬çš„å†å²ï¼š 123&quot;scripts&quot;: &#123; &quot;test&quot;: &quot;lerna run test --since&quot;&#125;","categories":[],"tags":[{"name":"mono repo","slug":"mono-repo","permalink":"https://zyzy.info/tags/mono-repo/"},{"name":"yarn","slug":"yarn","permalink":"https://zyzy.info/tags/yarn/"},{"name":"lerna","slug":"lerna","permalink":"https://zyzy.info/tags/lerna/"},{"name":"conventional commit","slug":"conventional-commit","permalink":"https://zyzy.info/tags/conventional-commit/"}]},{"title":"esbuilç”¨äºcreate-react-appé¡¹ç›®çš„çƒ­æ›´æ–°å¼€å‘","slug":"ã€2021-10-28ã€‘ç”¨esbuilåˆ›å»ºReacté¡¹ç›®","date":"2021-10-28T06:53:06.000Z","updated":"2022-03-26T02:15:30.413Z","comments":true,"path":"2021/10/28/ã€2021-10-28ã€‘ç”¨esbuilåˆ›å»ºReacté¡¹ç›®/","link":"","permalink":"https://zyzy.info/2021/10/28/%E3%80%902021-10-28%E3%80%91%E7%94%A8esbuil%E5%88%9B%E5%BB%BAReact%E9%A1%B9%E7%9B%AE/","excerpt":"webpack ç”¨äºå¤§å‹é¡¹ç›®ä¸­ï¼Œç‰¹åˆ«æ˜¯å¼€å‘æ—¶å€™çš„çƒ­æ›´æ–°ï¼Œé€Ÿåº¦å¤ªæ…¢ï¼ŒåŸå› æ˜¯webpack é‡‡ç”¨äº†æ•´ä¸ªé¡¹ç›®æ‰€æœ‰æ–‡ä»¶ä¸€èµ·æ‰“åŒ…çš„æ–¹æ¡ˆã€‚ è‡ªä» vite æ¨å‡ºä»¥æ¥ï¼Œæ‰“åŒ…è¿™å—åšåˆ°äº†æ€§èƒ½ä¸Šçš„è¶…è¶Šã€‚vite çš„åŸç†æ˜¯åœ¨SPAé¡¹ç›®ä¸­ï¼ŒåŸºäºå…¥å£æ–‡ä»¶æ‰“åŒ…çš„ï¼Œç”±äºåªæ‰“åŒ…ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥é€Ÿåº¦å°±ä¸Šæ¥äº†ã€‚ è€Œæ— è®ºæ˜¯ vite å’Œ webpack å‡æ˜¯åŸºäº esbuild å¼€å‘çš„ã€‚æ‰€ä»¥ç ”ç©¶ä¸€ä¸‹ esbuild çš„é…ç½®æ˜¯æ¯”è¾ƒæœ‰ä»·å€¼çš„ã€‚ æœ¬é¡¹ç›®æ˜¯åŸºäº create-react-app åˆ›å»ºé¡¹ç›®ï¼Œå†ç”¨ es-build ä½œä¸ºå¼€å‘çƒ­æ›´æ–°æ‰“åŒ…ã€‚","text":"webpack ç”¨äºå¤§å‹é¡¹ç›®ä¸­ï¼Œç‰¹åˆ«æ˜¯å¼€å‘æ—¶å€™çš„çƒ­æ›´æ–°ï¼Œé€Ÿåº¦å¤ªæ…¢ï¼ŒåŸå› æ˜¯webpack é‡‡ç”¨äº†æ•´ä¸ªé¡¹ç›®æ‰€æœ‰æ–‡ä»¶ä¸€èµ·æ‰“åŒ…çš„æ–¹æ¡ˆã€‚ è‡ªä» vite æ¨å‡ºä»¥æ¥ï¼Œæ‰“åŒ…è¿™å—åšåˆ°äº†æ€§èƒ½ä¸Šçš„è¶…è¶Šã€‚vite çš„åŸç†æ˜¯åœ¨SPAé¡¹ç›®ä¸­ï¼ŒåŸºäºå…¥å£æ–‡ä»¶æ‰“åŒ…çš„ï¼Œç”±äºåªæ‰“åŒ…ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥é€Ÿåº¦å°±ä¸Šæ¥äº†ã€‚ è€Œæ— è®ºæ˜¯ vite å’Œ webpack å‡æ˜¯åŸºäº esbuild å¼€å‘çš„ã€‚æ‰€ä»¥ç ”ç©¶ä¸€ä¸‹ esbuild çš„é…ç½®æ˜¯æ¯”è¾ƒæœ‰ä»·å€¼çš„ã€‚ æœ¬é¡¹ç›®æ˜¯åŸºäº create-react-app åˆ›å»ºé¡¹ç›®ï¼Œå†ç”¨ es-build ä½œä¸ºå¼€å‘çƒ­æ›´æ–°æ‰“åŒ…ã€‚ ä¸æ”¹åŠ¨CRAç”Ÿæˆçš„åŸºç¡€ç»“æ„ä¸‹çš„æ”¹åŠ¨ç”¨ create-react-app ç”Ÿæˆé¡¹ç›®åï¼Œç„¶åå¯¹åŸæ¥çš„é¡¹ç›®ä½œäº†å¦‚ä¸‹æ”¹åŠ¨ï¼š ç”Ÿæˆ devBuild.js æ–‡ä»¶ï¼Œè¿›è¡Œå¦‚ä¸‹æ”¹åŠ¨ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273import browserSync from &quot;browser-sync&quot;;import chalk from &quot;chalk&quot;;import commandLineArgs from &quot;command-line-args&quot;;import del from &quot;del&quot;;import esbuild from &quot;esbuild&quot;;import getPort from &quot;get-port&quot;;import svgrPlugin from &quot;esbuild-plugin-svgr&quot;;// åˆ›å»ºæœåŠ¡å™¨ã€‚const bs = browserSync.create();// è§£æ„ç¯å¢ƒå˜é‡const &#123; dev &#125; = commandLineArgs(&#123; name: &quot;dev&quot;, type: Boolean &#125;);// åˆ é™¤æ–‡ä»¶å¤¹ public ä¸­çš„æ‰“åŒ…æ–‡ä»¶å¤¹del.sync(&quot;./public/dist&quot;);// å¼€å§‹ esbuild æ‰“åŒ…(async () =&gt; &#123; const buildResult = await esbuild .build(&#123; format: &quot;esm&quot;, // è®¾ç½®ç”Ÿæˆçš„ JavaScript æ–‡ä»¶çš„è¾“å‡ºæ ¼å¼ã€‚ target: &quot;es2017&quot;, // ç¼–è¯‘è½¬åŒ–ç‰ˆæœ¬ entryPoints: [&quot;./src/index.jsx&quot;], // æ‰“åŒ…å…¥å£ outdir: &quot;./public/dist&quot;, // è¾“å‡ºç›®å½• chunkNames: &quot;chunks/[name].[hash]&quot;, // æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å incremental: dev, // å› ä¸ºæˆ‘ä»¬ç›‘å¬æ–‡ä»¶çš„æ”¹å˜é‡æ–°æ‰“åŒ…ï¼Œè€Œä¸”æˆ‘ä»¬è¦å¼€å‘ç¯å¢ƒä½¿ç”¨esbuild æ‰€ä»¥ dev ä¸º true loader: &#123; // æ­¤é€‰é¡¹æ›´æ”¹ç»™å®šè¾“å…¥æ–‡ä»¶çš„è§£é‡Šæ–¹å¼ã€‚ &quot;.svg&quot;: &quot;text&quot;, &quot;.png&quot;: &quot;dataurl&quot;, &#125;, bundle: true, // æ†ç»‘æ–‡ä»¶æ„å‘³ç€å°†ä»»ä½•å¯¼å…¥çš„ä¾èµ–é¡¹å†…è”åˆ°æ–‡ä»¶æœ¬èº«ä¸­ã€‚ splitting: true, // ä»£ç æ‹†åˆ†ç›®å‰ä»…é€‚ç”¨äºesmè¾“å‡ºæ ¼å¼ã€‚ plugins: [svgrPlugin()], inject: [&quot;./public/react-shim.js&quot;], // å°† React ä½œä¸ºå…¨å±€å˜é‡å¯¼å…¥esbuild &#125;) .catch((err) =&gt; &#123; console.error(chalk.red(err)); process.exit(1); &#125;); console.log(chalk.green(&quot;The build has finished! ğŸ“¦\\n&quot;)); // è·å–å¯ä»¥ä½¿ç”¨çš„ç«¯å£å· const port = await getPort(&#123; port: getPort.makeRange(4000, 4999), &#125;); console.log( chalk.cyan( `Launching the Shoelace dev server at http://localhost:$&#123;port&#125;! ğŸ¥¾\\n` ) ); // æœåŠ¡å™¨åˆå§‹åŒ– bs.init(&#123; startPath: &quot;/&quot;, // åˆå§‹è·¯å¾„ port, // ç«¯å£å· logLevel: &quot;silent&quot;, // æ—¥å¿—çº§åˆ« logFileChanges: true, // æ—¥å¿—æ–‡ä»¶æ›´æ”¹ notify: true, // æµè§ˆå™¨ä¸­çš„å°å¼¹å‡ºé€šçŸ¥ single: true, // æä¾›å•ç‹¬çš„ index.html server: &#123; baseDir: &quot;public&quot;, // åŸºç¡€æ–‡ä»¶å¤¹ index: &quot;index.html&quot;, // è®¾ç½®æœåŠ¡å™¨çš„å…¥å£æ–‡ä»¶ &#125;, files: &quot;src/&quot;, // ç›‘å¬ src ä¸‹çš„æ–‡ä»¶ &#125;); // ç›‘å¬ src æ–‡ä»¶å¤¹ä¸‹çš„æ›´æ”¹ bs.watch([&quot;src/&quot;]).on(&quot;change&quot;, async (filename) =&gt; &#123; console.log(`Source file changed - $&#123;filename&#125;`); // é‡æ–°æ‰“åŒ… buildResult.rebuild(); &#125;);&#125;)(); ä¾èµ–å®‰è£…ï¼š æ ¸å¿ƒ: esbuild,esbuild-plugin-svgrç”¨äºåˆ›å»ºæœåŠ¡æ¸²æŸ“æ‰“åŒ…æ–‡ä»¶ï¼š browser-syncè§£æå‘½ä»¤è¡Œå‚æ•°: command-line-argsæ‰“åŒ…æ–‡ä»¶åˆ é™¤ï¼šdelè·å–å½“å‰å¯ç”¨ç«¯å£ï¼šget-portç¾åŒ–ï¼šchalk package.json çš„ script å¢åŠ äº† dev å‘½ä»¤ï¼Œä¸ºè·‘ devBuild.js æ–‡ä»¶ package.json å¢åŠ äº† &#123;&quot;type&quot;: &quot;module&quot;&#125; è®© node å¯ä»¥ç¼–è¯‘ esm è¯­æ³• å°† public/index.html æ–‡ä»¶å¢åŠ å¦‚ä¸‹ï¼š 123456...&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./dist/index.css&quot; /&gt;...&lt;script type=&quot;module&quot;&gt; import &#x27;./dist/index.js&#x27;&lt;/script&gt; å¢åŠ  public/react-shim.js æ–‡ä»¶ï¼Œå¹¶åœ¨ devBuild.jså†™å…¥ç›¸åº”é…ç½®ï¼Œåœ¨srcä¸­å°±ä¸ç”¨åˆ°å¤„å¼•å…¥Reactäº†ï¼š 12import * as React from &#x27;react&#x27;export &#123; React &#125; æºç åœ¨è¿™é‡Œ","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://zyzy.info/tags/React/"},{"name":"esbuild","slug":"esbuild","permalink":"https://zyzy.info/tags/esbuild/"},{"name":"webpack","slug":"webpack","permalink":"https://zyzy.info/tags/webpack/"}]},{"title":"Webæ€§èƒ½ä¼˜åŒ–ï¼ˆæœ€åæ›´æ–°æ—¶é—´ï¼š2021-10-26ï¼‰","slug":"ã€2021-05-30ã€‘Webæ€§èƒ½ä¼˜åŒ–ï¼ˆæŒç»­æ›´æ–°ï¼‰","date":"2021-10-26T09:38:14.000Z","updated":"2022-03-26T02:15:30.412Z","comments":true,"path":"2021/10/26/ã€2021-05-30ã€‘Webæ€§èƒ½ä¼˜åŒ–ï¼ˆæŒç»­æ›´æ–°ï¼‰/","link":"","permalink":"https://zyzy.info/2021/10/26/%E3%80%902021-05-30%E3%80%91Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/","excerpt":"æœ¬æ–‡æ ¹æ®è¿™ç¯‡æ–‡ç« ï¼šBest Practices for Speeding Up Your Web Siteï¼Œè¢«ç§°ä½œâ€é›…è™35æ¡å†›è§„â€ï¼Œè™½é‡Œé¢æœ‰çš„ä¸œè¥¿è™½è¯´ä¹Ÿå·²ç»è¿‡æ—¶ï¼Œä½†å¯ä»¥ç”±æ­¤çª¥æ¢å‰ç«¯å‘å±•çš„å†ç¨‹ï¼Œä¸€äº›è¿‡æ—¶çš„å»ºè®®ä¼šç•¥å»è§£é‡Šã€‚","text":"æœ¬æ–‡æ ¹æ®è¿™ç¯‡æ–‡ç« ï¼šBest Practices for Speeding Up Your Web Siteï¼Œè¢«ç§°ä½œâ€é›…è™35æ¡å†›è§„â€ï¼Œè™½é‡Œé¢æœ‰çš„ä¸œè¥¿è™½è¯´ä¹Ÿå·²ç»è¿‡æ—¶ï¼Œä½†å¯ä»¥ç”±æ­¤çª¥æ¢å‰ç«¯å‘å±•çš„å†ç¨‹ï¼Œä¸€äº›è¿‡æ—¶çš„å»ºè®®ä¼šç•¥å»è§£é‡Šã€‚ ä¸€é“é¢è¯•é¢˜å¼•å‘çš„å‰ç«¯æ€§èƒ½ä¼˜åŒ–æ€è€ƒç›¸ä¿¡å¤§å®¶éƒ½ç¢°è¿‡è¿™é“ç»å…¸é¢è¯•é¢˜ï¼šåœ¨æµè§ˆå™¨è¾“å…¥urlåˆ°çœ‹åˆ°é¡µé¢çš„å±•ç¤ºï¼Œè¿™ä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ æ€»ä½“ç­”æ¡ˆæ˜¯è¿™æ ·ï¼š æµè§ˆå™¨è¾“å…¥åŸŸåï¼ˆDomainï¼‰ â€”â€”&gt; DNSæœåŠ¡å™¨è§£ææˆIPåœ°å€ ï¼ˆå¦‚ï¼š12.220.12.123ï¼‰ é€šè¿‡å±€åŸŸç½‘ â€”â€”&gt; äº¤æ¢æœº â€”â€”&gt; è·¯ç”±å™¨ â€”â€”&gt; ä¸»å¹²ç½‘ â€”â€”&gt; æœåŠ¡ç«¯ å»ºç«‹TCPè¿æ¥ æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚ï¼ŒæŸ¥åº“ï¼Œè¯»æ–‡ä»¶ç­‰ï¼Œ æ‹¼æ¥å¥½responseï¼Œå³è¿”å›çš„HTTPå“åº” æµè§ˆå™¨æ”¶åˆ°é¦–å±htmlé¡µé¢ï¼Œå¼€å§‹æ¸²æŸ“ è§£æ html ä¸º DOM-tree è§£æ CSS ä¸º CSS-tree DOM-tree + CSS-tree ç”Ÿæˆ render-tree ç»˜å›¾ æ ¹æ®é¡µé¢èŠ‚ç‚¹çš„æ”¹å˜ï¼Œæ ·å¼çš„æ”¹å˜ç­‰ï¼Œå‘ç”Ÿé‡ç»˜ä¸å›æµ æ‰€è°“çš„æ€§èƒ½ä¼˜åŒ–ï¼Œå°±æ˜¯ä¸Šé¢çš„æ­¥éª¤åŠ åœ¨ä¸€èµ·ï¼Œæ—¶é—´å°½å¯èƒ½çŸ­ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªè¿‡ç¨‹ç§3ç‚¹å…³é”®çš„ä¼˜åŒ–å› ç´ ï¼š å‡å°‘httpè¯·æ±‚ï¼Œç¼©å°httpè¯·æ±‚å¤§å° å‡å°‘æ–‡ä»¶å¤§å° å°‘æ‰§è¡Œä»£ç  å¤§æ¦‚ä¼˜åŒ–ç‚¹ï¼Œå®é™…å·¥ä½œç§è¿˜è¦ç»“åˆåœºæ™¯æ‰èƒ½åšå‡ºä¼˜åŒ–ï¼š DNS é€šè¿‡ç¼“å­˜å‡å°‘DNSæŸ¥è¯¢æ—¶é—´ ç½‘ç»œè¯·æ±‚è¿‡ç¨‹èµ°æœ€è¿‘çš„ç½‘ç»œç¯å¢ƒ ç›¸åŒé™æ€èµ„æºæ˜¯å¦å¯ç¼“å­˜ å‡å°httpè¯·æ±‚å¤§å° å‡å°‘httpè¯·æ±‚ æœåŠ¡çš„æ¸²æŸ“ ç½‘é¡µæ€§èƒ½æ£€æµ‹å·¥å…·é¦–å…ˆåº”æ˜ç¡®æ£€æµ‹ç½‘é¡µæ‰€éœ€çš„å·¥å…·ï¼Œè¿™é‡Œåˆ—ä¸¾äº†3ç§æ–¹æ³•ï¼š è°·æ­Œæ¨å‡ºçš„æ€§èƒ½æ£€æµ‹ç½‘ç«™web.devä»ä¸‰ä¸ªæŒ‡æ ‡å¯¹ç½‘ç«™æ€§èƒ½è¿›è¡Œè¯„ä¼° Largest Contentful Paint (LCP) ï¼šæœ€å¤§å†…å®¹ç»˜åˆ¶ï¼Œæµ‹é‡åŠ è½½æ€§èƒ½ã€‚ä¸ºäº†æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼ŒLCP åº”åœ¨é¡µé¢é¦–æ¬¡å¼€å§‹åŠ è½½åçš„2.5 ç§’å†…å‘ç”Ÿã€‚ First Input Delay (FID) ï¼šé¦–æ¬¡è¾“å…¥å»¶è¿Ÿï¼Œæµ‹é‡äº¤äº’æ€§ã€‚ä¸ºäº†æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œé¡µé¢çš„ FID åº”ä¸º100 æ¯«ç§’æˆ–æ›´çŸ­ã€‚ Cumulative Layout Shift (CLS) ï¼šç´¯ç§¯å¸ƒå±€åç§»ï¼Œæµ‹é‡è§†è§‰ç¨³å®šæ€§ã€‚ä¸ºäº†æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œé¡µé¢çš„ CLS åº”ä¿æŒåœ¨ 0.1. æˆ–æ›´å°‘ã€‚ è¯¥ç½‘ç«™å¯ä»¥è¾“å…¥ç½‘å€åè¿›è¡Œæµ‹è¯•ï¼Œç»™å‡ºä¸€ä»½è¯¦ç»†çš„ lighthouse æŠ¥å‘Š Navigator.sendBeacon() åŸ‹ç‚¹ä¼ è¾“æ•°æ®ç»™æœåŠ¡å™¨è®°å½•æ—¶é—´ä¾æ®googleä»¥ä¸Š3åŸåˆ™ï¼Œå¯ä»¥åœ¨å‰ç«¯è¿›è¡ŒåŸ‹ç‚¹ï¼Œè¿›è¡Œç»Ÿè®¡ 12345678910import &#123; getCLS, getFID, getLCP &#125; from &#x27;web-vitals&#x27;function sendToAnalytics(metric) &#123; const body = JSON.stringify(metric); navigator.sendBeacon(&#x27;/analytics&#x27;, body))&#125;getCLS(sendToAnalytics);getFID(sendToAnalytics);getLCP(sendToAnalytics); window.performanceæ‰“å¼€ä»»æ„ç½‘é¡µï¼Œæ§åˆ¶å°è¾“å…¥ä»¥ä¸‹ä»£ç ï¼Œå¯ä»¥çœ‹åˆ° window.performance æ‰€è·å–åˆ°çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹ä»–çš„timingå±æ€§ï¼Œç”¨å¼€å§‹æ—¶é—´å‡å»ç»“æŸæ—¶é—´å¾—å‡ºå„ç§èµ„æºåŠ è½½çš„æ—¶é—´ã€‚ä»¥ä¸‹çš„æ•°å€¼éƒ½ç®—æ˜¯æ¯”è¾ƒç²—ç•¥çš„æ•°å€¼ 12345678const t = window.performance.timing;console.log(&#123; &quot;DNS&quot;: t.domainLookupEnd - t.domainLookupStart, &quot;TCP&quot;: t.connectEnd - t.connectStart, &quot;è·å¾—é¦–å­—èŠ‚è€—è´¹æ—¶é—´ï¼ŒTTFB&quot;: t.responseStart - t.navigationStart, &quot;domReadyæ—¶é—´&quot;: t.domContentLoadedEventStart - t.navigationStart, &quot;DOMèµ„æºä¸‹è½½&quot;: t.responseEnd - t.responseStart&#125;) ç¬¬ä¸€å­—èŠ‚å“åº”æ—¶é—´ï¼ˆTTFBï¼‰= ä»å‘é€è¯·æ±‚åˆ°WEBæœåŠ¡å™¨çš„æ—¶é—´ + WEBæœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶ç”Ÿæˆå“åº”èŠ±è´¹çš„æ—¶é—´ + WEBæœåŠ¡å™¨ç”Ÿæˆå“åº”åˆ°æµè§ˆå™¨èŠ±è´¹çš„æ—¶é—´ ç¬¬ä¸€å­—èŠ‚å“åº”æ—¶é—´ï¼ˆTTFBï¼‰è¦è€ƒè™‘çš„é—®é¢˜ï¼šæ­¥éª¤1ï¼šä»å‘é€è¯·æ±‚åˆ°WEBæœåŠ¡å™¨çš„æ—¶ï¼Œå³å‘ç«™ç‚¹åœ°å€æäº¤é¦–æ¬¡è¯·æ±‚ DNS å“åº”æ—¶é—´ï¼ˆç»ˆç«¯ç”¨æˆ·ä¾§è§£æ DNS è¯·æ±‚æœ‰å¤šå—ï¼‰ ç½‘ç«™æœåŠ¡å™¨åˆ°ç»ˆç«¯ç”¨æˆ·çš„è·ç¦»ï¼Œè¶ŠçŸ­è¶Šå¥½ ç½‘ç»œç¨³å®šæ€§ æ­¥éª¤2ï¼šWEBæœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶ç”Ÿæˆå“åº”èŠ±è´¹çš„æ—¶é—´ï¼Œå³ç”± web æœåŠ¡å™¨è§£ææœ¬æ¬¡è¯·æ±‚ ç‰©ç†ç¡¬ä»¶å“åº”æ—¶é—´ ï¼ˆweb æœåŠ¡å™¨è§£æè¯·æ±‚æœ‰å¤šå¿«ï¼‰ æ—¢æœ‰çš„æœåŠ¡å™¨æ“ä½œè´Ÿè½½ æ•°æ®ä¸­å¿ƒä»»ä½•ç½‘ç»œç›¸å…³çš„å»¶è¿Ÿ æ­¥éª¤3ï¼šWEBæœåŠ¡å™¨ç”Ÿæˆå“åº”åˆ°æµè§ˆå™¨èŠ±è´¹çš„æ—¶é—´ï¼Œ å³å‘å®¢æˆ·ç«¯å‘é€é¦–ä¸ªå“åº”çš„æ—¶é—´ ç»ˆç«¯ç”¨æˆ·çš„ç½‘é€Ÿ è¿æ¥ç¨³å®šæ€§ Chromeè‡ªå¸¦çš„performanceæ£€æµ‹å·¥å…·è‡ªåŠ¨åŒ–æ£€æµ‹åˆ©å™¨â€”â€” lighthouse â€”â€” è‡ªåŠ¨ç”Ÿæˆç½‘é¡µæ€§èƒ½æŠ¥å‘Šï¼Œå¹¶æœ‰ä¼˜åŒ–å»ºè®®ç¬¦åˆè°·æ­Œçš„ PWA æ ‡å‡†çš„æ£€æµ‹ï¼Œå…³äºPWAçš„æ¦‚å¿µï¼Œç‚¹å‡»è¿™é‡Œ æ–¹æ³•ä¸€ï¼Œç›´æ¥å®‰è£… npm åº“ 1npm i -g lighthouse ä½¿ç”¨èµ·æ¥è¶…çº§ç®€å• 1lighthouse &lt;éœ€è¦æµ‹è¯•çš„ç½‘é¡µé“¾æ¥&gt; æ–¹æ³•äºŒï¼Œæµè§ˆå™¨ä¹Ÿè‡ªå¸¦ lighthouse åŠŸèƒ½ï¼Œä»¥ä¸‹æ˜¯ Edge æµè§ˆå™¨ æµè§ˆå™¨çš„é‡ç»˜ä¸å›æµèµ„æºåˆå¹¶ä¸å‹ç¼©ï¼šç°ä»£åŒ–çš„å‰ç«¯è·‘ä¸æ‰èµ„æºå‹ç¼©è¿™ä¸€æ­¥ï¼Œå¹³æ—¶å·¥ç¨‹åŒ–ç”¨çš„ webpack å°±æ˜¯ä¸€æ¬¾å‹ç¼©å·¥å…· HTMLå‹ç¼©åŸç†ï¼šå°†HTMLé‡Œçš„ç©ºæ ¼ï¼Œæ¢è¡Œç¬¦ï¼Œåˆ¶è¡¨ç¬¦ç­‰å»æ‰ æ–¹æ³•ï¼š nodeä½œä¸ºæ„å»ºå·¥å…·ï¼Œæä¾›äº† html-minifier å·¥å…·ï¼Œwebpackçš„ HTMLMinifierWebpackPlugin ä¸­å†…ç½®äº†è¯¥æ„å»ºå·¥å…· åç«¯æ¨¡æ¿å¼•æ“æ¸²æŸ“å‹ç¼©ï¼Œå¦‚ejsæ¨¡æ¿ï¼Œexpress çš„ renderFile() CSSå‹ç¼©åŸç†ï¼š é™¤äº†åƒHTMLä¸€æ ·åˆ é™¤ç©ºæ ¼ï¼Œæ¢è¡Œç¬¦ç­‰ä¹‹å¤– åˆ é™¤æ— æ•ˆä»£ç  cssè¯­ä¹‰åˆå¹¶ æ–¹æ³•ï¼š html-minifier å¯ä»¥å¯¹htmlä¸­çš„å†…è”cssæ ·å¼è¿›è¡Œå‹ç¼©ï¼Œéœ€é…ç½®å…¶ä¸­çš„é€‰é¡¹ clean-css å¯¹ css çš„å‹ç¼© Webpack çš„ CssMinimizerWebpackPlugin JSå‹ç¼©ä¸æ··ä¹±åŸç†ï¼š åˆ é™¤æ— æ•ˆå­—ç¬¦ åˆ é™¤æ³¨é‡Š ä»£ç è¯­ä¹‰åŒ–çš„ç¼©å‡å’Œä¼˜åŒ– ä»£ç ä¿æŠ¤ æ–¹æ³•ï¼š html-minifier å¯ä»¥å¯¹htmlä¸­çš„jsè¿›è¡Œå‹ç¼©ï¼Œéœ€é…ç½®å…¶ä¸­çš„é€‰é¡¹ uglifyjs3 JSæ–‡ä»¶åˆå¹¶å¦‚æœä¸åˆå¹¶è¯·æ±‚ä¼šæœ‰ä»¥ä¸‹å½±å“ ä½†åˆå¹¶è¯·æ±‚ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå…¶ç¼ºç‚¹ä½“ç°åœ¨ï¼š é¦–å±æ¸²æŸ“çš„é—®é¢˜ç°åœ¨çš„å‰ç«¯éƒ½ç”¨ç±»ä¼¼reactæˆ–è€…vueç­‰å‰ç«¯æ¡†æ¶ï¼Œå¦‚æœä½¿ç”¨vueæˆ–è€…reactæ²¡æœ‰è¿›è¡ŒæœåŠ¡ç«¯æ¸²æŸ“çš„æ“ä½œï¼Œè€Œä¸”æœåŠ¡ç«¯åˆå¹¶è¯·æ±‚çš„JSæ–‡ä»¶åˆæ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆè¯·æ±‚å›æ¥çš„JSåŠ è½½å®Œæˆåï¼Œæ‰ä¼šæ‰§è¡Œreactæˆ–vueçš„æ¡†æ¶ä»£ç åœ¨å®¢æˆ·ç«¯åŠ è½½æ¸²æŸ“ï¼Œé‚£ä¹ˆé¦–å±ç™½å±çš„æ—¶é—´å°±ä¼šæ¯”è¾ƒä¹… ç¼“å­˜å¤±æ•ˆçš„é—®é¢˜ç°åœ¨çš„æ‰“åŒ…ç”¨webpackéƒ½ä¼šåŠ ä¸Šmd5æˆ³ï¼Œç”¨äºæ ‡è¯†å•ä¸ªjsæ–‡ä»¶æ˜¯å¦å‘ç”Ÿæ”¹å˜ï¼Œå¦‚æœJSåˆå¹¶äº†ï¼Œå°±ä¼šä½¿åŸå…ˆçš„md5æˆ³å¤±æ•ˆï¼Œå°±å¾—é‡æ–°åŠ è½½ é’ˆå¯¹åˆå¹¶å¸¦æ¥çš„è´Ÿé¢æ•ˆæœï¼Œåº”éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š å…¬å…±åº“åˆå¹¶å…¬å…±åº“ä»£ç æ¯”è¾ƒå°‘åšé¢‘ç¹å˜åŠ¨ï¼Œåº”å•ç‹¬æ‰“åŒ…ä¸ºä¸€ä¸ªjsæ–‡ä»¶ï¼Œå’Œä¸šåŠ¡ä»£ç çš„jsæ–‡ä»¶åˆ†å¼€ï¼Œé¿å…å…¬å…±åº“çš„ç¼“å­˜å¤±æ•ˆ ä¸åŒé¡µé¢çš„åˆå¹¶è¿™ç§å‘ç”Ÿåœ¨vueæˆ–reactçš„å•é¡µé¢åº”ç”¨ï¼Œé€šå¸¸æˆ‘ä»¬æ‰“åŒ…å‡ºæ¥çš„å•é¡µåº”ç”¨åªæœ‰ä¸€ä¸ªjsæ–‡ä»¶ï¼Œä½†è¿™ç§æ–¹æ³•åœ¨æ•ˆç‡æå‡æ¥è¯´æœ‰é˜»ç¢ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯æ¯ä¸ªé¡µé¢æ‰“åŒ…ä¸ºä¸€ä¸ªjsæ–‡ä»¶ï¼Œå½“æŸé¡µé¢è¢«è·¯ç”±åˆ°åŠ è½½åˆ°æ—¶ï¼Œæ‰å»åŠ è½½å¯¹åº”é¡µé¢çš„jsæ–‡ä»¶ï¼Œè¿™ç§æ–¹å¼åœ¨webpackä¸­æœ‰ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯ loadable å¼‚æ­¥åŠ è½½ç»„ä»¶ ä¼ è¾“æ–¹é¢ï¼šCDNç¼“å­˜http2å……åˆ†åˆ©ç”¨HTTPç¼“å­˜å‹ç¼©htmlï¼Œjsï¼Œcssæ–‡ä»¶ä½“ç§¯ï¼Œç”¨gzip/brotliå¯¹ JSã€CSSã€HTML ç­‰æ–‡æœ¬èµ„æºå‡æœ‰æ•ˆï¼Œä½†æ˜¯å¯¹å›¾ç‰‡æ•ˆæœä¸å¤§ã€‚ gzip é€šè¿‡ LZ77 ç®—æ³•ä¸ Huffman ç¼–ç æ¥å‹ç¼©æ–‡ä»¶ï¼Œé‡å¤åº¦è¶Šé«˜çš„æ–‡ä»¶å¯å‹ç¼©çš„ç©ºé—´å°±è¶Šå¤§ã€‚ brotli é€šè¿‡å˜ç§çš„ LZ77 ç®—æ³•ã€Huffman ç¼–ç åŠäºŒé˜¶æ–‡æœ¬å»ºæ¨¡æ¥å‹ç¼©æ–‡ä»¶ï¼Œæ›´å…ˆè¿›çš„å‹ç¼©ç®—æ³•ï¼Œæ¯” gzip æœ‰æ›´é«˜çš„æ€§èƒ½åŠå‹ç¼©ç‡ å¯åœ¨æµè§ˆå™¨çš„ Content-Encoding å“åº”å¤´æŸ¥çœ‹è¯¥ç½‘ç«™æ˜¯å¦å¼€å¯äº†å‹ç¼©ç®—æ³•ï¼Œç›®å‰çŸ¥ä¹ã€æ˜é‡‘ç­‰å·²å…¨é¢å¼€å¯äº† brotli å‹ç¼©ã€‚ 12345678# Request HeaderAccept-Encoding: gzip, deflate, br# gzipContent-Encoding: gzip# gzipContent-Encoding: br å‹ç¼©æ··æ·†å·¥å…· terser swc html-minifier-terser JSå‹ç¼© ä¸Šè¿°æåˆ°çš„ gzip/brotli å’Œ terser webpack æ‰“åŒ… webpack-bundle-ananlyzeåˆ†ææ‰“åŒ…ä½“ç§¯ ä½¿ç”¨ä¸€äº›æ›´å°ä½“ç§¯çš„åº“ï¼Œå¦‚ moment -&gt; dayjs ä¸€äº›åº“è¿›è¡ŒæŒ‰éœ€åŠ è½½ï¼Œå¦‚ import lodash -&gt; import lodash-es é›…è™35æ¡çš„é“¾æ¥ï¼Œ ä»ä¸­æŒ‘å‡ºä¸€äº›ç‚¹æ¥è®²ï¼Œå¦‚ä¸‹ï¼šImage *ä¹‹æ‰€ä»¥æŠŠå›¾ç‰‡æ”¾åœ¨æœ€å‰ï¼Œå› ä¸ºä¼˜åŒ–å›¾ç‰‡çš„æ•ˆç‡æ˜¯æ¯”è¾ƒå¤§çš„ Optimize Images * å›¾ç‰‡ä¼˜åŒ– å„ç§å›¾ç‰‡æ ¼å¼çš„åº”ç”¨åœºæ™¯ï¼š 1.1 png å¤§éƒ¨åˆ†éœ€è¦ä½¿ç”¨é€æ˜çš„åœºæ™¯ pngcrush æˆ–å…¶ä»–å·¥å…·å‹ç¼©pngã€‚åœ¨çº¿å‹ç¼©å·¥å…· https:/ tinypng.com/ 1.2 jpg å¤§éƒ¨åˆ†ä¸éœ€è¦é€æ˜çš„åœºæ™¯ jpegtranæˆ–å…¶å®ƒå·¥å…·å‹ç¼©jpegï¼Œå¤§å›¾ç”¨jpg 1.3 SVGçŸ¢é‡å›¾ï¼Œç±»ä¼¼XMLè¯­æ³•ï¼Œå†…åµŒåœ¨htmlé‡Œçš„ä»£ç å›¾ç‰‡ï¼ˆç”¨æ¥ç»˜åˆ¶åœ°å›¾ï¼Œè‚¡ç¥¨Kçº¿å›¾ç­‰ï¼‰ï¼Œå¯ä½¿ç”¨ é˜¿é‡Œçš„iconfont è§£å†³iconé—®é¢˜ SVGçš„æ•™ç¨‹ ä¾‹å¦‚ç”»ä¸€ä¸ªé•¿æ–¹å½¢ï¼š 1234567&lt;svg width=&quot;100%&quot; height=&quot;100%&quot; version=&quot;1.1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt; &lt;rect width=&quot;300&quot; height=&quot;100&quot; style=&quot;fill:rgb(0,0,255);stroke-width:1; stroke:rgb(0,0,0)&quot; /&gt;&lt;/svg&gt; 1.4 Webp å¯å…¨ç”¨ googleåœ¨2010å¹´å¼€å‘çš„ä¸€ç§å…¨èƒ½çš„å›¾ç‰‡ï¼Œä½†safariæµè§ˆå™¨ å’Œ webview çš„å…¼å®¹æ€§ä¸å¤ªå¥½ 1.5 png â€”â€”&gt; Webp æ ¼å¼ç½‘ç«™ï¼šæ™ºå›¾ webp æ¯” jpeg/png æ›´å°ï¼Œè€Œ avif åˆæ¯” webp å°ä¸€ä¸ªçº§åˆ« ä¸ºäº†æ— ç¼å…¼å®¹ï¼Œå¯é€‰æ‹© picture/source è¿›è¡Œå›é€€å¤„ç† 12345&lt;picture&gt; &lt;source srcset=&quot;img/photo.avif&quot; type=&quot;image/avif&quot;&gt; &lt;source srcset=&quot;img/photo.webp&quot; type=&quot;image/webp&quot;&gt; &lt;img src=&quot;img/photo.jpg&quot; width=&quot;360&quot; height=&quot;240&quot;&gt;&lt;/picture&gt; Image inlineï¼Œå³å°†å›¾ç‰‡å†…å®¹å†…åµŒåˆ°htmlé‡Œï¼Œå‡å°‘ç½‘ç«™çš„HTTPè¯·æ±‚æ•°é‡ï¼Œå¤šç”¨äºç§»åŠ¨ç«¯å’Œå°å›¾æ ‡ï¼š å¦‚ä½•å°†å›¾ç‰‡è½¬æ¢ä¸ºbase64ç¼–ç å†…åµŒåˆ°htmlä¸­ï¼Œæœ‰ä¸€ä¸ªåœ¨çº¿è½¬æ¢ç½‘ç«™ï¼Œåœ¨htmlæ–‡ä»¶å›¾ç‰‡æ‰€åœ¨çš„src=â€â€ä¸­æ·»åŠ data:image/jpg;base64,ï¼ˆæ³¨ï¼šè¿™é‡Œæ˜¯jpgæ ¼å¼ï¼Œä½ å¯ä»¥æ”¹å†™æˆä½ ç¼–ç å›¾ç‰‡çš„ç±»å‹ï¼‰ï¼Œå°†ä½ ç¼–ç çš„Base64ä»£ç å¤åˆ¶åˆ°image/jpg;base64, çš„åé¢ï¼Œç„¶åç”¨æµè§ˆå™¨è¿è¡Œå³å¯ã€‚ å½“ç„¶è¿˜å¯ä»¥åƒtaobaoä¸»é¡µä¸€æ ·ï¼ŒåµŒå…¥åˆ°cssçš„å±æ€§ä¸­ä½¿ç”¨ï¼š Optimize CSS Spriteså®é™…ä¸Šï¼Œéšç€å¸¦å®½çš„æ™®éæé«˜ï¼Œç°åœ¨ä¸å°‘ç½‘ç«™éƒ½ä¸ç”¨é›ªç¢§å›¾äº†ï¼Œç‰¹åˆ«æ˜¯PCç«¯ï¼Œç§»åŠ¨ç«¯ç”¨çš„è¿˜ç›¸å¯¹æ¯”PCç«¯å¤šäº›ã€‚ä½†ä»æœ‰ç½‘ç«™åœ¨ä½¿ç”¨ä»–ã€‚è€Œé›ªç¢§å›¾åœ¨åº”ç”¨ä¸Šä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå¦‚æœè¿‡å¤šå›¾æ ‡é›†åˆåœ¨ä¸€ä¸ªå›¾çš„è¯ï¼Œåˆ™ä¼šå‡ºç°å¦‚æœè¯¥å›¾ç‰‡è¯·æ±‚åè¯»å–ä¸å‡ºï¼Œæ‰€æœ‰åº”ç”¨åˆ°è¯¥å›¾ç‰‡çš„å›¾æ ‡å…¨éƒ¨ä¼šå¤±æ•ˆ Arranging the images in the sprite horizontally as opposed to vertically usually results in a smaller file size. Combining similar colors in a sprite helps you keep the color count low, ideally under 256 colors so to fit in a PNG8. â€œBe mobile-friendlyâ€ and donâ€™t leave big gaps between the images in a sprite. This doesnâ€™t affect the file size as much but requires less memory for the user agent to decompress the image into a pixel map. 100x100 image is 10 thousand pixels, where 1000x1000 is 1 million pixels é›ªç¢§å›¾æœ€å¥½ç«–æ”¾ï¼Œé¿å…æ¨ªæ”¾ï¼Œè¾¾åˆ°æœ€å°å°ºå¯¸ ç›¸ä¼¼å›¾ç‰‡åˆå¹¶ï¼Œé¢œè‰²ç›¸è¿‘çš„åˆå¹¶ï¼Œé¢œè‰²æ•°ä¼šæ›´å°‘ ç§»åŠ¨ç«¯çš„é›ªç¢§å›¾å‡å°‘ç©ºéš™ é›ªç¢§å›¾çš„ç”Ÿæˆï¼Œç”¨è¿™ä¸ªç½‘ç«™ é€‰æ‹©å™¨æ€§èƒ½å†…è”æ ·å¼ (style=â€â€) &gt; ID é€‰æ‹©å™¨ (id) &gt; ç±»é€‰æ‹©å™¨ (class) = å±æ€§é€‰æ‹©å™¨ ( a[href], input[type=â€textâ€] ç­‰ ) = ä¼ªç±»é€‰æ‹©å™¨ (nth-child(n), :hover, :active ç­‰) &gt; å…ƒç´ ï¼ˆç±»å‹ï¼‰é€‰æ‹©å™¨ = ä¼ªå…ƒç´ é€‰æ‹©å™¨ Do Not Scale Images in HTML If you need &lt;img width=&quot;100&quot; height=&quot;100&quot; src=&quot;mycat.jpg&quot; alt=&quot;My Cat&quot; /&gt;then your image (mycat.jpg) should be 100x100px rather than a scaled down 500x500px image. ä¸è¦åœ¨HTMLä¸­ç¼©æ”¾å›¾ç‰‡ï¼Œå¦‚æœä½ éœ€è¦ &lt;img width=&quot;100&quot; height=&quot;100&quot; src=&quot;mycat.jpg&quot; alt=&quot;My Cat&quot; /&gt; çš„å›¾ç‰‡ï¼Œç›´æ¥åšä¸€å¼  100*100 çš„å›¾å³å¯ï¼Œè€Œä¸æ˜¯æ‹¿ä¸€å¼  500*500 çš„å›¾ç‰‡è¿›è¡Œç¼©æ”¾ Make favicon.ico Small and Cacheableä½¿å¾— favicon.ico å›¾ç‰‡å¯ä»¥ç¼“å­˜ï¼Œå¦‚æœä¸è¿›è¡Œç¼“å­˜ï¼Œä¸å…³å¿ƒä»–ï¼Œæµè§ˆå™¨è¿˜æ˜¯ä¼šè¯·æ±‚ä»– ContentMake Fewer HTTP Requests *å‡å°‘ HTTP è¯·æ±‚ Reduce DNS Lookupså‡å°‘DNSæŸ¥è¯¢ Avoid Redirects *é¿å…é‡å®šå‘ Postload Components * æ‡’åŠ è½½ç»„ä»¶å›¾ç‰‡è¿›å…¥å¯è§†åŒºåŸŸåå†è¯·æ±‚å›¾ç‰‡èµ„æºã€‚é€‚ç”¨äºç”µå•†ç­‰å›¾ç‰‡å¾ˆå¤šï¼Œé¡µé¢å¾ˆé•¿çš„ä¸šåŠ¡åœºæ™¯å‡å°‘æ— æ•ˆèµ„æºçš„åŠ è½½å¹¶å‘åŠ è½½çš„èµ„æºè¿‡å¤šä¼šé˜»å¡jsçš„åŠ è½½ï¼Œå½±å“ç½‘ç«™æ­£å¸¸ä½¿ç”¨ æ¡ˆä¾‹å¯ä»¥çœ‹æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ï¼Œå…³äºJS IntersectionObserver Apiï¼Œå¯ä»¥è¿™ä¸ªå°†è¿™ä¸ªapiç”¨äºæ‡’åŠ è½½ ä¸‹é¢ç»“åˆreact å†™ä¸€ä¸ªæ‡’åŠ è½½æ¡ˆä¾‹ 123456789101112131415161718192021222324252627282930313233343536373839import React from &#x27;react&#x27;import &#x27;./Lazyload.css&#x27;import &#123; v4 as uuidv4 &#125; from &#x27;uuid&#x27;/* æ€»ä½“æ€è·¯ï¼š1. å…ˆåˆ›å»ºå›¾ç‰‡å ä½ç¬¦2. åˆ›å»º IntersectionObserver å¯¹è±¡ç›‘å¬è¿™äº›å›¾ç‰‡å ä½ç¬¦*/const refs = [] // å›¾ç‰‡çš„ refï¼ˆæ“ä½œdomæ—¶ç”¨ï¼‰const images = []for (let i=0; i&lt;4; i++) &#123; const ref = React.createRef() refs.push(ref) images.push(&lt;div className=&#x27;image-box&#x27; key=&#123;uuidv4()&#125;&gt; &lt;img ref=&#123; ref &#125; data-src=&#123;`https://pschina.github.io/src/assets/images/$&#123;i&#125;.jpg`&#125; /&gt; &lt;/div&gt;)&#125;const LazyLoadPage = ()=&gt;&#123; const io = new IntersectionObserver( entries =&gt;&#123; entries.forEach((item)=&gt;&#123; if (item.intersectionRatio &lt;= 0 ) return // intersectionRatio æ˜¯å¯è§åº¦ å¦‚æœå½“å‰å…ƒç´ ä¸å¯è§å°±ç»“æŸè¯¥å‡½æ•°ã€‚ item.target.src = item.target.dataset.src &#125;) // [0.01] è¿™æ˜¯è§¦å‘æ—¶æœº 0.01ä»£è¡¨å‡ºç° 1%çš„é¢ç§¯å‡ºç°åœ¨å¯è§†åŒºè§¦å‘ä¸€æ¬¡å›æ‰å‡½æ•° // threshold = [0, 0.25, 0.5, 0.75] è¡¨ç¤ºåˆ†åˆ«åœ¨0% 25% 50% 75% æ—¶è§¦å‘å›æ‰å‡½æ•° &#125;, [0.01] ); const onload = ()=&gt; refs.forEach( i =&gt; io.observe(i.current) ) return &lt;div className=&#x27;box&#x27;&gt; &#123;images&#125; &lt;img onError=&#123;onload&#125; src=&quot;&quot; /&gt; &lt;/div&gt;&#125;export default LazyLoadPage Preload Components * é¢„åŠ è½½ç»„ä»¶æ–¹æ³•ä¸€ï¼ŒåŠ è½½æ—¶å¦ display ä¸º none 1&lt;img src=&quot;http://xxx.xxx&quot; style=&quot;display: none&quot; /&gt; æ–¹æ³•äºŒï¼Œåˆ©ç”¨ new Image() 12var img = new Image()img.src = &#x27;http://xxx.xxx/&#x27; æ–¹æ³•ä¸‰ï¼ŒXHLHttpRequest å¯¹è±¡ï¼Œè¿™ç§æ–¹æ³•æœ‰è·¨åŸŸé—®é¢˜ 12345678910111213141516171819var xmlhttprequest = new XMLHttpRequest()xmlhttprequest.onreadystatechange = callbackxmlhttprequest.onprogress = progressCallbackxmlhttprequest.open(&#x27;GET&#x27;, &#x27;http://image.baidu.com/mouse.jpg&#x27;, true)xmlhttprequest.send()function callback () &#123; if (xmlhttprequest.readyState == 4 &amp;&amp; xmlhttprequest.status == 200 ) &#123; var reponseText = xmlhttprequest.responseText &#125;else&#123; console.log(&#x27;Request was unsuccessful:&#x27; + xmlhttprequest.status) &#125;&#125;function progressCallback (e) &#123; e = e || event if ( e.lengthComputable) console.log(`Receievd $&#123;e.loaded&#125; of $&#123;e.total&#125; bytes`)&#125; æ–¹æ³•å››ï¼Œä½¿ç”¨åº“ PreloadJS è¿›è¡Œé¢„åŠ è½½ 12345678910111213var queue = new createjs.LoadQueue(false)queue.on(&#x27;complete&#x27;, handleComplete, this)queue.loadManifest([ &#123;id: &#x27;myImg&#x27;, src:&#x27;http://pic26.nipic.com/20121213/6168183_004444903000_2.jpg&#x27;&#125;, &#123;id: &#x27;myImg2&#x27;, src:&#x27;http://pic9.nipic.com/20100814/2839526_193147158170_2.jpg&#x27;&#125;,])function handleComplete () &#123; var img = queue.getResult(&#x27;myImg&#x27;) document.body.appendChild(img)&#125; Server æœåŠ¡ç«¯ä¼˜åŒ–Use a Content Delivery Network (CDN) *CDNï¼Œå†…å®¹åˆ†å‘ç½‘ç»œï¼Œç”¨äºé™æ€èµ„æºçš„åŠ è½½ï¼Œé€‰æ‹©ç¦»ç”¨æˆ·è¿‘çš„æœåŠ¡å™¨èŠ‚ç‚¹ï¼ŒèŠ‚çœç‰©ç†ä¸Šçš„è·ç¦»ï¼Œè®©èµ„æºåˆ°è¾¾ç”¨æˆ·çš„ç‰©ç†è·ç¦»ç¼©çŸ­ é‚£ä¹ˆè¯·æ±‚CDNå†…å®¹æ—¶ï¼Œå¦‚æœè¯·æ±‚å¤´æºå¸¦cookieæ˜¯æ²¡ç”¨çš„ï¼Œæ‰€ä»¥è¯·æ±‚CDNæ—¶ï¼Œcookieæœ€å¥½å»æ‰ï¼ŒCDNçš„åŸŸåå¦‚æœå’Œä¸»ç«™åŸŸåä¸€æ ·ï¼Œå°±ä¼šæºå¸¦Cookieè¿‡å»ï¼Œæ‰€ä»¥æ‰¾CDNæ—¶æœ€å¥½ä¸è¦å’Œä¸»ç«™çš„åŸŸåä¸€æ · ä¾‹å¦‚æ·˜å®çš„é¡µé¢ï¼Œç›´æ¥åœ¨å¤´éƒ¨åŠ DNS scriptæ ‡ç­¾å³å¯ã€‚ 1&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//g.alicdn.com&quot; /&gt; Add Expires or Cache-Control Header * There are two aspects to this rule: For static components: implement â€œNever expireâ€ policy by setting far future Expires &gt; header For dynamic components: use an appropriate Cache-Control header to help the browser &gt; with conditional requests é›…è™å»ºè®®å°† Expires å­—æ®µç”¨äºæ‰€æœ‰ç»„ä»¶ï¼Œä¸å•æ­¢äºå›¾ç‰‡ï¼š Expires headers are most often used with images, but they should be used on all components including scripts, stylesheets, and Flash components. é™æ€æ–‡ä»¶ï¼Œè¯·æ±‚å¤´å¯ä»¥è®¾ç½®æ°¸ä¸è¿‡æœŸæˆ–è€…æŠŠæ—¶é—´è®¾ç½®çš„é•¿ä¸€äº› 1234expires: never# orExpires: Thu, 15 Apr 2099 20:00:00 GMT å¯¹äºåŠ¨æ€ç»„ä»¶ï¼Œåˆ©ç”¨è¯·æ±‚å¤´çš„Cache-Control æ§åˆ¶ï¼Œä¾‹å¦‚ 1cache-control: max-age&#x3D;2592000 Cache-Controlçš„å€¼æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š no-cache ç›´æ¥è¦æœåŠ¡çš„æ–°å†…å®¹ï¼Œä¸æ‹¿ç¼“å­˜çš„no-store ä¸ç¼“å­˜è¯·æ±‚æˆ–å“åº”çš„ä»»ä½•å†…å®¹max-age å“åº”çš„æœ€å¤§Ageå€¼min-fresh æœŸæœ›åœ¨æŒ‡å®šæ—¶é—´å†…çš„å“åº”æ‰”æœ‰æ•ˆonly-if-chache ä»ç¼“å­˜è·å–èµ„æºmax-stale æ¥æ”¶å·²è¿‡æœŸå“åº”min-fresh æœŸæœ›åœ¨æŒ‡å®šæ—¶é—´å†…çš„å“åº”ä»æœ‰æ•ˆno-transform ä»£ç†ä¸å¯æ›´æ”¹åª’ä½“ç±»å‹cache-extension æ–°æŒ‡ä»¤æ ‡è®°ï¼ˆtokenï¼‰ å…¶ä¸­ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ no-cacheï¼Œno-storeï¼Œmax-age 3ä¸ªå€¼ Gzip Components *ç½‘é¡µä¸­é‡å¤çš„å†…å®¹ï¼Œä¼šç”¨Gzipå‹ç¼©ï¼Œæ˜¾è‘—å‡å°‘æ–‡ä»¶å¤§å°ï¼Œåœ¨ Nginx é‡Œæœ‰Nigixé…ç½®Gzipçš„ä»‹ç» è¯·æ±‚å¤´ä¸­æ·»åŠ ï¼š 1Accept-Encoding: gzip, deflate ç›¸åº”å¤´ä¸­æ·»åŠ ï¼š 1Content-Encoding: gzip Configure ETags Entity tags (ETags) are a mechanism that web servers and browsers use to determine whether the component in the browserâ€™s cache matches the one on the origin server. ETags æ˜¯ä¸€ç§æœºåˆ¶ï¼Œç”¨æ¥ç¡®å®šæµè§ˆå™¨çš„ç¼“å­˜å†…å®¹å’ŒæœåŠ¡å™¨çš„æ˜¯å¦åŒ¹é…ï¼Œå¦‚åŒ¹é…ï¼Œåˆ™ç”¨æµè§ˆå™¨çš„å†…å®¹ï¼Œå¦‚ä¸åŒ¹é…ï¼Œåˆ™è¯·æ±‚æœåŠ¡å™¨æ–°çš„å†…å®¹ è¯·æ±‚æ—¶çš„å¤´éƒ¨å­—æ®µï¼š 12Last-Modified: Tue, 12 Dec 2006 03:03:59 GMTETag: &quot;10c24bc-4ab-457e1c1f&quot; å“åº”çš„å¤´éƒ¨å­—æ®µï¼š 123If-Modified-Since: Tue, 12 Dec 2006 03:03:59 GMTIf-None-Match: &quot;10c24bc-4ab-457e1c1f&quot;HTTP/1.1 304 Not Modified Browser Storage * æµè§ˆå™¨å­˜å‚¨ä¼˜åŒ–Reduce Cookie Size * Eliminate unnecessary cookiesKeep cookie sizes as low as possible to minimize the impact on the user response &gt; timeBe mindful of setting cookies at the appropriate domain level so other &gt; sub-domains are not affectedSet an Expires date appropriately. An earlier Expires date or none removes the cookie sooner, improving the user response time Cookieæ˜¯è¯·æ±‚å¤´çš„ä¸€ä¸ªå­—æ®µï¼Œå¦‚æœå­˜å‚¨çš„ä¿¡æ¯è¿‡å¤šè¿‡å¤§ï¼Œå¿…ç„¶ä¼šå½±å“æ€§èƒ½ï¼Œå‡å°‘Cookieä½“ç§¯å¤§å°ï¼Œåªå­˜å‚¨ç”¨æˆ·idç­‰ç®€å•ä¿¡æ¯ è®¾ç½®åˆé€‚çš„ expire å­—æ®µè®©cookieè¿‡æœŸ è®¾ç½®cookieæ—¶ï¼Œåº”æ³¨æ„è®¾ç½®å¤´éƒ¨å­—æ®µ Set-Cookieï¼šhttponlyï¼Œåªå…è®¸httpé€šä¿¡ï¼Œè¿™æ ·æ‰ä¸ä¼šè¢«jsç¯¡æ”¹ cookieç”±äºæ˜¯ç§åœ¨åŸŸåä¸‹çš„ï¼Œè¯·æ±‚å¤´çš„ä¸€ä¸ªå­—æ®µï¼Œæ‰€ä»¥å•ç‹¬å¸¦åœ¨åŸŸåä¸­ä¼šé€ æˆCDNçš„æµé‡äº§ç”Ÿä¸å¿…è¦çš„æŸè€—ï¼Œè§£å†³æ–¹æ³•æ˜¯ CDNåŸŸåå’Œä¸»ç«™åŸŸåç‹¬ç«‹å¼€æ¥ LocalStorage * HTML5ä¸“é—¨è®¾è®¡å‡ºæ¥ç”¨äºæµè§ˆå™¨å­˜å‚¨çš„ å¤§å°ä¸º5Mbå·¦å³ï¼Œæ¯”cookieçš„4kbå¤§å¾ˆå¤š ä¸è¿›è¡Œé€šä¿¡ æ¥å£å°è£…ç›¸è¾ƒäºcookieè¾ƒå¥½ æµè§ˆå™¨æœ¬åœ°ç¼“å­˜æ–¹æ¡ˆ SessionStorage * ä¼šè¯çº§åˆ«çš„æµè§ˆå™¨å­˜å‚¨ å¤§å°5Må·¦å³ ä¸è¿›è¡Œé€šä¿¡ æ¥å£å°è£…ç›¸ å¯¹äºè¡¨å•ä¿¡æ¯çš„ç»´æŠ¤ï¼Œå…³é—­æµè§ˆå™¨çš„æ ‡ç­¾é¡µï¼ŒSessionStorageä¼šè‡ªåŠ¨æ¸…ç©ºä¼˜åŒ–ç‚¹ï¼š ä¾‹å¦‚ç”¨æˆ·æ³¨å†Œé¡µé¢ï¼Œéœ€è¦å¡«å†™å¾ˆå¤šä¸œè¥¿ï¼Œå¦‚æœç”¨æˆ·è¿˜æ²¡æäº¤ä½†åˆ·æ–°äº†è¯¥é¡µé¢ï¼Œç”¨æˆ·ä½“éªŒä¼šä¸å¥½ è€Œæ­¤æ—¶å¯å°†ç”¨æˆ·æ‰€å¡«çš„ä¿¡æ¯å­˜å‚¨åˆ°SessionStorageé‡Œï¼Œç”¨æˆ·åˆ·æ–°é¡µé¢æ—¶ï¼Œæ‰€å¡«å†™çš„ä¸œè¥¿ä¹Ÿä¸ä¼šæ¸…ç©ºã€‚ IndexDB æ˜¯ä¸€ç§ä½çº§APIï¼Œç”¨äºå®¢æˆ·ç«¯å­˜å‚¨å¤§é‡ç»“æ„åŒ–æ•°æ®ã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯æµè§ˆå™¨çš„æ•°æ®åº“ ä½¿ç”¨çš„ç½‘ç«™è¾ƒå°‘ Service Worker * Service Worker æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨èƒŒåçš„ç‹¬ç«‹çº¿ç¨‹ï¼Œä¸€èˆ¬å¯ä»¥ç”¨æ¥å®ç°ç¼“å­˜åŠŸèƒ½ã€‚ ä½¿ç”¨ Service Workerçš„è¯ï¼Œä¼ è¾“åè®®å¿…é¡»ä¸º HTTPSã€‚å› ä¸º Service Worker æœ‰æ‹¦æˆªå’Œå¤„ç†ç½‘ç»œè¯·æ±‚çš„èƒ½åŠ›ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨ HTTPS åè®®æ¥ä¿éšœå®‰å…¨ã€‚ ç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯ç¼“å­˜jsæ–‡ä»¶åˆ°æµè§ˆå™¨é‡Œï¼Œè®©å®¢æˆ·ç«¯æœ‰å¤§é‡å¤„ç†jsçš„èƒ½åŠ›ã€‚ ä¾‹å¦‚ï¼Œç°åœ¨çš„Three.js æˆ– WebGLå¯ä»¥ç”¨äº3Dçš„æ¸²æŸ“ï¼Œä½†3Då›¾çš„jsè„šæœ¬åŠæ•°æ®å ç”¨èµ„æºæ¯”è¾ƒå¤šï¼Œä¸€ä¸ªè„šæœ¬å¯è¾¾å‡ Mbï¼Œå¯ä»¥ç”¨Service Workerå°†å…¶ç¼“å­˜èµ·æ¥æ‰§è¡Œã€‚ åˆ©ç”¨æ‹¦æˆªå’Œå¤„ç†ç½‘ç»œè¯·æ±‚çš„èƒ½åŠ›ï¼Œå¯ä»¥å®ç°ç¦»çº¿åº”ç”¨åŠŸèƒ½ã€‚ æ£€æŸ¥å·¥å…·ï¼šåœ¨chromeæµè§ˆå™¨è¾“å…¥chrome://serviceworker-internals/ æ£€æŸ¥æ‰€æœ‰ service worker chrome://inspect/#service-workers æ£€æŸ¥æ­£åœ¨è¿è¡Œçš„ service worker Progressive Web Apps æ¸è¿›å¼ Web åº”ç”¨ PWA æ ‡å‡†ç”± è°·æ­Œæå‡ºçš„ç§»åŠ¨ç«¯çš„æ ‡å‡†ã€‚ä¾‹å¦‚ï¼Œåœ¨ç§»åŠ¨ç«¯çš„å¼±ç½‘ç¯å¢ƒä¸‹ï¼Œä½ ç«™ç‚¹çš„åŠ è½½é€Ÿåº¦ã€‚ç¦»çº¿ç¯å¢ƒä¸‹ï¼Œèƒ½ä¸èƒ½æœ‰åŸºæœ¬çš„é¡µé¢è®¿é—® å¯é ï¼šåœ¨æ²¡æœ‰ç½‘ç»œç¯å¢ƒä¸­ä¹Ÿèƒ½æä¾›åŸºæœ¬çš„é¡µé¢è®¿é—® å¿«é€Ÿï¼šå› ä¸ºWeb Appæ˜¯ä¸€ä¸ªå¢é‡åŠ è½½çš„è¿‡ç¨‹ï¼Œä¸åŒäºiOSæˆ–è€…å®‰å“çš„åŸç”Ÿå¼€å‘ï¼ŒWeb AppåŠ è½½å¿…å—åˆ°ç½‘ç»œæ¡ä»¶çš„åˆ¶çº¦ èå…¥ï¼ˆEngagingï¼‰ï¼šå°†å…¶èƒ½åŠ›å¯¹æ ‡åŸç”ŸAPPï¼Œåº”ç”¨å¯ä»¥è¢«æ·»åŠ åˆ°æ‰‹æœºæ¡Œé¢ï¼Œå¹¶å’Œæ™®é€šåº”ç”¨ä¸€æ ·æœ‰å…¨å±ï¼Œæ¨é€ç­‰ç‰¹æ€§ CSSCSSæ˜¯å­˜åœ¨CSSé˜»å¡çš„ï¼Œ css å¦‚æœåœ¨ head ä¸­ä»¥ link æ–¹å¼å¼•å…¥ä¼šé˜»å¡é¡µé¢çš„æ¸²æŸ“ css é˜»å¡jsçš„æ‰§è¡Œ ä½† css ä¸é˜»å¡å¤–éƒ¨è„šæœ¬çš„åŠ è½½ Put Stylesheets at Top * While researching performance at Yahoo!, we discovered that moving stylesheets to the document HEAD makes pages appear to be loading faster. This is because putting stylesheets in the HEAD allows the page to render progressively. å°†æ ·å¼è¡¨æ”¾åœ¨å¤´éƒ¨ï¼Œå¯ä»¥è®©é¡µé¢é€æ­¥å‘ˆç° Choose &lt;link&gt; Over @import In IE @import behaves the same as using at the bottom of the page, so itâ€™s best not to use it. åœ¨IEæµè§ˆå™¨ä¸­ @import å’Œ &lt;link&gt; æ˜¯ä¸€æ ·çš„ï¼Œä½äºåº•éƒ¨æ‰§è¡Œï¼Œè¿™å’Œæˆ‘ä»¬æ¨èçš„CSSæ”¾åœ¨HEADä¸­æ‰§è¡ŒèƒŒé“è€Œé©°ï¼Œæ‰€ä»¥å°‘ç”¨ @import JavaScriptJS é˜»å¡ ç›´æ¥å¼•å…¥jsé˜»å¡é¡µé¢çš„æ¸²æŸ“ï¼Œæ‰€ä»¥æ‰æœ‰åé¢ jsä¸é˜»å¡èµ„æºåŠ è½½ jsæŒ‰é¡ºåºæ‰§è¡Œï¼Œé˜»å¡åç»­jsé€»è¾‘æ‰§è¡Œ Put Scripts at Bottom * The problem caused by scripts is that they block parallel downloads. While a script is downloading, however, the browser wonâ€™t start any other downloads, even on different hostnames. JSçš„åŠ è½½æœ¬èº«å°±æ˜¯ä¸€ç§é˜»å¡ï¼Œæ‰€ä»¥å°½é‡è®©HTML+CSSå…ˆæŠŠé¡µé¢æ¸²æŸ“å‡ºæ¥ï¼Œå†æ‰§è¡Œ åº•éƒ¨çš„&lt;script&gt;&lt;/script&gt; æ ‡ç­¾ 1234567891011&lt;!DOCTYPE HTML&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt; &lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div&gt;&lt;/div&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;&quot;&gt;&lt;/script&gt; &lt;/body&gt;&lt;/html&gt; Make JavaScript and CSS External if the JavaScript and CSS are in external files cached by the browser, the size of the HTML document is reduced without increasing the number of HTTP requests. (é™¤äº†ä¸»é¡µ) ä½¿ç”¨CSSæˆ–JSçš„å¤–éƒ¨é“¾æ¥ï¼Œæµè§ˆå™¨ä¼šç¼“å­˜ JavaScript å’Œ CSS æ–‡ä»¶ï¼Œè€Œä¸ä¼šå¢åŠ  HTTP è¯·æ±‚æ•°ã€‚ 12&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/xxx.min.css&quot;&gt;&lt;script nonce=&quot;b3/zKeoFCfru0lTFQr8Dyg==&quot; src=&quot;https://s.yimg.com/ss/rapid-3.41.3.js&quot;&gt;&lt;/script&gt; Minify JavaScript and CSS * Minification is the practice of removing unnecessary characters from code to reduce its size thereby improving load times. æœ€å°åŒ– JS å’Œ CSSï¼Œç°åœ¨æˆ‘ä»¬å¤šç”¨ webpackç­‰æ‰“åŒ…å·¥å…·æ¥åšåˆ°è¿™ä¸€æ­¥ Minimize DOM Access * Accessing DOM elements with JavaScript is slow so in order to have a more responsive page, you should: Cache references to accessed elements Update nodes â€œofflineâ€ and then add them to the tree Avoid fixing layout with JavaScript æœ€å°åŒ–DOMè®¿é—®ï¼Œå°½å¯èƒ½å°‘çš„è¿›è¡ŒDOMæ“ä½œï¼Œè¿™ç‚¹å¯ä»¥ä»ç°åœ¨çš„React Vueç­‰MVVMæ¡†æ¶ä½“ç°å‡ºæ¥ æ¸²æŸ“ä¼˜åŒ–preload/prefetch dns-prefetchpreload/prefetch å¯æ§åˆ¶ HTTP ä¼˜å…ˆçº§ï¼Œä»è€Œè¾¾åˆ°å…³é”®è¯·æ±‚æ›´å¿«å“åº”çš„ç›®çš„ã€‚ å¦‚å½“é¡µé¢å‡ºç° Linkï¼Œå¯ prefetch å½“å‰ Link çš„è·¯ç”±èµ„æºã€‚ 12&lt;link rel=&quot;prefetch&quot; href=&quot;style.css&quot; as=&quot;style&quot;&gt;&lt;link rel=&quot;preload&quot; href=&quot;main.js&quot; as=&quot;script&quot;&gt; 1&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//shanyue.tech&quot;&gt; é˜²æŠ–ä¸èŠ‚æµ é˜²æŠ–ï¼šé˜²æ­¢æŠ–åŠ¨ï¼Œå•ä½æ—¶é—´å†…äº‹ä»¶è§¦å‘ä¼šè¢«é‡ç½®ï¼Œé¿å…äº‹ä»¶è¢«è¯¯ä¼¤è§¦å‘å¤šæ¬¡ã€‚ä»£ç å®ç°é‡åœ¨æ¸…é›¶ clearTimeoutã€‚é˜²æŠ–å¯ä»¥æ¯”ä½œç­‰ç”µæ¢¯ï¼Œåªè¦æœ‰ä¸€ä¸ªäººè¿›æ¥ï¼Œå°±éœ€è¦å†ç­‰ä¸€ä¼šå„¿ã€‚ä¸šåŠ¡åœºæ™¯æœ‰é¿å…ç™»å½•æŒ‰é’®å¤šæ¬¡ç‚¹å‡»çš„é‡å¤æäº¤ã€‚ èŠ‚æµï¼šæ§åˆ¶æµé‡ï¼Œå•ä½æ—¶é—´å†…äº‹ä»¶åªèƒ½è§¦å‘ä¸€æ¬¡ï¼Œä¸æœåŠ¡å™¨ç«¯çš„é™æµ (Rate Limit) ç±»ä¼¼ã€‚ä»£ç å®ç°é‡åœ¨å¼€é”å…³é” timer=timeout; timer=nullã€‚èŠ‚æµå¯ä»¥æ¯”ä½œè¿‡çº¢ç»¿ç¯ï¼Œæ¯ç­‰ä¸€ä¸ªçº¢ç¯æ—¶é—´å°±å¯ä»¥è¿‡ä¸€æ‰¹ã€‚ æ— è®ºæ˜¯é˜²æŠ–è¿˜æ˜¯èŠ‚æµéƒ½å¯ä»¥å¤§å¹…åº¦å‡å°‘æ¸²æŸ“æ¬¡æ•°ï¼Œåœ¨ React ä¸­è¿˜å¯ä»¥ä½¿ç”¨ use-debounce ä¹‹ç±»çš„ hooks é¿å…é‡æ–°æ¸²æŸ“ã€‚ 123456789101112131415161718192021import React, &#123; useState &#125; from &#x27;react&#x27;;import &#123; useDebounce &#125; from &#x27;use-debounce&#x27;;export default function Input() &#123; const [text, setText] = useState(&#x27;Hello&#x27;); // ä¸€ç§’é’Ÿæ¸²æŸ“ä¸€æ¬¡ï¼Œå¤§å¤§é™ä½äº†é‡æ–°æ¸²æŸ“çš„é¢‘ç‡ const [value] = useDebounce(text, 1000); return ( &lt;div&gt; &lt;input defaultValue=&#123;&#x27;Hello&#x27;&#125; onChange=&#123;(e) =&gt; &#123; setText(e.target.value); &#125;&#125; /&gt; &lt;p&gt;Actual value: &#123;text&#125;&lt;/p&gt; &lt;p&gt;Debounce value: &#123;value&#125;&lt;/p&gt; &lt;/div&gt; );&#125; è™šæ‹Ÿåˆ—è¡¨ä¼˜åŒ–è¿™åˆæ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„è¯é¢˜ï¼Œä¸€èˆ¬åœ¨è§†å£å†…ç»´æŠ¤ä¸€ä¸ªè™šæ‹Ÿåˆ—è¡¨(ä»…æ¸²æŸ“åå‡ æ¡æ¡æ•°æ®å·¦å³)ï¼Œç›‘å¬è§†å£ä½ç½®å˜åŒ–ï¼Œä»è€Œå¯¹è§†å£å†…çš„è™šæ‹Ÿåˆ—è¡¨è¿›è¡Œæ§åˆ¶ã€‚ åœ¨ Reactä¸­å¯ä»¥ç”¨ä¸‹åˆ—åº“ react-virtualized react-window","categories":[],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://zyzy.info/tags/%E9%9D%A2%E8%AF%95/"},{"name":"Webæ€§èƒ½ä¼˜åŒ–","slug":"Webæ€§èƒ½ä¼˜åŒ–","permalink":"https://zyzy.info/tags/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"}]},{"title":"åˆ›å»ºè‡ªå·±çš„node cli","slug":"ã€2021-10-17ã€‘åˆ›å»ºè‡ªå·±çš„node-cli","date":"2021-10-17T14:18:15.000Z","updated":"2022-03-26T02:15:30.413Z","comments":true,"path":"2021/10/17/ã€2021-10-17ã€‘åˆ›å»ºè‡ªå·±çš„node-cli/","link":"","permalink":"https://zyzy.info/2021/10/17/%E3%80%902021-10-17%E3%80%91%E5%88%9B%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84node-cli/","excerpt":"ç»å¸¸ä½¿ç”¨create-react-appä½œä¸ºå‘½ä»¤è¡Œç”Ÿæˆé¡¹ç›®ï¼Œæ€»æƒ³ç€è‡ªå·±èƒ½é…ç½®ä¸€ä¸ªå±äºè‡ªå·±çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¾ˆé…·ç‚«çš„æ ·å­ã€‚æœ€è¿‘æœ‰æ—¶é—´ï¼Œç»ˆäºæ¥å®ç°äº†","text":"ç»å¸¸ä½¿ç”¨create-react-appä½œä¸ºå‘½ä»¤è¡Œç”Ÿæˆé¡¹ç›®ï¼Œæ€»æƒ³ç€è‡ªå·±èƒ½é…ç½®ä¸€ä¸ªå±äºè‡ªå·±çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¾ˆé…·ç‚«çš„æ ·å­ã€‚æœ€è¿‘æœ‰æ—¶é—´ï¼Œç»ˆäºæ¥å®ç°äº† åˆå§‹åŒ–é¡¹ç›®12mkdir y-cli &amp;&amp; cd y-clinpm init -y æ ¸å¿ƒæ­¥éª¤ npm linkæ–°å»ºä¸€ä¸ªæ–‡ä»¶ ./bin/yyt.jsï¼Œå¹¶å†™ä¸€ç‚¹ç®€å•çš„ä¸œè¥¿ 1234// è¿™é‡Œå‘Šè¯‰ç³»ç»Ÿè¦ä»¥nodeç¯å¢ƒæ‰§è¡Œï¼š#!/usr/bin/env nodeconsole.log(&#x27;hello,node cli!&#x27;) å†åœ¨ package.json é‡Œæ·»åŠ  bin é…ç½®ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰å‘½ä»¤ï¼Œå¦‚ y-cli 123&quot;bin&quot;: &#123; &quot;y-cli&quot;: &quot;./bin/yyt.js&quot;&#125; åœ¨å‘½ä»¤è¡Œé‡Œè¿è¡Œï¼š 123npm link# æˆ–è€…åœ¨å…¨å±€installï¼šnpm install . -g å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼Œnpmå°†å‘½ä»¤ä½œä¸ºè½¯é“¾æ¥è¿æ¥è‡³å¯¹åº”çš„jsæ–‡ä»¶ 123456789xxx@xxxMBP y-cli % sudo npm linknpm WARN y-cli@1.0.0 No descriptionnpm WARN y-cli@1.0.0 No repository field.up to date in 0.832sfound 0 vulnerabilities/usr/local/bin/yyt -&gt; /usr/local/lib/node_modules/y-cli/bin/yyt.js/usr/local/lib/node_modules/y-cli -&gt; /Users/xxx/Documents/code/y-cli æ‰€ç”¨åˆ°çš„åº“cliéœ€è¦è·å–ç”¨æˆ·çš„è¾“å…¥ï¼Œé€‰æ‹©å¹¶åšç›¸åº”çš„äº‹æƒ…ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°ä¸€äº›åº“æ¥å¸®å¿™æˆ‘ä»¬æ›´æ–¹ä¾¿çš„å†™cli æ ¸å¿ƒï¼š commander - å¤„ç†æ ¸å¿ƒå‘½ä»¤ ä¸»è¦æ¨¡å—ï¼Œåœ¨ç»ˆç«¯è¾“å‡ºå„ç§ä¿¡æ¯å…¨é è¿™ä¸ªæ¨¡å— download-git-repo - ä¸‹è½½gitæ¨¡å— ç¾åŒ–ï¼š chalk â€” ç¾åŒ–ç»ˆç«¯å­—ç¬¦æ˜¾ç¤º figlet â€” åœ¨ç»ˆç«¯è¾“å‡ºå¤§å‹å­—ç¬¦ inquirer â€” å‘½ä»¤è¡Œå‚æ•°è¾“å…¥äº¤äº’ shelljs â€” åœ¨jsæ–‡ä»¶å†™å‘½ä»¤è¡Œ ora - å®è¡Œloadingæ•ˆæœ è®©æˆ‘ä»¬æ¥æŠŠè¿™äº›åº“å…¨éƒ¨å®‰è£…ä¸€é commanderæ ¹æ®commanderæ–‡æ¡£çš„ä¸€äº›å‚æ•°ï¼Œæˆ‘ä»¬æ¥ç¼–å†™è„šæœ¬ yyt.js 12345678#!/usr/bin/env nodeconst program = require(&#x27;commander&#x27;)// è·å–package.jsonä¸­çš„ç‰ˆæœ¬ä¿¡æ¯program.version(require(&quot;../package.json&quot;).version)// è§£ææŒ‡ä»¤ï¼Œè¿™ç‚¹å¾ˆé‡è¦ ä¸è§£ææŒ‡ä»¤åˆ™æ— æ•ˆprogram.parse(process.argv) commanderè‡ªå¸¦ -V å’Œ -h ä¸¤ä¸ªå‘½ä»¤ï¼Œè¿è¡Œ yyt -hå¯çœ‹åˆ°ï¼š 123456xxx@xxxdeMacBook-Pro y-cli % yyt -hUsage: yyt [options]Options: -V, --version output the version number -h, --help display help for command .option() åŠ å…¥è‡ªå®šä¹‰å‘½ä»¤ 1program.option(&#x27;-d, --description&#x27;, &#x27;yyt è„šæ‰‹æ¶ç®€ä»‹ï¼šã€‚ã€‚ã€‚ã€‚&#x27;) å¯ä»¥å‘ç°å·²ç»åŠ ä¸Šè¯¥å‘½ä»¤ï¼š 1234567xxx@xxxdeMacBook-Pro y-cli % yyt -hUsage: yyt [options]Options: -V, --version output the version number -d, --description yyt è„šæ‰‹æ¶ç®€ä»‹ï¼šã€‚ã€‚ã€‚ã€‚ -h, --help display help for command .command() è‡ªå®šä¹‰å‘½ä»¤ï¼Œ åŸºç¡€æ ¼å¼ï¼š 1program.option(&#39;hello &lt;param1&gt; [param2]&#39;) å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå°–æ‹¬å·&lt;&gt;é‡Œçš„å‚æ•°æ˜¯å¿…å¡«å‚æ•°ï¼Œæ–¹æ‹¬å·[]é‡Œçš„å‚æ•°æ˜¯å¯é€‰å‚æ•° åˆ©ç”¨.command()å†™ä¸€ä¸ªç®€å•çš„demoï¼Œå¼„æ¸…æ•´ä¸ªåŸºç¡€æµç¨‹ï¼š 123456789program .command(&#x27;hello &lt;param1&gt; [param2]&#x27;) // å‘½ä»¤é‡Œåˆ©ç”¨.usage()å‚æ•°åŒ–ï¼Œä¾›åé¢çš„.action()å›è°ƒä½¿ç”¨ï¼š .usage(&#x27;&lt;command&gt; &lt;param1&gt; [param2]&#x27;) // å›è°ƒå¤„ç†ï¼š .action((param1, param2)=&gt;&#123; console.log(param1); console.log(param2); &#125;) 12345678ziyouzhiyi@ziyouzhiyideMacBook-Pro y-cli % yyt helloerror: missing required argument &#x27;param1&#x27;ziyouzhiyi@ziyouzhiyideMacBook-Pro y-cli % yyt hello t tundefinedziyouzhiyi@ziyouzhiyideMacBook-Pro y-cli % yyt hello t yty ä¸Šé¢è¿™äº›å‚æ•°ä¹Ÿå¯é€šè¿‡.option()æ¥å®ç°ï¼Œä½†éœ€è¦åŠ ä¸Š-ï¼Œå¦‚-reactï¼Œå¦‚ä»¥ä¸‹çš„ä¾‹å­ï¼Œåˆ©ç”¨å‚æ•°åˆ›å»ºé¡¹ç›®ï¼š 12345678910111213141516program.command(&#x27;create &lt;projectName&gt;&#x27;) .option(&#x27;-react&#x27;) .option(&#x27;-vue&#x27;) .action((projectName, option) =&gt; &#123; const type = Object.keys(option)[0] switch(type) &#123; case &quot;Vue&quot;: console.log(&quot;åˆ›å»ºvueé¡¹ç›®&quot;) break; case &quot;React&quot;: console.log(&quot;åˆ›å»ºreacté¡¹ç›®&quot;) break; default: console.log(&quot;æœªæ·»åŠ å‚æ•°ï¼Œä¸èƒ½ä¸‹è½½&quot;) &#125; &#125;) æ‰§è¡Œå‘½ä»¤åå¯ä»¥çœ‹åˆ°æ‰“å°ï¼š 12ziyouzhiyi@ziyouzhiyideMacBook-Pro y-cli % yyt create test -reactåˆ›å»ºreacté¡¹ç›® download-git-repoä¸‹è½½çš„æ­¥éª¤æŠŠä»–æ›¿æ¢æˆçœŸçš„ä»“åº“ï¼Œéœ€è¦ç”¨åˆ° download-git-repo åº“ æŠŠconsole.logæ›¿æ¢æˆçœŸå®çš„gitä»“åº“ 1234567891011121314151617... case &quot;React&quot;: download( // æ­¤å¤„åº”åŠ ä¸Š #main åˆ†æ”¯åç§°ï¼Œå¦åˆ™æ§åˆ¶å°ä¼šæ˜¾ç¤ºæŠ¥é”™ &#x27;direct:git@github.com:ys558/yyt-template.git#main&#x27;, projectName, &#123; clone: true &#125;, (err, x) =&gt; &#123; // é”™è¯¯å›è°ƒï¼š if (err) console.log(err) console.log(`$&#123;projectName&#125; é¡¹ç›®åˆ›å»ºæˆåŠŸ`) &#125; ) break; default: console.log(&quot;æœªæ·»åŠ å‚æ•°ï¼Œä¸èƒ½ä¸‹è½½&quot;)... inquirerğŸ‘†çš„æ­¥éª¤ä¸‹è½½çš„ä»“åº“æ˜¯åœ¨å‘½ä»¤è¡Œä¸‹ç›´æ¥å®Œæˆçš„ï¼Œå¦‚æœè¦åƒvueä¸€æ ·èƒ½è®©ç”¨æˆ·è¾“å…¥ç”Ÿæˆçš„ï¼Œå¯ä»¥ç”¨è¯¥åº“ï¼Œæˆ‘ä»¬æŠŠä»£ç æ”¹é€ ä¸€ä¸‹ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ .action() çš„å›è°ƒä¸­è¿›è¡Œå¤„ç† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556const questions = [ &#123; type: &#x27;input&#x27;, name: &#x27;projectName&#x27;, message: &#x27;è¯·è¾“å…¥é¡¹ç›®åç§°&#x27;, &#125;, &#123; type: &#x27;list&#x27;, name: &#x27;frameWork&#x27;, message: &#x27;è¯·é€‰æ‹©æ¡†æ¶&#x27;, default: &#x27;React&#x27;, choices: [&#x27;React&#x27;,&#x27;Vue&#x27;] &#125;,]program .command(&#x27;create&#x27;) .action(() =&gt; &#123; inquirer.prompt(questions) .then((&#123;projectName, frameWork&#125;) =&gt; &#123; switch (frameWork) &#123; case &#x27;React&#x27;: download( &#x27;direct:git@github.com:ys558/yyt-template.git&#x27;, projectName, &#123; clone: true &#125;, (err) =&gt; &#123; // é”™è¯¯å›è°ƒï¼š if (err) &#123; console.log(err) return &#125;else&#123; console.log(`$&#123;projectName&#125; é¡¹ç›®åˆ›å»ºæˆåŠŸ`) &#125; &#125;) break; case &#x27;Vue&#x27;: download( &#x27;direct:git@github.com:ys558/yyt-template.git&#x27;, projectName, &#123; clone: true &#125;, (err) =&gt; &#123; // é”™è¯¯å›è°ƒï¼š if (err) &#123; console.log(err) return &#125;else&#123; console.log(`$&#123;projectName&#125; é¡¹ç›®åˆ›å»ºæˆåŠŸ`) &#125; &#125;) break; default: break; &#125; &#125;) &#125;) ç¾åŒ–chalkï¼Œfigletç¾åŒ–ç»ˆç«¯å­—ä½“ï¼Œå¦‚ chalk: 123456if (err) &#123; console.log(chalk.bgYellow(err)) return&#125;else&#123; console.log(`$&#123;chalk.bgGrey(projectName)&#125; $&#123;chalk.greenBright(&#x27;é¡¹ç›®åˆ›å»ºæˆåŠŸ&#x27;)&#125;`)&#125; figlet: 1234figlet.defaults(&#123;font: &#x27;Standard&#x27;&#125;)function logo()&#123; console.log(figlet.textSync(&#x27;hi yyt!&#x27;))&#125; oraè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„æ¨¡å—ï¼Œä»–æ˜¯ es module ç±»å‹çš„importå¯¼å…¥æ¨¡å—ï¼Œè€Œ node ç”¨çš„æ˜¯commonjs çš„ require å¯¼å…¥æ¨¡å—ï¼Œè€Œä¸”é¡»åœ¨ package.json é‡Œæ·»åŠ  &#123; &quot;type&quot; : &quot;module&quot; &#125; æ‰èƒ½æ­£å¸¸åŠ è½½ï¼Œä¸‹é¢è´´ä¸Šç›¸å…³ä»£ç ï¼š 123456const spinner = ora(&quot;ä¸‹è½½åˆå§‹åŒ–æ¨¡æ¿ä¸­...&quot;)spinner.start()spinner.succeed(`$&#123;chalk.bgGrey(projectName)&#125; $&#123;chalk.greenBright(&#x27;é¡¹ç›®åˆ›å»ºæˆåŠŸ&#x27;)&#125;`)spinner.stop() å®Œæ•´ä»£ç ä»“åº“","categories":[],"tags":[{"name":"node cli","slug":"node-cli","permalink":"https://zyzy.info/tags/node-cli/"}]},{"title":"react-ssræœåŠ¡ç«¯æ¸²æŸ“","slug":"ã€2021-08-27ã€‘react-ssræœåŠ¡ç«¯æ¸²æŸ“","date":"2021-08-27T14:02:07.000Z","updated":"2021-10-14T03:42:59.913Z","comments":true,"path":"2021/08/27/ã€2021-08-27ã€‘react-ssræœåŠ¡ç«¯æ¸²æŸ“/","link":"","permalink":"https://zyzy.info/2021/08/27/%E3%80%902021-08-27%E3%80%91react-ssr%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93/","excerpt":"æœåŠ¡ç«¯æ¸²æŸ“èƒ½è§£å†³é¦–å±åŠ è½½è¿‡æ…¢çš„é—®é¢˜ï¼Œè¿‘å¹´æ¥è¿™æ˜¯ä¸€ä¸ªè¶‹åŠ¿ï¼Œè¿™é‡Œå†™ä¸€ä¸ªreactçš„demoï¼Œä»¥å…å¿˜äº†ã€‚","text":"æœåŠ¡ç«¯æ¸²æŸ“èƒ½è§£å†³é¦–å±åŠ è½½è¿‡æ…¢çš„é—®é¢˜ï¼Œè¿‘å¹´æ¥è¿™æ˜¯ä¸€ä¸ªè¶‹åŠ¿ï¼Œè¿™é‡Œå†™ä¸€ä¸ªreactçš„demoï¼Œä»¥å…å¿˜äº†ã€‚ æœ¬æ–‡æ¶‰åŠçš„ react apiå¦‚ä¸‹ï¼š ReactDOM.hydrate(&lt;App /&gt;,document.getElementById(&#39;root&#39;) ReactDOMServer.renderToString(&lt;App/&gt;) ç”¨è„šæ‰‹æ¶åˆå§‹åŒ–é¡¹ç›®è¿™éƒ¨åˆ†ä¸è§£é‡Šï¼Œç”¨è„šæ‰‹æ¶å¿«é€Ÿç”Ÿæˆä¸€ä¸ªapp ï¼æ³¨æ„: create-react-app æ–°ç‰ˆæœ¬ç”Ÿæˆçš„ App.js å·²ç»æ²¡æœ‰ import React from &#39;react&#39;ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠå®ƒåŠ å›æ¥ï¼Œå¦åˆ™æœåŠ¡ç«¯æ¸²æŸ“ä¼šæŠ¥é”™ï¼š 123456789101112131415+ import React from &#x27;react&#x27;import &#123; useState &#125; from &#x27;react&#x27;;import &#x27;./App.css&#x27;;function App() &#123; const [count, setCount] = useState(0) return &lt;div className=&quot;App&quot;&gt; &lt;p&gt;&#123;count&#125;&lt;/p&gt; &lt;button onClick=&#123;()=&gt; setCount(count + 1 )&#125;&gt;+&lt;/button&gt; &lt;button onClick=&#123;()=&gt; setCount(count-1)&#125;&gt;-&lt;/button&gt; &lt;/div&gt;&#125;export default App; æ·»åŠ æœåŠ¡ç«¯1234yarn add express# é¦–é¡µé¡»è¿›è¡Œæ‰“åŒ…æ“ä½œç»™æœåŠ¡ç«¯åšæ¸²æŸ“ï¼šyarn buildmkdir server &amp;&amp; cd server &amp;&amp; touch server.js server\\server.js 1234567891011121314151617181920212223242526272829import express from &#x27;express&#x27;import fs from &#x27;fs&#x27;import path from &#x27;path&#x27;import React from &#x27;react&#x27;import ReactDOMServer from &#x27;react-dom/server&#x27;import App from &#x27;../src/App&#x27;const app = express()app.use(&#x27;^/$&#x27;, (req, res, next) =&gt;&#123; fs.readFile(path.resolve(&#x27;../build/index.html&#x27;), &#x27;utf-8&#x27;, (err, data) =&gt; &#123; if (err) &#123; console.log(err) return res.status(500).send(&#x27;smoe error happened&#x27;) &#125; return res.send(data.replace( &#x27;&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;&#x27;, `&lt;div id=&quot;root&quot;&gt;$&#123;ReactDOMServer.renderToString(&lt;App/&gt;)&#125;&lt;/div&gt;` )) &#125; )&#125;)app.use(express.static(path.resolve(__dirname, &#x27;..&#x27;, &#x27;build&#x27;)))const PORT = 8888app.listen(PORT, ()=&gt;console.log(`listen on PORT $&#123;PORT&#125;`)) æŠŠ express è·‘èµ·æ¥ src\\index.js æ”¹é€ 12- ReactDOM.render(&lt;App /&gt;,document.getElementById(&#x27;root&#x27;))+ ReactDOM.hydrate(&lt;App /&gt;,document.getElementById(&#x27;root&#x27;) æ·»åŠ  babel è®©nodeè®¤è¯†jsxè¯­æ³•1yarn add @babel/preset-env @babel/preset-react @babel/register ignore-styles åœ¨ server æ–‡ä»¶å¤¹æ·»åŠ è¿è¡Œ babel æœºåˆ¶æ‰§è¡Œtouch server/index.js nodeåŸç”Ÿçš„å¿…é¡»ç”¨ require çš„å†™æ³•å¯¼å…¥æ¨¡å—ï¼Œå¦‚ä¸‹ï¼š 12345678require(&#x27;ignore-styles&#x27;)require(&#x27;@babel/register&#x27;)(&#123; ignore: [/(node_module)/], presets: [&#x27;@babel/preset-env&#x27;, &#x27;@babel/preset-react&#x27;]&#125;)require(&#x27;./server&#x27;) æ·»åŠ  package.json é‡Œçš„è„šæœ¬åå†è¿è¡Œ yarn ssr 1&quot;ssr&quot;: &quot;node server/index.js&quot; æˆ‘ä»¬ä¼šå‘ç°é¡ºåˆ©è§£æäº† jsx è¯­æ³•ï¼š 12345yuyi@home-pc MINGW64 /e/study/code/react-ssr-demo (main)$ yarn ssryarn run v1.22.10$ node server/index.jslisten on PORT 8888","categories":[],"tags":[{"name":"ssr","slug":"ssr","permalink":"https://zyzy.info/tags/ssr/"},{"name":"react","slug":"react","permalink":"https://zyzy.info/tags/react/"}]},{"title":"nodeå¤„ç†ES6æ¨¡å—åŠåŠ¨æ€æ¨¡å—å¯¼å…¥","slug":"ã€2021-08-14ã€‘nodeå¤„ç†ES6æ¨¡å—åŠåŠ¨æ€æ¨¡å—å¯¼å…¥","date":"2021-08-14T15:08:06.000Z","updated":"2022-03-26T02:15:30.413Z","comments":true,"path":"2021/08/14/ã€2021-08-14ã€‘nodeå¤„ç†ES6æ¨¡å—åŠåŠ¨æ€æ¨¡å—å¯¼å…¥/","link":"","permalink":"https://zyzy.info/2021/08/14/%E3%80%902021-08-14%E3%80%91node%E5%A4%84%E7%90%86ES6%E6%A8%A1%E5%9D%97%E5%8F%8A%E5%8A%A8%E6%80%81%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5/","excerpt":"æœ¬æ–‡é˜è¿°äº†ä¸¤ä¸ªæ–¹é¢çš„å†…å®¹ã€‚1. nodeå¤„ç†ES6æ¨¡å—ï¼Œå¤§éƒ¨åˆ†å‚è€ƒäº†é˜®ä¸€å³°è€å¸ˆçš„æ–‡ç«  2. åŠ¨æ€æ¨¡å—å¯¼å…¥","text":"æœ¬æ–‡é˜è¿°äº†ä¸¤ä¸ªæ–¹é¢çš„å†…å®¹ã€‚1. nodeå¤„ç†ES6æ¨¡å—ï¼Œå¤§éƒ¨åˆ†å‚è€ƒäº†é˜®ä¸€å³°è€å¸ˆçš„æ–‡ç«  2. åŠ¨æ€æ¨¡å—å¯¼å…¥ nodeï¼ˆCJSï¼‰å¤„ç†ES6æ¨¡å—ï¼ˆESMï¼‰æˆ‘ä»¬çŸ¥é“nodeåªèƒ½é€šè¿‡ require() åŠ è½½æ¨¡å—ï¼Œ module.exportsè¾“å‡ºï¼Œæ˜¯åŒæ­¥æ“ä½œï¼Œè¿™å¥—è¯­æ³•è§„åˆ™ç§°ä½œcommonjsï¼Œå³CJSã€‚ è€ŒES6åˆ™æ˜¯å¦ä¸€å¥—è¯­æ³•è§„åˆ™ï¼ŒECMA Script Moduleï¼Œç®€ç§°ESMã€‚é€šè¿‡importåŠ è½½ï¼Œexportè¾“å‡ºï¼Œæ˜¯å¼‚æ­¥æ“ä½œã€‚ å¦‚æœè¦åœ¨nodeé‡Œç”¨ä¸Š ESM è¯­æ³•è§„åˆ™ï¼Œåˆ™å¾—åšä¸€äº›å¿…è¦çš„æ”¹å˜ï¼š é€šè¿‡æ”¹å˜æ–‡ä»¶åã€‚å°†å¸¦æœ‰ ESM è¯­æ³•è§„åˆ™çš„æ–‡ä»¶ $\\color{CadetBlue} {åç¼€åæ”¹ä¸º .mjs} $ï¼Œnodeåˆ™å¯æ­£å¸¸æ‰§è¡Œã€‚ ä¸æ”¹å˜æ–‡ä»¶åç¼€åï¼Œ$\\color{CadetBlue}åœ¨ package.json é‡Œæ·»åŠ  â€œtypeâ€:â€moduleâ€ ã€‚$ ç›¸å¯¹çš„ï¼Œå¦‚æœè¿™æ—¶æƒ³ç”¨å› require() è¯­æ³•ï¼Œåˆ™è¦æŠŠæ–‡ä»¶åç¼€åæ”¹ä¸ºcjsã€‚$\\color{red} ä½†ä¸¤ç§è¯­æ³•è§„åˆ™å¼ºçƒˆä¸å»ºè®®æ··ç”¨ã€‚$ CommonJS æ¨¡å—åŠ è½½ ES6 æ¨¡å—require() å‘½ä»¤ä¸èƒ½åŠ è½½ ES6 æ¨¡å—ï¼Œä¼šæŠ¥é”™ï¼Œnodeé‡Œåªèƒ½ä½¿ç”¨import()è¿™ä¸ªæ–¹æ³•åŠ è½½ï¼Œå¦‚ 123(async () =&gt; &#123; await import(&#x27;./index.mjs&#x27;)&#125;)() ES6 æ¨¡å—å†…éƒ¨å¯ä»¥ä½¿ç”¨é¡¶å±‚ awaitå‘½ä»¤ï¼Œå¯¼è‡´æ— æ³•è¢«åŒæ­¥åŠ è½½ã€‚ ES6æ¨¡å—åŠ è½½ CommonJS æ¨¡å—import å¯ä»¥åŠ è½½CJSæ¨¡å—ï¼Œä¸èƒ½å•ç‹¬è§£æ„åŠ è½½ã€‚è¿™æ˜¯å› ä¸º ES6 æ¨¡å—éœ€è¦æ”¯æŒé™æ€ä»£ç åˆ†æï¼Œè€Œ CommonJS æ¨¡å—çš„è¾“å‡ºæ¥å£æ˜¯module.exportsï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ— æ³•è¢«é™æ€åˆ†æï¼Œæ‰€ä»¥åªèƒ½æ•´ä½“åŠ è½½ã€‚ 12345// æ­£ç¡®import packageMain from &#x27;commonjs-package&#x27;;// æŠ¥é”™import &#123; method &#125; from &#x27;commonjs-package&#x27;; å¯ä»¥æ”¹æˆå•ä¸€è¾“å‡ºé¡¹ï¼Œå†™æˆä¸‹é¢è¿™ç§ï¼š 12345678import packageMain from &#x27;commonjs-package&#x27;;const &#123; method &#125; = packageMain;// æˆ– ç›´æ¥export æ—¶å¸¦ &#123; &#125;ï¼Œ nodeåˆ™ä¼šè®¤ä¸ºæ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œå¦‚ï¼šimport &#123; method &#125; from &#x27;./other.js&#x27;function method (user) &#123; &#125;export &#123; method &#125; è€Œ class åˆ™ä¸å— default å…³é”®å­—é™åˆ¶ï¼š 123import DefaultClass from &#x27;./other.js&#x27;export default class DefaultClass &#123; &#125; ä¸¤ç§æ ¼å¼æ”¯æŒæ¨¡å— å¦‚æœåŸå§‹æ¨¡å—æ˜¯CJSï¼Œå¯ä»¥åŠ ä¸€ä¸ªåŒ…è£…å±‚ 12import cjsModule from &#x27;./index.js&#x27;export const foo = cjsModle.foo ä¸Šé¢ä»£ç å…ˆæ•´ä½“è¾“å…¥ CommonJS æ¨¡å—ï¼Œç„¶åå†æ ¹æ®éœ€è¦è¾“å‡ºå…·åæ¥å£ã€‚ ä½ å¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶çš„åç¼€åæ”¹ä¸º.mjsï¼Œæˆ–è€…å°†å®ƒæ”¾åœ¨ä¸€ä¸ªå­ç›®å½•ï¼Œå†åœ¨è¿™ä¸ªå­ç›®å½•é‡Œé¢æ”¾ä¸€ä¸ªå•ç‹¬çš„package.jsonæ–‡ä»¶ï¼ŒæŒ‡æ˜&#123; type: &quot;module&quot; &#125; å¦ä¸€ç§åšæ³•æ˜¯åœ¨package.jsonæ–‡ä»¶çš„exportså­—æ®µï¼ŒæŒ‡æ˜ä¸¤ç§æ ¼å¼æ¨¡å—å„è‡ªçš„åŠ è½½å…¥å£ã€‚ 1234&quot;exports&quot;ï¼š&#123; &quot;require&quot;: &quot;./index.js&quot;ï¼Œ &quot;import&quot;: &quot;./esm/wrapper.js&quot; &#125; ä¸Šé¢ä»£ç æŒ‡å®šrequire()å’Œimportï¼ŒåŠ è½½è¯¥æ¨¡å—ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°ä¸ä¸€æ ·çš„å…¥å£æ–‡ä»¶ã€‚ æ¨¡å—åŠ¨æ€å¯¼å…¥import æ™®é€šåŒæ­¥æ¨¡å—å¯¼å…¥ï¼šè¿™é‡Œå¼€å§‹æœ¬ç¯‡ç¬¬äºŒä¸ªå†…å®¹ï¼Œæ¨¡å—åŠ¨æ€å¯¼å…¥ã€‚è¿™é‡Œä»¥ESMå†™æ³•ä¸ºä¾‹ï¼Œç”¨nodeè¿è¡Œåœ¨ package.json æ–‡ä»¶é‡ŒåŠ ä¸Šï¼š&quot;type&quot;: &quot;module&quot; ä¸‹é¢ä¸¾ä¸ªç®€å•çš„ç¿»è¯‘çš„ä¾‹å­æ¥è¯´æ˜ï¼Œ ./tranlate/en-translation.js 12const translations = &#123; HI: &#x27;hello&#x27; &#125;export const enTranslations = translations ./tranlate/sp-translation.js 12const translations = &#123; HI: &#x27;hola&#x27; &#125;export const spTranslations = translations ./locale.js 12345678910111213import &#123;enTranslations&#125; from &#x27;./translate/en-translation.js&#x27;import &#123;spTranslations&#125; from &#x27;./translate/sp-translation.js&#x27;const user = &#123; locale: &#x27;sp&#x27;&#125;let translationsswitch (user.locale) &#123; case &#x27;sp&#x27;: translations = spTranslations break default: translations = enTranslations break&#125;console.log(translations.HI) // hola è¿è¡Œ node locale.js å¯ä»¥å‘ç°æ‰“å°å‡º hola çš„å†…å®¹ã€‚ ä»¥ä¸Šæ˜¯æˆ‘ä»¬å¹³æ—¶importçš„åšæ³•ï¼Œè¿™ç§æ˜¯åŒæ­¥çš„å†™æ³•ï¼Œimportå®Œåæ‰€æœ‰çš„æ–‡ä»¶ä¼šè¢«åŠ è½½ä¸€éï¼Œå¦‚æœæ–‡ä»¶ä¸€å¤§çš„è¯ï¼Œåˆ™ä¼šå½±å“æ•ˆç‡ã€‚ import() å¼‚æ­¥æ¨¡å—å¯¼å…¥ï¼ŒæŒ‰éœ€åŠ è½½ï¼ŒCJSå†™æ³•ï¼šå¯¹ä»¥ä¸Šç¿»è¯‘æ¨¡å—çš„ä»£ç è¿›è¡Œæ”¹åŠ¨ï¼Œ ç”±äºnodeé‡Œé™¤äº† classï¼Œå‡½æ•°å’Œ{} å‡æ²¡æœ‰ defalut å…³é”®å­—ï¼Œæ‰€ä»¥åªèƒ½å…·åè¿›è¡Œè§£æ„ï¼š./locale.js 123456const user = &#123; locale: &#x27;sp&#x27;&#125;import(`./translate/$&#123;user.locale&#125;-translation.js`) .then((&#123; enTranslations=&#123;&#125;, spTranslations=&#123;&#125; &#125;) =&gt; &#123; console.log(spTranslations.HI) &#125;) æ­¤æ—¶å¯ä»¥çœ‹åˆ°æ§åˆ¶å°æ‰“å° holaï¼š 1234567yuyi@home-pc MINGW64 /e/study/code/dynamic-import-module (master)$ npm run l&gt; dynamic-import-module@1.0.0 l E:\\study\\code\\dynamic-import-module&gt; node locale.jshola æˆ‘ä»¬åˆšåˆšæ”¹é€ ä¹‹å‰çš„ switch å‡½æ•°çš„ default åˆ†æ”¯æ”¹å†™ï¼Œåˆ™ç”¨ catchæ›¿ä»£ï¼šå¦‚æœä¼ å…¥ä¸ºæ‰¾ä¸åˆ°çš„è¯­è¨€ï¼Œåˆ™ä¼šé»˜è®¤è¾“å‡ºè‹±æ–‡çš„ç¿»è¯‘ 123456789// é»˜è®¤åªæœ‰enå’Œspï¼Œæ‰¾ä¸åˆ°çš„è¯­è¨€ cnï¼šconst user = &#123; locale: &#x27;cn&#x27; &#125; ... // åˆ©ç”¨catchæ›¿ä»£äº†switchå‡½æ•°çš„defaultåˆ†æ”¯ï¼š .catch(()=&gt; import(&#x27;./translate/en-translation.js&#x27;).then( module =&gt; &#123; console.log(module.enTranslations.HI) // hello &#125;)) import() çš„ESMå†™æ³•ï¼šå°†ä»¥ä¸Šçš„ä»£ç æ”¹ä¸ºåœ¨æµè§ˆå™¨ä¸­çš„ESMå†™æ³•ï¼Œåœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œæ”¹å†™å¦‚ä¸‹ï¼š locale.html 123456789&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt; &lt;!-- æµè§ˆå™¨ä¹Ÿå¾—åœ¨scriptæ ‡ç­¾ä¸Šä»è¦è§„å®š type=&quot;module&quot; --&gt; &lt;script type=&quot;module&quot; src=&quot;./loacleEMS.js&quot;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ./translate/ESM-en-translation.js 12const translations = &#123; HI: &#x27;hello&#x27; &#125;export default translations ./translate/ESM-sp-translation.js 12const translations = &#123; HI: &#x27;hola&#x27; &#125;export default translations ./loacleEMS.js 12345678910111213141516import enTranslations from &#x27;./translate/ESM-en-translation.js&#x27;import spTranslations from &#x27;./translate/ESM-sp-translation.js&#x27;const user = &#123; locale: &#x27;sp&#x27;&#125;let translationsswitch (user.locale) &#123; case &#x27;sp&#x27;: translations = spTranslations break; default: translations = enTranslations break;&#125;console.log(translations.HI) // hola æ”¹å†™ä¸º import() æ–¹æ³•çš„ ./loacleEMS.jsã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºESM export çš„å…³é”®å­—å±æ€§å¯¹æ‰€æœ‰å‡½æ•°objectç­‰éƒ½æœ‰æ•ˆï¼Œèƒ½åŒ¿ååˆ°å¤„ï¼Œæ‰€ä»¥å†™èµ·æ¥æ›´åŠ ç®€æ´ 1234567const user = &#123; locale: &#x27;sp&#x27;&#125;import(`./translate/ESM-$&#123;user.locale&#125;-translation.js`) // å¯ç›´æ¥è§£æ„åŒ¿å default çš„å€¼ï¼š .then((&#123; default: translations &#125;) =&gt; console.log(translations.HI) // hola ) è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æ€ä¹ˆæ”¹å†™ switch-default åˆ†æ”¯å‘¢ï¼Ÿç­”æ¡ˆæ˜¯åˆ©ç”¨ .catch()ï¼Œå¹¶ä¸”æˆ‘ä»¬æŠŠ const user = &#123; locale: &#39;sp&#39;&#125; æ”¹å†™ä¸º const user = &#123; locale: &#39;cn&#39;&#125;ï¼Œä¸€ä¸ªæ–‡ä»¶é‡Œæ²¡æœ‰çš„è¯­è¨€ 12345678910const user = &#123; locale: &#x27;cn&#x27;&#125;import(`./translate/ESM-$&#123;user.locale&#125;-translation.js`)// å°†.then() æ”¾ç½®äº.catch() é‡Œçš„å›è°ƒ import() ä¹‹åæ‰§è¡Œï¼Œ// è¿™æ ·ï¼Œæ§åˆ¶å°æŠ¥é”™æ‰¾ä¸åˆ° &#x27;cn&#x27;ï¼Œä½†ç¨‹åºä»ä¼šå¾€ä¸‹èµ°ï¼š.catch(()=&gt; import(&#x27;./translate/ESM-en-translation.js&#x27;) .then( (&#123; default: translations&#125;) =&gt; &#123; console.log(translations.HI) // hello &#125;))","categories":[],"tags":[{"name":"node","slug":"node","permalink":"https://zyzy.info/tags/node/"},{"name":"ES6","slug":"ES6","permalink":"https://zyzy.info/tags/ES6/"},{"name":"ESM","slug":"ESM","permalink":"https://zyzy.info/tags/ESM/"},{"name":"CJS","slug":"CJS","permalink":"https://zyzy.info/tags/CJS/"}]},{"title":"reactç»„ä»¶å˜å¤–æ§çš„å‡ ç§æ–¹å¼ï¼ševentEmitterã€refã€props_this","slug":"ã€2021-08-14ã€‘reactç»„ä»¶å˜å¤–æ§çš„å‡ ç§æ–¹å¼ï¼ševentEmitterã€refã€props_this","date":"2021-08-14T14:19:32.000Z","updated":"2021-10-14T03:42:59.913Z","comments":true,"path":"2021/08/14/ã€2021-08-14ã€‘reactç»„ä»¶å˜å¤–æ§çš„å‡ ç§æ–¹å¼ï¼ševentEmitterã€refã€props_this/","link":"","permalink":"https://zyzy.info/2021/08/14/%E3%80%902021-08-14%E3%80%91react%E7%BB%84%E4%BB%B6%E5%8F%98%E5%A4%96%E6%8E%A7%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%9AeventEmitter%E3%80%81ref%E3%80%81props_this/","excerpt":"æœ€è¿‘å¾ˆå¿™ï¼Œæäº†å¾ˆä¹…æ²¡æ›´æ–°äº†ï¼Œè¶ç€ä»Šå¤©ç©ºé—²æ¥æ›´æ–°ä¸€æ³¢ã€‚ç»„ä»¶å¤–æ§çš„å¥½å¤„æ˜¯èƒ½ä½¿å¾—Reactæœ€è¿‘è§£é”äº†ç»„ä»¶ä¼ å€¼çš„æ–°æ¨¡å¼ï¼ŒEventEmitterï¼Œfbä¹Ÿå°è£…äº†ä¸€ä¸ªfbemitterçš„ç»„ä»¶ï¼Œç”¨äºfbç½‘ç«™é—´çš„ä¼ å€¼ã€‚ç”¨è¿‡vueçš„å°ä¼™ä¼´å¯¹event emitterè‚¯å®šä¸é™Œç”Ÿã€‚è¿™é‡Œç»“åˆreactçš„ä½¿ç”¨æ¥ç®€å•è¯´æ˜ä¸€ä¸‹ç”¨æ³•ã€‚","text":"æœ€è¿‘å¾ˆå¿™ï¼Œæäº†å¾ˆä¹…æ²¡æ›´æ–°äº†ï¼Œè¶ç€ä»Šå¤©ç©ºé—²æ¥æ›´æ–°ä¸€æ³¢ã€‚ç»„ä»¶å¤–æ§çš„å¥½å¤„æ˜¯èƒ½ä½¿å¾—Reactæœ€è¿‘è§£é”äº†ç»„ä»¶ä¼ å€¼çš„æ–°æ¨¡å¼ï¼ŒEventEmitterï¼Œfbä¹Ÿå°è£…äº†ä¸€ä¸ªfbemitterçš„ç»„ä»¶ï¼Œç”¨äºfbç½‘ç«™é—´çš„ä¼ å€¼ã€‚ç”¨è¿‡vueçš„å°ä¼™ä¼´å¯¹event emitterè‚¯å®šä¸é™Œç”Ÿã€‚è¿™é‡Œç»“åˆreactçš„ä½¿ç”¨æ¥ç®€å•è¯´æ˜ä¸€ä¸‹ç”¨æ³•ã€‚ eventEmitterå¼•å…¥12import &#123; EventEmitter &#125; from &#x27;fbemitter&#x27;;var emitter = new EventEmitter(); å®šä¹‰äº‹ä»¶å†™ä¸¤ä¸ªæ²¡æœ‰å±‚çº§å…³ç³»çš„ç»„ä»¶ï¼š 12345678910111213141516171819202122232425262728293031import React, &#123; Component &#125; from &#x27;react&#x27;import &#123; EventEmitter &#125; from &#x27;fbemitter&#x27;export default class EventEmitterDemo extends Component &#123; render() &#123; // 0. å¯ç”¨äºæ— å±‚çº§å…³ç³»ç»„ä»¶ä¼ å€¼ï¼š return &lt;&gt; &lt;Child1 /&gt; &lt;Child2 /&gt; &lt;/&gt; &#125;&#125;// 1. åˆå§‹åŒ–const emitter = new EventEmitter()class Child1 extends Component &#123; state = &#123; show: &#x27;&#x27; &#125; componentDidMount() &#123; // 2. å®šä¹‰ this.eventEmitter = emitter.addListener( &#x27;event&#x27;, (x,y)=&gt; this.setState(&#123; show: &lt;&gt;&#123;x&#125;,&#123;y&#125;&lt;/&gt; &#125;) ) &#125; render()&#123; return &lt;div&gt; &#123;this.state.show&#125; &lt;/div&gt; &#125;&#125; å‘å‡ºå¹¶è§¦å‘äº‹ä»¶12345678class Child2 extends Component &#123; // 3. å‘å‡ºäº‹ä»¶åç§°åŠå‚æ•°ï¼š render()&#123; return &lt;div&gt; &lt;button onClick=&#123;()=&gt; emitter.emit(&#x27;event&#x27;, 12, 22)&#125;&gt;eventEmitterå‘å‡ºï¼Œè§æ§åˆ¶å°&lt;/button&gt; &lt;/div&gt; &#125;&#125; æ•ˆæœ once(eventType, callback)åªè°ƒç”¨ä¸€æ¬¡çš„eventEmitterï¼Œå¦‚ï¼š 123456789componentDidMount() &#123; this.eventEmitter = emitter.once( &#x27;event&#x27;, (x,y)=&gt; console.log(x,y) )&#125;emitter.emit(&#x27;event&#x27;, 13); // 10 //å†æ¬¡è§¦å‘emitter.emit(&#x27;event&#x27;, 12); // ä¸ä¼šè¾“å‡º remove(eventType) åŠ removeAllListeners(eventType)åˆ é™¤äº‹ä»¶ï¼Œä¸€èˆ¬æˆ‘ä»¬åœ¨ç»„ä»¶å¸è½½æ—¶åº”è¯¥æ‰§è¡Œremoveè¿›è¡Œåˆ é™¤ï¼Œè€ŒremoveAllListenersåˆ™å¯ä»¥ä¸€æ¬¡æ€§åˆ é™¤æ‰€æœ‰ç›‘å¬äº‹ä»¶ï¼Œå¦‚ï¼š 123456componentWillUnmount()&#123; // 3. å½“ç»„ä»¶å¸è½½æ—¶è¦å°†å…¶åˆ é™¤ this.eventEmitter.remove(); // æˆ–ï¼š this.removeAllListeners()&#125; å­ç»„ä»¶æ¥æ”¶æ•´ä¸ªçˆ¶ç»„ä»¶thiså®ä¾‹ï¼Œè¾¾åˆ°å­ç»„ä»¶æ§åˆ¶çˆ¶ç»„ä»¶çš„ç›®çš„è¿™ç§åŸç†ç±»ä¼¼HOCå’Œè£…é¥°å™¨å‡½æ•°ï¼Œä½†æ¯”HOCå†™æ³•æ›´ç®€æ´æ˜äº†ï¼Œç›´æ¥ä¸Šä»£ç  12345678910111213141516171819202122export class ByPropsThis extends Component &#123; state = &#123; count: 0&#125; render()&#123; return &lt;&gt; Father count: &#123;this.state.count&#125; &lt;Child thisFrFather=&#123;this&#125; /&gt; &lt;/&gt; &#125;&#125;class Child extends Component &#123; render()&#123; console.log(this.props.thisFrFather.state) return &lt;div&gt; &lt;p&gt;&#123;this.props.count&#125;&lt;/p&gt; &lt;button onClick=&#123;()=&gt; this.props.thisFrFather.setState((&#123;count&#125;) =&gt; (&#123;count: count + 1&#125;))&#125;&gt; child + &lt;/button&gt; &lt;/div&gt; &#125;&#125; Ref çˆ¶æ§åˆ¶å­çš„äº‹ä»¶1234567891011121314151617181920212223242526272829export class ByRef extends Component &#123; testFunc = null // è‡ªåŠ¨å»å¯»æ‰¾ ChildToPlusé‡Œçš„ plus() å‡½æ•°æ‰§è¡Œï¼š handleChildPlus = () =&gt; this.testFunc.plus() render()&#123; return &lt;&gt; &lt;button onClick=&#123;this.handleChildPlus&#125;&gt;plus fr father&lt;/button&gt; &#123;/* æ•´ä¸ªChildToPluséƒ½è¢«æ‰“ä¸Šrefæ ‡è®° */&#125; &lt;ClickToPlus ref=&#123; ref =&gt; this.testFunc = ref &#125; /&gt; &lt;/&gt; &#125;&#125;class ClickToPlus extends Component &#123; constructor(props)&#123; super(props) this.state = &#123;count : 0&#125; &#125; plus = () =&gt; this.setState((&#123; count &#125;) =&gt; (&#123; count: count + 1 &#125;)) render() &#123; return ( &lt;div&gt; &lt;p&gt;&#123;this.state.count&#125;&lt;/p&gt; &lt;button onClick=&#123;this.plus&#125;&gt;child +&lt;/button&gt; &lt;/div&gt; ) &#125;&#125;","categories":[],"tags":[{"name":"react","slug":"react","permalink":"https://zyzy.info/tags/react/"},{"name":"eventEmitter","slug":"eventEmitter","permalink":"https://zyzy.info/tags/eventEmitter/"}]},{"title":"å‘å¸ƒè‡ªå·±çš„npm-packageæµç¨‹","slug":"ã€2021-07-07ã€‘å‘å¸ƒè‡ªå·±çš„npm-packageæµç¨‹","date":"2021-07-07T01:11:03.000Z","updated":"2021-10-14T03:42:59.913Z","comments":true,"path":"2021/07/07/ã€2021-07-07ã€‘å‘å¸ƒè‡ªå·±çš„npm-packageæµç¨‹/","link":"","permalink":"https://zyzy.info/2021/07/07/%E3%80%902021-07-07%E3%80%91%E5%8F%91%E5%B8%83%E8%87%AA%E5%B7%B1%E7%9A%84npm-package%E6%B5%81%E7%A8%8B/","excerpt":"æœ€è¿‘å·¥ä½œéœ€è¦ï¼Œéœ€å‘å¸ƒè‡ªå·±çš„npmåŒ…ï¼Œè¿™é‡Œå†™ä¸€ä¸ªç®€å•çš„demoï¼Œåšä¸€ä¸ªç®€å•çš„è®°å½•ã€‚","text":"æœ€è¿‘å·¥ä½œéœ€è¦ï¼Œéœ€å‘å¸ƒè‡ªå·±çš„npmåŒ…ï¼Œè¿™é‡Œå†™ä¸€ä¸ªç®€å•çš„demoï¼Œåšä¸€ä¸ªç®€å•çš„è®°å½•ã€‚ 1. æ³¨å†Œä¸€ä¸ªè‡ªå·±çš„npmè´¦å·è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è§£é‡Šçš„ 2. å»ºä¸€ä¸ªgithubä»“åº“è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è§£é‡Šçš„ 3. é¡¹ç›®ç»“æ„12|__&#x2F;package&#x2F;|__&#x2F;test-folder&#x2F; /package æ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾æˆ‘ä»¬å†™çš„åŒ…/test-folder æ–‡ä»¶å¤¹ç”¨äºå¼•ç”¨å¹¶æµ‹è¯• /package é‡Œçš„åŒ… ç¼–å†™åŒ… my-package-publish-test åœ¨ /package é‡Œåˆå§‹åŒ–é¡¹ç›® npm init å¹¶å†™ä¸€äº›å…³äºè¯¥ package çš„åå­—ï¼Œå¦‚my-package-publish-test å’Œæè¿°ç­‰ä¸œè¥¿åƒå†™æ™®é€šæ–‡ä»¶ä¸€æ ·ï¼Œæ–°å»º/package/index.js å¹¶å†™ä¸‹ä¸€äº›ç®€å•åŠŸèƒ½ï¼Œå¦‚ 12const isTest = string =&gt; string === &#x27;test&#x27;module.exports = isTest 4. é€šè¿‡è½¯é“¾æ¥åœ¨æœ¬åœ°ä½¿ç”¨åŒ…/packageå¦‚ä¸ä¸Šä¼ åŒ…åˆ°npmï¼Œæœ¬åœ°ä½¿ç”¨å¯ä»¥ç›´æ¥ä½¿ç”¨è½¯é“¾æ¥ï¼Œå¯ä»¥ç”¨äºæœ¬åœ°è°ƒè¯•ç­‰å·¥ä½œï¼Œæ–¹æ³•å¦‚ä¸‹ã€‚å¦‚è¦ç›´æ¥ä¸Šä¼ å¯è·³è¿‡è¯¥æ­¥éª¤ åœ¨å½“å‰ç›®å½• ./package/ ä¸‹è¿è¡Œåˆ›å»ºè½¯é“¾æ¥ 1npm link è¿”å› ./test-folder/ ä¸‹è¿è¡Œè½¯é“¾æ¥ï¼Œè½¯é“¾æ¥åçš„åå¿…é¡»å¯¹åº” package/package.json çš„ &quot;name&quot; 12cd ../test-folder/npm link my-package-publish-test 5. ç™»å½•å¹¶å‘å¸ƒè¿”å› ./package/ å¹¶æ‰§è¡Œç™»å½•ï¼Œè¿è¡Œ 12cd ../package/npm login è¾“å…¥ä¸€äº› npmjs.orgçš„ç”¨æˆ·åå¯†ç ç­‰ï¼Œç™»å½•npmè´¦å· 123456$ npm loginUsername: ys558Password:Email: (this IS public)Email: (this IS public) yuyi.gz@163.comLogged in as ys558 on https://registry.npmjs.org/. ï¼ï¼å¦‚å‡ºç°ä»¥ä¸‹æŠ¥é”™éœ€è¦ç™»å½•è‡ªå·±çš„é‚®ç®±æ˜¯å¦é€šè¿‡ npmjs.org çš„éªŒè¯é‚®ä»¶ 1234567npm ERR! code E403npm ERR! 403 403 Forbidden - PUT http://registry.npmjs.org/my-package-publish-test - Forbiddennpm ERR! 403 In most cases, you or one of your dependencies are requestingnpm ERR! 403 a package version that is forbidden by your security policy.npm ERR! A complete log of this run can be found in:npm ERR! C:\\Users\\yuyi\\AppData\\Roaming\\npm-cache\\_logs\\2021-07-04T12_02_21_879Z-debug.log æœ€åè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå³å¯å‘å¸ƒæˆåŠŸå±äºè‡ªå·±çš„npm package 1npm publish å‘å¸ƒæˆåŠŸï¼š 1234567891011121314151617$ npm publishnpm notice npm notice package: my-package-publish-test@1.0.0npm notice === Tarball Contents ===npm notice 85B index.jsnpm notice 564B package.jsonnpm notice 21B README.mdnpm notice === Tarball Details ===npm notice name: my-package-publish-testnpm notice version: 1.0.0npm notice package size: 509 Bnpm notice unpacked size: 670 Bnpm notice shasum: 98b90c3ab222a573f0379802cc3d59d43ffcb402npm notice integrity: sha512-Fz/SDMr5vgoAe[...]UD5J4OP0rFtFA==npm notice total files: 3npm notice+ my-package-publish-test@1.0.0 6. å‘å¸ƒå…·æœ‰å‘½åç©ºé—´çš„packageæ‰€è°“çš„å‘½åç©ºé—´ï¼Œå°±æ˜¯ä»¥ @ å¼€å¤´çš„åŒ…ï¼Œä¾‹å¦‚æˆ‘ä»¬ç†Ÿæ‚‰çš„ @babel/coreï¼Œä¸€èˆ¬è¿™ç§éœ€è¦åˆ›å»ºç»„ç»‡organizationï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š 6.1 åœ¨è‡ªå·±çš„npmé¡µé¢ç”³è¯·æˆç«‹ä¸€ä¸ªç»„ç»‡ï¼Œorganizationæˆ‘æŠŠå‡ ä¸ªå…³é”®æ­¥éª¤è¿›è¡Œäº†æˆªå›¾ï¼Œå¦‚ä¸‹ å¦‚æœæœ‰æ¡ä»¶å¯ä»¥é€‰æ‹©æ”¶è´¹çš„ï¼Œå…¶å®ä¹Ÿä¸è´µï¼Œä¸€ä¸ªæœˆä¹Ÿå°±7ç¾åˆ€ï¼Œ40å¤šè½¯å¦¹å¸ï¼›ä¹Ÿå¯ä»¥ç›´æ¥å°†ä½ çš„è´¦å·è½¬æ¢ä¸ºç»„ç»‡è´¦å·ï¼Œæˆ‘è¿™é‡Œä¸ºäº†æ¼”ç¤ºï¼Œé€‰æ‹©å…è´¹å…¬å¼€è´¦å·ç¬¬äºŒä¸ªé€‰é¡¹ï¼š 6.2 é‡æ–°ç”¨ç»„ç»‡çš„åè¿›è¡Œç™»å½•æ‰§è¡Œ npm login scope=&lt;ç»„ç»‡åç§°&gt; ï¼Œç”¨æˆ·åä¹Ÿå’Œç»„ç»‡åç§°ä¸€æ ·ï¼š 12345$ npm login scope=zyzy-orgUsername: zyzy-orgPassword:Email: (this IS public) yuyi.gz@163.comLogged in as zyzy-org on https://registry.npmjs.org/. 6.3 åœ¨å‘å¸ƒçš„åŒ…å‰åŠ ä¸Š @ç»„ç»‡åå°†è¯¥é¡¹ç›®çš„ package\\package.json é‡Œ &quot;name&quot; çš„å±æ€§æ”¹ä¸ºå¦‚ä¸‹ï¼Œå‰é¢åŠ ä¸ª @zyzy-org/ 123&#123; &quot;name&quot;: &quot;@my-test-package/my-package-publish-test&quot;,&#125; 6.4 è¿è¡Œ npm publish --access=publicå³å¯è§åˆ°å‘å¸ƒæˆåŠŸï¼š 1234567891011121314151617$ npm publish --access=publicnpm notice npm notice package: @zyzy-org/my-package-publish-test@1.0.0npm notice === Tarball Contents ===npm notice 69B index.jsnpm notice 574B package.jsonnpm notice 21B README.mdnpm notice === Tarball Details ===npm notice name: @zyzy-org/my-package-publish-testnpm notice version: 1.0.0npm notice package size: 503 Bnpm notice unpacked size: 664 Bnpm notice shasum: ddc493df353964be87f43d14e5f7fd877b7b4c04npm notice integrity: sha512-XFE19u9gFMcI1[...]1/LA3ocSzHZ8Q==npm notice total files: 3npm notice+ @zyzy-org/my-package-publish-test@1.0.0 6.5 æ–°é¡¹ç›®åˆå§‹åŒ–æ—¶ï¼Œé¡»è¿è¡Œ npm init scope=zyzy-org7 åˆ é™¤å·²å‘å¸ƒçš„åŒ…1npm unpublish @zyzy-org/my-package-publish-test --force","categories":[],"tags":[{"name":"npm package","slug":"npm-package","permalink":"https://zyzy.info/tags/npm-package/"}]},{"title":"JWTè‡ªå­¦ç¬”è®°","slug":"ã€2021-06-21ã€‘JWTè‡ªå­¦ç¬”è®°","date":"2021-06-21T08:37:49.000Z","updated":"2021-10-14T03:42:59.913Z","comments":true,"path":"2021/06/21/ã€2021-06-21ã€‘JWTè‡ªå­¦ç¬”è®°/","link":"","permalink":"https://zyzy.info/2021/06/21/%E3%80%902021-06-21%E3%80%91JWT%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0/","excerpt":"JWTæ˜¯ä¸€ç§è·¨åŸŸé‰´æƒæŠ€æœ¯ï¼Œç°å¹¿æ³›è¿ç”¨äºå„å¤§ç½‘ç«™ï¼Œæœ¬æ–‡ç»“åˆdemoä»£ç ç®€å•é˜è¿°ï¼Œæœ¬ç¯‡çš„æ¦‚å¿µéƒ¨åˆ†1åˆ°4ç‚¹æ¬è¿äº†é˜®å¤§ç¥çš„è¿™ç¯‡æ–‡ç« ï¼Œç¬¬5ç‚¹ç»“åˆæˆ‘è‡ªå·±å†™çš„ä¸€ä¸ªDemoæ¥å®ç°å…·ä½“çš„JWTä¸šåŠ¡","text":"JWTæ˜¯ä¸€ç§è·¨åŸŸé‰´æƒæŠ€æœ¯ï¼Œç°å¹¿æ³›è¿ç”¨äºå„å¤§ç½‘ç«™ï¼Œæœ¬æ–‡ç»“åˆdemoä»£ç ç®€å•é˜è¿°ï¼Œæœ¬ç¯‡çš„æ¦‚å¿µéƒ¨åˆ†1åˆ°4ç‚¹æ¬è¿äº†é˜®å¤§ç¥çš„è¿™ç¯‡æ–‡ç« ï¼Œç¬¬5ç‚¹ç»“åˆæˆ‘è‡ªå·±å†™çš„ä¸€ä¸ªDemoæ¥å®ç°å…·ä½“çš„JWTä¸šåŠ¡ 1. JWTæ˜¯ä»€ä¹ˆï¼ŸJSON Web Token (jwt)æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†(RFC 7519)ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘çš„ã€è‡ªåŒ…å«çš„æ–¹å¼ï¼Œç”¨äºä½œä¸ºJSONå¯¹è±¡åœ¨å„æ–¹ä¹‹é—´å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯å¯ä»¥è¢«éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯æ•°å­—ç­¾åçš„ã€‚ ç®€å•æ¥è¯´å°±æ˜¯ç”¨äºè·¨åŸŸé‰´æƒã€‚ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬é‰´æƒçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š 1ã€ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€ç”¨æˆ·åå’Œå¯†ç ã€‚2ã€æœåŠ¡å™¨éªŒè¯é€šè¿‡åï¼Œåœ¨å½“å‰å¯¹è¯ï¼ˆsessionï¼‰é‡Œé¢ä¿å­˜ç›¸å…³æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·è§’è‰²ã€ç™»å½•æ—¶é—´ç­‰ç­‰ã€‚3ã€æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›ä¸€ä¸ª session_idï¼Œå†™å…¥ç”¨æˆ·çš„ Cookieã€‚4ã€ç”¨æˆ·éšåçš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½ä¼šé€šè¿‡ Cookieï¼Œå°† session_id ä¼ å›æœåŠ¡å™¨ã€‚5ã€æœåŠ¡å™¨æ”¶åˆ° session_idï¼Œæ‰¾åˆ°å‰æœŸä¿å­˜çš„æ•°æ®ï¼Œç”±æ­¤å¾—çŸ¥ç”¨æˆ·çš„èº«ä»½ã€‚ ä¸Šè¿°è¿‡ç¨‹å¦‚æœå•æœºå½“ç„¶æ²¡æœ‰é—®é¢˜ï¼Œå¦‚æœæ˜¯é›†ç¾¤ï¼Œæˆ–è·¨åŸŸçš„æœåŠ¡å¯¼å‘æ¶æ„ï¼Œå°±è¦æ±‚ session æ•°æ®å…±äº«ï¼Œæ¯å°æœåŠ¡å™¨éƒ½èƒ½å¤Ÿè¯»å– sessionã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒA ç½‘ç«™å’Œ B ç½‘ç«™æ˜¯åŒä¸€å®¶å…¬å¸çš„å…³è”æœåŠ¡ã€‚ç°åœ¨è¦æ±‚ï¼Œç”¨æˆ·åªè¦åœ¨å…¶ä¸­ä¸€ä¸ªç½‘ç«™ç™»å½•ï¼Œå†è®¿é—®å¦ä¸€ä¸ªç½‘ç«™å°±ä¼šè‡ªåŠ¨ç™»å½•ï¼Œè¯·é—®æ€ä¹ˆå®ç°ï¼Ÿä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ session æ•°æ®æŒä¹…åŒ–ï¼Œå†™å…¥æ•°æ®åº“æˆ–åˆ«çš„æŒä¹…å±‚ã€‚å„ç§æœåŠ¡æ”¶åˆ°è¯·æ±‚åï¼Œéƒ½å‘æŒä¹…å±‚è¯·æ±‚æ•°æ®ã€‚è¿™ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯æ¶æ„æ¸…æ™°ï¼Œç¼ºç‚¹æ˜¯å·¥ç¨‹é‡æ¯”è¾ƒå¤§ã€‚å¦å¤–ï¼ŒæŒä¹…å±‚ä¸‡ä¸€æŒ‚äº†ï¼Œå°±ä¼šå•ç‚¹å¤±è´¥ã€‚ å¦ä¸€ç§æ–¹æ¡ˆæ˜¯æœåŠ¡å™¨ç´¢æ€§ä¸ä¿å­˜ session æ•°æ®äº†ï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å‘å›æœåŠ¡å™¨ã€‚ jwt å°±æ˜¯è¿™ç§æ–¹æ¡ˆçš„ä¸€ä¸ªä»£è¡¨ã€‚ 2. JWTçš„ç»“æ„æˆ‘ä»¬å¯ä»¥åœ¨å®˜ç½‘çœ‹åˆ°ä»–çš„ç»“æ„ JWTç»“æ„ å¯ä»¥çœ‹åˆ°åˆ†ä¸ºä»¥ä¸‹3éƒ¨åˆ†ï¼š Headerï¼ˆå¤´éƒ¨ï¼‰Payloadï¼ˆè´Ÿè½½ï¼‰Signatureï¼ˆç­¾åï¼‰ Header å¤´éƒ¨1234&#123; &quot;alg&quot;: &quot;PS384&quot;, &quot;typ&quot;: &quot;JWT&quot;&#125; ä»¥ä¸Šåˆ†åˆ«ä»£è¡¨ &quot;typ&quot; è¡¨ç¤ºè¿™ä¸ªä»¤ç‰Œï¼ˆtokenï¼‰çš„ç±»å‹ï¼ˆtypeï¼‰ &quot;alg&quot; è¡¨ç¤ºè¯¥tokençš„ç®—æ³•ç±»å‹ï¼Œé»˜è®¤ä¸ºHMAC SHA256ï¼ˆå†™æˆ HS256ï¼‰ Payload è´Ÿè½½ä»¥ä¸‹ä¸ºå®˜æ–¹è§„å®šçš„å¯é€‰å­—æ®µï¼š iss (issuer)ï¼šç­¾å‘äººexp (expiration time)ï¼šè¿‡æœŸæ—¶é—´sub (subject)ï¼šä¸»é¢˜aud (audience)ï¼šå—ä¼—nbf (Not Before)ï¼šç”Ÿæ•ˆæ—¶é—´iat (Issued At)ï¼šç­¾å‘æ—¶é—´jti (JWT ID)ï¼šç¼–å· æ³¨æ„ï¼Œè¿™éƒ¨åˆ†æ˜¯ä¸åŠ å¯†çš„ï¼Œæ˜¯ç®€å•çš„Base64è½¬ç è¿‡ç¨‹ï¼Œæ‰€ä»¥å¯†æ–‡ä¿¡æ¯ä¸èƒ½æ”¾åœ¨è¿™éƒ¨åˆ†ï¼Œé™¤éä½ çš„æ–‡å­—æœ¬èº«åŠ å¯†è¿‡ Signature ç­¾åè¿™éƒ¨åˆ†æ˜¯å¯¹å‰ä¸¤éƒ¨åˆ†çš„ç­¾åï¼Œé˜²æ­¢æ•°æ®ç¯¡æ”¹ã€‚ éœ€æŒ‡å®šä¸€ä¸ªå¯†é’¥ï¼ˆsecretï¼‰ã€‚è¿™ä¸ªå¯†é’¥åªæœ‰æœåŠ¡å™¨æ‰çŸ¥é“ï¼Œä¸èƒ½æ³„éœ²ç»™ç”¨æˆ·ã€‚ç„¶åï¼Œä½¿ç”¨ Header é‡Œé¢æŒ‡å®šçš„ç­¾åç®—æ³•ï¼ˆé»˜è®¤æ˜¯ HMAC SHA256ï¼‰ï¼ŒæŒ‰ç…§ä¸‹é¢çš„å…¬å¼äº§ç”Ÿç­¾åã€‚ 1HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), secret) ç®—å‡ºç­¾åä»¥åï¼ŒæŠŠ Headerã€Payloadã€Signature ä¸‰ä¸ªéƒ¨åˆ†æ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨â€ç‚¹â€ï¼ˆ.ï¼‰åˆ†éš”ï¼Œå°±å¯ä»¥è¿”å›ç»™ç”¨æˆ·ã€‚ Header å’Œ Payload ä¸²å‹åŒ–çš„ç®—æ³•æ˜¯ Base64URLã€‚è¿™ä¸ªç®—æ³•è·Ÿ Base64 ç®—æ³•åŸºæœ¬ç±»ä¼¼ï¼Œä½†æœ‰ä¸€äº›å°çš„ä¸åŒã€‚ JWT ä½œä¸ºä¸€ä¸ªä»¤ç‰Œï¼ˆtokenï¼‰ï¼Œæœ‰äº›åœºåˆå¯èƒ½ä¼šæ”¾åˆ° URLï¼ˆæ¯”å¦‚ api.example.com/?token=xxxï¼‰ã€‚Base64 æœ‰ä¸‰ä¸ªå­—ç¬¦+ã€/å’Œ=ï¼Œåœ¨ URL é‡Œé¢æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œæ‰€ä»¥è¦è¢«æ›¿æ¢æ‰ï¼š=è¢«çœç•¥ã€+æ›¿æ¢æˆ-ï¼Œ/æ›¿æ¢æˆ_ ã€‚è¿™å°±æ˜¯ Base64URL ç®—æ³•ã€‚ 3. JWTä½¿ç”¨æ–¹æ³•ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ JWTï¼Œå¯ä»¥å‚¨å­˜åœ¨ Cookie é‡Œé¢ï¼Œä¹Ÿå¯ä»¥å‚¨å­˜åœ¨ localStorageã€‚ æ­¤åï¼Œå®¢æˆ·ç«¯æ¯æ¬¡ä¸æœåŠ¡å™¨é€šä¿¡ï¼Œéƒ½è¦å¸¦ä¸Šè¿™ä¸ª JWTã€‚ä½ å¯ä»¥æŠŠå®ƒæ”¾åœ¨ Cookie é‡Œé¢è‡ªåŠ¨å‘é€ï¼Œä½†æ˜¯è¿™æ ·ä¸èƒ½è·¨åŸŸï¼Œæ‰€ä»¥æ›´å¥½çš„åšæ³•æ˜¯æ”¾åœ¨ HTTP è¯·æ±‚çš„å¤´ä¿¡æ¯Authorizationå­—æ®µé‡Œé¢ã€‚ 1Authorization: Bearer &lt;token&gt; å¦ä¸€ç§åšæ³•æ˜¯ï¼Œè·¨åŸŸçš„æ—¶å€™ï¼ŒJWT å°±æ”¾åœ¨ POST è¯·æ±‚çš„æ•°æ®ä½“é‡Œé¢ã€‚ 4. ä½¿ç”¨æ—¶å‡ ä¸ªæ³¨æ„ç‚¹ï¼ˆ1ï¼‰JWT é»˜è®¤æ˜¯ä¸åŠ å¯†ï¼Œä½†ä¹Ÿæ˜¯å¯ä»¥åŠ å¯†çš„ã€‚ç”ŸæˆåŸå§‹ Token ä»¥åï¼Œå¯ä»¥ç”¨å¯†é’¥å†åŠ å¯†ä¸€æ¬¡ã€‚ ï¼ˆ2ï¼‰JWT ä¸åŠ å¯†çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½å°†ç§˜å¯†æ•°æ®å†™å…¥ JWTã€‚ ï¼ˆ3ï¼‰JWT ä¸ä»…å¯ä»¥ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯ä»¥ç”¨äºäº¤æ¢ä¿¡æ¯ã€‚æœ‰æ•ˆä½¿ç”¨ JWTï¼Œå¯ä»¥é™ä½æœåŠ¡å™¨æŸ¥è¯¢æ•°æ®åº“çš„æ¬¡æ•°ã€‚ ï¼ˆ4ï¼‰JWT çš„æœ€å¤§ç¼ºç‚¹æ˜¯ï¼Œç”±äºæœåŠ¡å™¨ä¸ä¿å­˜ session çŠ¶æ€ï¼Œå› æ­¤æ— æ³•åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­åºŸæ­¢æŸä¸ª tokenï¼Œæˆ–è€…æ›´æ”¹ token çš„æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ JWT ç­¾å‘äº†ï¼Œåœ¨åˆ°æœŸä¹‹å‰å°±ä¼šå§‹ç»ˆæœ‰æ•ˆï¼Œé™¤éæœåŠ¡å™¨éƒ¨ç½²é¢å¤–çš„é€»è¾‘ã€‚ ï¼ˆ5ï¼‰JWT æœ¬èº«åŒ…å«äº†è®¤è¯ä¿¡æ¯ï¼Œä¸€æ—¦æ³„éœ²ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—è¯¥ä»¤ç‰Œçš„æ‰€æœ‰æƒé™ã€‚ä¸ºå‡å°‘ç›—ç”¨ï¼ŒJWT çš„æœ‰æ•ˆæœŸåº”è¯¥è®¾ç½®å¾—æ¯”è¾ƒçŸ­ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æƒé™ï¼Œä½¿ç”¨æ—¶åº”è¯¥å†æ¬¡å¯¹ç”¨æˆ·è¿›è¡Œè®¤è¯ã€‚ ï¼ˆ6ï¼‰ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT ä¸åº”è¯¥ä½¿ç”¨ HTTP åè®®æ˜ç ä¼ è¾“ï¼Œè¦ä½¿ç”¨ HTTPS åè®®ä¼ è¾“ã€‚ 5. Demo ä»£ç  åŠå®é™…ä½¿ç”¨åœºæ™¯å®Œæ•´ä»£ç å¯ç‚¹å‡»æ ‡é¢˜å¯è§gitä»“åº“ï¼Œä¸‹é¢æŒ‰ç…§æˆ‘ç¼–å†™ä»£ç çš„é¡ºåºé˜è¿°å‡ ä¸ªæ³¨æ„ç‚¹ï¼Œ ä»£ç é‡Œä¸€äº›é…ç½®çš„è§£æ .env æ–‡ä»¶ä¸­çš„ä¸¤ä¸ªtokenç”Ÿæˆå¯ä»¥æŒ‰ç…§ä»¥ä¸‹åŠæ³•ï¼Œåˆ©ç”¨node REPLçš„cryptoæ¨¡å—ç”Ÿæˆï¼š 123456789yuyi@home-pc MINGW64 /e/study/code/2021/jwt-learn (master)$ nodeWelcome to Node.js v14.14.0. Type &quot;.help&quot; for more information.&gt; require(&#x27;crypto&#x27;).randomBytes(64).toString(&#x27;hex&#x27;)&#x27;6dedc49577ebb7c685246241533dc068ee43cba49d01b34d243b6b8924786a69d6637c4335e508343ba4c27a1fec1d2f11ea5eea173bd4af04c0f263a4ee98b5&#x27;&gt; require(&#x27;crypto&#x27;).randomBytes(64).toString(&#x27;hex&#x27;)&#x27;4f3ea9c60d55b2a8a58f559ae76e133353a973708d6575daa10ac4bd28f6314d261a4458703be1333f65eddb29a1b58e21ebe493fede5c198952863f1f97e023&#x27;&gt; å‘é€è¯·æ±‚æ£€æµ‹æ—¶ä¸éœ€è¦å®‰è£…postmanï¼Œåªéœ€åœ¨ vs code ä¸Šå®‰è£…ç¥å™¨ REST Client ï¼Œä¸ä»…å¯ä»¥æµ‹æ™®é€šçš„æ¥å£ï¼Œæœ€æ–°çš„ GraphQL è¯­æ³•ä¹Ÿæ”¯æŒï¼Œå…¶æµ‹è¯•æ–‡ä»¶ä»¥ rest ç»“å°¾ï¼Œå¦‚ request.rest dotenv æ˜¯ä¸ªä¸éœ€è¦ä¾èµ–å°±èƒ½è¯»å–é¡¹ç›®ä¸­ .env æ–‡ä»¶çš„é…åˆ¶çš„åº“ï¼Œåªéœ€åœ¨ æ–‡ä»¶å¼€å§‹å¼•ç”¨å³å¯ï¼Œå¦‚ï¼š 12345678910111213// dotenvåº“å¼•ç”¨ï¼šrequire(&#x27;dotenv&#x27;).config()...app.post(&#x27;/login&#x27;, (req,res) =&gt; &#123; // ç™»å½•tokené‰´æƒ const username = req.body.username const user = &#123; name: username &#125; const accessToken = jwt.sign(user, process.env.ACCESS_TOKEN_SECRET) res.json(&#123; accessToken &#125;)&#125;) è§£æåŠæµ‹è¯•ä¸»ä»£ç  npm run dev-start æŠŠæœåŠ¡è·‘èµ·åï¼Œç‚¹å‡» request.rest æ–‡ä»¶çš„è¿™é‡Œä¸‹é¢çš„ä½ç½®ï¼Œè¿™äº›æœ€åŸºç¡€çš„åŠŸèƒ½åœ¨ 01_base åˆ†æ”¯çš„è¿™äº›ä»£ç å°±èƒ½å®ç°ï¼Œæµ‹è¯•æ¥å£è¿”å›çš„æ­£ç¡®ä¸å¦ é‰´æƒéƒ¨åˆ†æŠ½ç¦»ä¸ºå•ç‹¬çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œ02_authenticate_token_modulize åˆ†æ”¯çš„è¿™äº›ä»£ç ï¼Œ 1234567891011function authenticateToken (req, res, next) &#123; const authHeader = req.headers[&#x27;authorization&#x27;] const token = authHeader &amp;&amp; authHeader.split(&#x27; &#x27;)[1] if (token == null) return res.sendStatus(401) jwt.verify(token, process.env.ACCESS_TOKEN_SECRET, (err, user) =&gt; &#123; if (err) return res.sendStatus(403) req.user = user // äº¤ç»™ä¸‹ä¸ªä¸­é—´ä»¶ï¼š next() &#125;)&#125; å°†å…¶æ”¾å…¥app.get(&#39;/posts&#39;)çš„ç¬¬äºŒä¸ªå‚æ•°å³å¯è°ƒç”¨ï¼š 1234// authenticateToken ä¸ºé‰´æƒä¸­é—´ä»¶ï¼šapp.get(&#x27;/posts&#x27;, authenticateToken, (req, res) =&gt; &#123; res.json(posts.filter(post =&gt; post.username === req.user.name))&#125;) å°†é‰´æƒéƒ¨åˆ†ï¼Œå³tokençš„åˆ†å‘ï¼Œæ‹†åˆ†ä¸ºå•ç‹¬ä¸€ä¸ªæ¨¡å—ã€‚é›†ä¸­ç®¡ç†å„ä¸ªè·¯ç”±ï¼ŒåŒ…æ‹¬/login, /logoutçš„tokenï¼Œåœ¨åç«¯å±äºå¾®æœåŠ¡çš„æ¶æ„ å•ç‹¬æŠŠé¢å‘tokenè¿™éƒ¨åˆ†å†…å®¹å°è£…ä¸€ä¸ªå•ç‹¬æ–‡ä»¶ï¼Œæ–°å»ºæ–‡ä»¶ authServer.js åŠæ›´æ–°å‘½ä»¤ auth 123&quot;scripts&quot;: &#123; &quot;auth-start&quot;: &quot;nodemon authServer.js&quot;&#125;, Refresh Token ä¸Šé¢æ˜¯æ­£å¸¸æµç¨‹çš„æ³¨å†Œç™»å½•æ‰€ç”¨çš„tokenï¼Œä½†å®é™…ä¸šåŠ¡ä¸­ï¼ŒAccess Token è®¾ç½®çš„æ—¶é—´ä¸å¯èƒ½å¾ˆé•¿ï¼Œæ¯”å¦‚è¯´10åˆ†é’Ÿï¼Œè€Œ10åˆ†é’Ÿå¯¹äºç”¨æˆ·ä½“éªŒæ¥è¯´è‚¯å®šä¸å¥½ï¼Œä¸€è¿‡æœŸçš„è¯å°±è¦é‡æ–°ç™»å½•ï¼Œæ‰€ä»¥å¤§å¤šæ•°ä¸šåŠ¡é‡‡ç”¨äº†å¦ä¸€ç§æŠ˜ä¸­çš„æ–¹æ¡ˆï¼Œå³å¤šç”Ÿæˆä¸€ä¸ª Refresh Tokenï¼Œè¿™ç§çš„è¿‡æœŸæ—¶é—´æ¯”è¾ƒé•¿ï¼Œä¾‹å¦‚7å¤©å…ç™»å½• å¦‚æœæºå¸¦ Access Token è®¿é—®éœ€è¦è®¤è¯çš„æ¥å£æ—¶é‰´æƒå¤±è´¥ï¼ˆä¾‹å¦‚è¿”å› 401 é”™è¯¯ï¼‰ï¼Œåˆ™å®¢æˆ·ç«¯ä½¿ç”¨ Refresh Token å‘åˆ·æ–°æ¥å£ç”³è¯·æ–°çš„ Access Token å¦‚æœ Refresh Token æ²¡æœ‰è¿‡æœŸï¼ŒæœåŠ¡ç«¯å‘å®¢æˆ·ç«¯ä¸‹å‘æ–°çš„ Access Token å®¢æˆ·ç«¯ä½¿ç”¨æ–°çš„ Access Token è®¿é—®éœ€è¦é‡æ–°è®¤è¯çš„æ¥å£ ä¸‹é¢è§£æ Refresh Token çš„åˆ¶ä½œè¿‡ç¨‹ï¼šauthServer.jsæ–‡ä»¶ä¸­æŠŠç”ŸæˆTokenå°è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œå¹¶åœ¨ app.post(&#39;/login&#39;, (req,res) =&gt; &#123; é‡Œåº”ç”¨ 1234567891011121314app.post(&#x27;/login&#x27;, (req,res) =&gt; &#123; const username = req.body.username const user = &#123; name: username &#125; const accessToken = generateAccessToken(user) const refreshToken = jwt.sign(user, process.env.REFRESH_TOKEN_SECRET) refreshTokens.push(refreshToken) res.json(&#123; accessToken: accessToken, refreshToken: refreshToken &#125;)&#125;)function generateAccessToken(user)&#123; return jwt.sign(user, process.env.ACCESS_TOKEN_SECRET, &#123; expiresIn: &#x27;15s&#x27; &#125;)&#125; å†æ¬¡æµ‹è¯•ï¼Œèƒ½çœ‹åˆ° Refresh Token çš„è¿”å›ç»“æœï¼Œä½†æˆ‘ä»¬å‘ç°ç›´æ¥ç”¨/posts æ¥å£è¯·æ±‚ï¼Œä¼šå‡ºç° Forbidden æŠ¥é”™ï¼š æ­¤æ—¶ï¼Œæˆ‘ä»¬å†å†™å¤šä¸ªå‡½æ•°æ§åˆ¶ token æ›´æ–°ï¼š 12345678910111213// è¿™é‡Œçš„ refreshTokenslet refreshTokens = []app.post(&#x27;/token&#x27;, (req, res) =&gt; &#123; const refreshToken = req.body.token if (refreshToken == null) return res.sendStatus(401) if (!refreshTokens.includes(refreshToken)) return res.sendStatus(403) jwt.verify(refreshToken, process.env.REFRESH_TOKEN_SECRET, (err, user) =&gt; &#123; if (err) return res.sendStatus(403) const accessToken = generateAccessToken(&#123; name: user.name &#125;) res.json(&#123; accessToken &#125;) &#125;)&#125;) request.rest æ–‡ä»¶æ·»åŠ ä¸€ä¸ª /token è¿›è¡Œæµ‹è¯•ï¼Œbodyçš„ &quot;token&quot; æš‚ä¸”ç•™ç©º 1234567###POST http:&#x2F;&#x2F;localhost:3001&#x2F;tokenContent-Type: application&#x2F;json&#123; &quot;token&quot;: &quot;&quot;&#125; è¿›è¡Œä»¥ä¸‹æ“ä½œï¼Œå¯ä»¥çœ‹åˆ°æ•ˆæœï¼š ä½†ä¸Šè¿°çš„ GET /posts æ“ä½œï¼Œå›  function generateAccessToken(user)&#123; å‡½æ•°é‡Œè¿‡æœŸæ—¶é—´åªè®¾ç½®äº† 15ç§’ï¼Œæ‰€ä»¥15ç§’åï¼Œéœ€è¦ POST /token é‡æ–°è·å¾—ä¸€ä¸ª refresh token æ‰èƒ½ç»§ç»­ç»´æŒç™»å½•çŠ¶æ€ ç™»å‡ºæ¨¡å— å®Œæ•´ä»£ç åœ¨è¿™é‡Œ 1234app.delete(&#x27;/logout&#x27;, (req, res)=&gt;&#123; refreshTokens = refreshTokens.filter( token =&gt; token !== req.body.token) res.sendStatus(204)&#125;) ç”¨ delete æ–¹æ³•ï¼Œåˆ é™¤ let refreshTokens = [] é‡ŒåŸæœ¬å­˜åœ¨çš„ refresh tokenï¼Œå†æ¬¡è¯·æ±‚ /posts æ—¶ï¼Œä¼šå‘ç°å·²ç»å˜ä¸º Forbidden çŠ¶æ€","categories":[],"tags":[{"name":"JWT","slug":"JWT","permalink":"https://zyzy.info/tags/JWT/"},{"name":"Token","slug":"Token","permalink":"https://zyzy.info/tags/Token/"}]},{"title":"RenderPropså’Œé«˜é˜¶ç»„ä»¶çš„åå‘ç»§æ‰¿","slug":"ã€2021-06-19ã€‘RenderPropså’Œé«˜é˜¶ç»„ä»¶çš„åå‘ç»§æ‰¿","date":"2021-06-19T01:53:39.000Z","updated":"2021-10-14T03:42:59.913Z","comments":true,"path":"2021/06/19/ã€2021-06-19ã€‘RenderPropså’Œé«˜é˜¶ç»„ä»¶çš„åå‘ç»§æ‰¿/","link":"","permalink":"https://zyzy.info/2021/06/19/%E3%80%902021-06-19%E3%80%91RenderProps%E5%92%8C%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E7%9A%84%E5%8F%8D%E5%90%91%E7%BB%A7%E6%89%BF/","excerpt":"è¿™ä¸¤ç§æ–¹æ³•æ˜¯Reacté‡Œçš„ç®€å•æŠ€æœ¯ï¼Œä½†åœ¨å…·ä½“ä¸šåŠ¡ä¸­å æœ‰ç›¸åº”çš„ä½¿ç”¨åœºæ™¯ï¼Œååˆ†å®ç”¨ï¼Œä¸‹é¢ç®€è¦çš„è¯´æ˜ä¸€ä¸‹","text":"è¿™ä¸¤ç§æ–¹æ³•æ˜¯Reacté‡Œçš„ç®€å•æŠ€æœ¯ï¼Œä½†åœ¨å…·ä½“ä¸šåŠ¡ä¸­å æœ‰ç›¸åº”çš„ä½¿ç”¨åœºæ™¯ï¼Œååˆ†å®ç”¨ï¼Œä¸‹é¢ç®€è¦çš„è¯´æ˜ä¸€ä¸‹ Render Propsè¿™æ˜¯ä¸€ç§ç®€å•çš„æŠ€æœ¯ï¼Œå®˜ç½‘ä¹Ÿæœ‰è§£é‡Šï¼Œç®€å•ç†è§£å°±æ˜¯å°†ä¸€ä¸ªç»„ä»¶é‡Œçš„å±æ€§attributeä½œä¸ºjsxè¯­æ³•çš„å®ç°ã€‚å¦‚ä»¥ä¸‹ä»£ç  1234567891011121314151617181920212223242526272829// çˆ¶ç»„ä»¶export class RenderPropsDemo extends Component &#123; render()&#123; // 1. render ä½œä¸ºç»„ä»¶ &lt;ToggleRenderProps/&gt; çš„å±æ€§ // 3. åå‘åœ¨renderçš„å›è°ƒå‡½æ•°é‡Œè§£æ„å‡ºå­ç»„ä»¶çš„å±æ€§å‡ºæ¥ç”¨ return &lt;ToggleRenderProps render=&#123;(&#123;on, toggle, str&#125;) =&gt; &lt;div&gt; &#123; on &amp;&amp; &lt;h1&gt;Hey zidea&lt;/h1&gt; &#125; &#123; on &amp;&amp; &lt;h2&gt;&#123;str&#125;&lt;/h2&gt; &#125; &lt;button onClick=&#123;toggle&#125;&gt;éšè—/æ˜¾ç¤º&lt;/button&gt; &lt;/div&gt; &#125;/&gt; &#125;&#125;// å­ç»„ä»¶ï¼šclass ToggleRenderProps extends Component &#123; state = &#123; on:false &#125; toggle = () =&gt; this.setState(&#123; on:!this.state.on &#125;) render() &#123; // 2. åœ¨å­ç»„ä»¶è®¾ç½®renderé‡Œé¢çš„å±æ€§ï¼š const &#123; render &#125; = this.props; return render(&#123; str: &#x27;hehe&#x27;, on: this.state.on, toggle: this.toggle, &#125;) &#125;&#125; ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œå­ç»„ä»¶ ToggleRenderProps ä»…è´Ÿè´£å•ä¸€çš„ä¼ å€¼å’Œæ§åˆ¶å€¼å’ŒçŠ¶æ€çš„åŠŸèƒ½ï¼Œç±»ä¼¼å›è°ƒå‡½æ•°ï¼ŒæŠŠè¯¥æ§åˆ¶çš„å€¼å›ä¼ ç»™çˆ¶ç»„ä»¶ RenderPropsDemo å»ä½¿ç”¨ã€‚ å½“ç„¶å±æ€§ render è¿™è¯ä¸æ˜¯å›ºå®šçš„ ä»»ä½•è¢«ç”¨äºå‘ŠçŸ¥ç»„ä»¶éœ€è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹çš„å‡½æ•° prop åœ¨æŠ€æœ¯ä¸Šéƒ½å¯ä»¥è¢«ç§°ä¸º â€œrender propâ€. æ‰€ä»¥ï¼Œä½ å¯ä»¥ç»™å±æ€§å–ä»»æ„åå­—ï¼Œä¾‹å¦‚ data 1234567891011121314151617// çˆ¶ç»„ä»¶export class RenderPropsDemo extends Component &#123; render()&#123; return &lt;ToggleRenderProps data=&#123;(&#123;on, toggle, str&#125;) =&gt; &lt;&gt; ... &lt;/&gt;&#125;/&gt;&#125;&#125;// å­ç»„ä»¶ï¼šclass ToggleRenderProps extends Component &#123; ... render() &#123; return this.props.data(&#123; ... &#125;) &#125;&#125; çˆ¶ç»„ä»¶è¿˜å¯ä»¥å†™ä¸ºå…ƒç´ å†…éƒ¨çš„æ¨¡å¼ï¼Œå¦‚ 123456789export class RenderPropsDemo extends Component &#123; render()&#123; return &lt;ToggleRenderProps&gt; &#123;data=&#123;(&#123;on, toggle, str&#125;) =&gt; &lt;&gt; ... &lt;/&gt;&#125; &lt;/ToggleRenderProps&gt; &#125;&#125; è€Œå­ç»„ä»¶è°ƒç”¨æ—¶ï¼Œå°±æ˜¯å¦ä¸€ç§æ¦‚å¿µäº†ï¼Œå¯åˆ©ç”¨ this.props.children çš„reactè‡ªå¸¦apiè¿›è¡Œå›ä¼  123456789101112class ToggleRenderProps extends Component &#123; state = &#123; on:false &#125; toggle = () =&gt; this.setState(&#123; on:!this.state.on &#125;) render() &#123; return this.props.children(&#123; str: &#x27;hehe&#x27;, on: this.state.on, toggle: this.toggle, &#125;) &#125;&#125; ä»¥ä¸Šä¸¤ç§æƒ…å†µï¼Œä¸€ç§åœ¨å±æ€§ä¸Šå®šä¹‰çš„ï¼Œç±»ä¼¼å…·åå‡½æ•°ï¼Œè€ŒåŒ…è£¹åœ¨å…ƒç´ å†…éƒ¨ï¼Œåˆ©ç”¨ children è¿›è¡Œè°ƒç”¨çš„ï¼Œç±»ä¼¼åŒ¿åå‡½æ•° Rener Propsçš„åº”ç”¨åœºæ™¯å°±å¾ˆå¹¿æ³›äº†ï¼Œå¾ˆå¤šåº“ä¾‹å¦‚è·¯ç”±åº“React Routerï¼Œè¡¨å•æ ¡éªŒformikéƒ½ç”¨äº†è¯¥æ–¹æ³•ã€‚ æ­£å‘ä»£ç†HOCåœ¨è¯´åå‘ä»£ç†ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¯´è¯´æ­£å‘ä»£ç†ï¼Œæ­£å‘ä»£ç†å…¶å®å°±æ˜¯é«˜é˜¶ç»„ä»¶ HOCï¼Œæˆ‘ä»¬çœ‹çœ‹ä¸¤è€…çš„åŒºåˆ«ï¼šæ™®é€šHOCï¼Œå³æ­£å‘ä»£ç†ï¼Œç®€è¨€ä¹‹å°±æ˜¯æŠŠä¸€ä¸ªç»„ä»¶å¤–é¢åŒ…è£¹äº†ä¸€å±‚æ–°çš„ç»„ä»¶ï¼Œä½¿å…¶æˆä¸ºä¸€ä¸ªæ–°ç»„ä»¶å…³äºReactçš„HOCå’Œåå‘ä»£ç†ä¹Ÿå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  123456789101112131415161718192021222324// çˆ¶ç»„ä»¶class AAA extends React.Component &#123; constructor(props) &#123; super(props) this.state = &#123; num: 111 &#125; &#125; render() &#123; return &lt;div num=&#123;this.state.num&#125;&gt;çˆ¶ç»„ä»¶AAAï¼š&#123; this.state.num &#125;&lt;/div&gt; &#125;&#125;// å­ç»„ä»¶// æ™®é€šHOCï¼ŒAAA =&gt; props è¿™éƒ¨åˆ†ï¼Œä»£è¡¨äº† class AAAåŠå…¶é‡Œé¢çš„propså±æ€§// ç›¸å½“äºæŠŠåŸæ¥çš„ AAA æé«˜äº†ä¸€å±‚çŠ¶æ€å˜æˆäº† HOCconst HOC = function (AAA) &#123; return class extends React.Component &#123; render () &#123; return &lt;div style=&#123;&#123;border: &#x27;solid 1px black&#x27;&#125;&#125;&gt; &lt;AAA &#123;...this.props&#125;/&gt; &lt;/div&gt; &#125; &#125;&#125; å­ç»„ä»¶ä¹Ÿå¯æ”¹å†™ä¸ºå‡½æ•°å¼å†™æ³•ï¼š12345678// å­ç»„ä»¶const HOC = AAA =&gt; props =&gt; &#123; return &lt;div style=&#123;&#123;border: &#x27;solid 1px black&#x27;&#125;&#125;&gt; &lt;AAA &#123;...props&#125;/&gt; &lt;/div&gt;&#125;export const Foo = HOC(AAA) å­ç»„ä»¶æ”¹ä¸ºè£…é¥°å™¨å†™æ³•ï¼Œå¯ä»¥çœç•¥ä¸€æ­¥å‘½åçš„æ“ä½œï¼Œä½†å®é™…é¡¹ç›®ä¸­è¿˜éœ€è¦åœ¨babelä¸­å•ç‹¬å¦è¡Œé…åˆ¶è£…é¥°å™¨è¯­æ³•12345678910@InheritanceInversionHOCexport const HOC = function (AAA) &#123; return class extends React.Component &#123; render () &#123; return &lt;div style=&#123;&#123;border: &#x27;solid 1px black&#x27;&#125;&#125;&gt; &lt;AAA &#123;...this.props&#125;/&gt; &lt;/div&gt; &#125; &#125;&#125; åå‘ä»£ç† Inheritance Inversion HOCç›¸å¯¹äºæ­£å‘ä»£ç†ï¼Œåˆ™æ˜¯ç»§æ‰¿ç»„ä»¶è‡ªå·±æœ¬èº«è¿›è¡Œé‡å†™å°†ä¸Šé¢çš„å­ç»„ä»¶è¿›è¡Œé‡å†™ 1234567891011121314151617181920212223242526272829303132333435363738394041// çˆ¶ç»„ä»¶ï¼Œå³åŸæ¥çš„ç»„ä»¶class AAA extends React.Component &#123; constructor(props) &#123; super(props) this.state = &#123; num: 111 &#125; &#125; componentDidMount() &#123; console.log(&quot;child component Did Mount&quot;) &#125; clickComponent = () =&gt; console.log(&#x27;clickComponent func&#x27;) render() &#123; return &lt;div num=&#123;this.state.num&#125;&gt;çˆ¶ç»„ä»¶AAAï¼š&#123; this.state.num &#125;&lt;/div&gt; &#125;&#125;// å­ç»„ä»¶ï¼Œå³åå‘ç»§æ‰¿åçš„ç»„ä»¶const IIHOC = AAA =&gt; class extends AAA &#123; constructor(props) &#123; super(props) this.state = &#123; num: 222 &#125; &#125; componentDidMount() &#123; console.log(&#x27;IIHOC componentDidMount&#x27;) this.clickComponent() // ç›´æ¥è°ƒç”¨ this.clickComponent() å³å¯ï¼Œæ— éœ€é€šè¿‡propsè¿›è¡Œä¼ å‚ &#125; render()&#123; return &lt;div&gt; &lt;button onClick=&#123;this.clickComponent&#125;&gt;IIHocç‚¹å‡»è§æ§åˆ¶å°ï¼ŒAAAç»„ä»¶çš„å‡½æ•°clickComponentåœ¨æ§åˆ¶å°æ‰§è¡Œäº†&lt;/button&gt; &#123;/* ä¸‹é¢çš„&lt;AAA /&gt;ä¼šæ˜¾ç¤ºçˆ¶ç»„ä»¶çš„numå€¼ï¼Œ 111 */&#125; &lt;div&gt;&lt;AAA /&gt;&lt;/div&gt; &#123;/* ä¸‹é¢çš„ &#123;super.render()&#125; ä¸ºæ¸²æŸ“åŠ«æŒï¼Œ ä¼šæ˜¾ç¤ºæœ¬ç»„ä»¶é‡Œçš„å€¼ï¼Œ222 */&#125; &lt;h1&gt;&#123;super.render()&#125;&lt;/h1&gt; &lt;/div&gt; &#125;&#125;export const InheritanceInversionHOC = IIHOC(AAA) åå‘ä»£ç†çš„è§£æåŠå®é™…ä½œç”¨ const IIHOC = AAA =&gt; class extends AAA &#123; ä¸­ï¼Œextends AAAæ˜¯ç»§æ‰¿è‡ªå·± AAA =&gt;æœ¬èº« å½“ç„¶ï¼ŒAAA =&gt; çš„åå­—AAAæ˜¯å¯ä»¥ä»»æ„æ›¿æ¢çš„ï¼Œå¦‚Comp ç”Ÿå‘½å‘¨æœŸå‡½æ•° componentDidMount() &#123; &#125;ï¼Œå› ä¸ºæ˜¯ç»§æ‰¿äºè‡ªèº«ï¼Œæ‰€ä»¥æ— è®ºçˆ¶å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°å‡ä¼šæ‰§è¡Œ å­ç»„ä»¶é‡Œä½¿ç”¨çˆ¶ç»„ä»¶çš„this.clickComponent()ï¼Œç›´æ¥ä½¿ç”¨å³å¯ï¼Œæ— éœ€é€šè¿‡ props è¿›è¡Œä¼ å‚ åå‘ä»£ç†è¿™ç§åšæ³•ä¹ä¸€çœ‹å¥½åƒæ²¡æœ‰å…·ä½“ç”¨é€”ï¼Œä½†å®é™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬å¯ç”¨æ¥åšä¸€ä¸ªåŸæ¥çš„å¤æ‚é¡µé¢çš„å¤šäººåŒæ—¶å¼€å‘ï¼Œåœ¨ä¸€äº›åœ¨åŸæœ‰ä»£ç åŸºç¡€ä¸Šå¼€å‘ï¼Œä¸èƒ½æ”¹å˜åŸæ¥æ—§çš„ä»£ç ï¼Œåˆ™å¯ç”¨åå‘ç»§æ‰¿å®ç°äºŒæ¬¡æ¸²æŸ“è¿›è¡Œå¼€å‘ï¼Œèƒ½ä½¿æ–°çš„åŠŸèƒ½ç‹¬ç«‹æˆä¸€ä¸ªæ¨¡å—ï¼Œæ–¹ä¾¿ç»´æŠ¤","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://zyzy.info/tags/React/"},{"name":"HOC","slug":"HOC","permalink":"https://zyzy.info/tags/HOC/"}]},{"title":"Electroné…ç½®Reactæˆ–Vueå®è·µï¼ˆVueéƒ¨åˆ†å¾…æ›´æ–°ï¼‰","slug":"ã€2021-06-08ã€‘Electroné…ç½®Reactæˆ–Vueå®è·µ","date":"2021-06-08T01:28:59.000Z","updated":"2021-10-14T03:42:59.912Z","comments":true,"path":"2021/06/08/ã€2021-06-08ã€‘Electroné…ç½®Reactæˆ–Vueå®è·µ/","link":"","permalink":"https://zyzy.info/2021/06/08/%E3%80%902021-06-08%E3%80%91Electron%E9%85%8D%E7%BD%AEReact%E6%88%96Vue%E5%AE%9E%E8%B7%B5/","excerpt":"æœ¬ç¯‡ä»‹ç»åœ¨ Electron ä¸­é…ç½® React æˆ–è€… Vue æ¡†æ¶å¼€å‘ï¼Œæ¯•ç«Ÿç°åœ¨å‰ç«¯å¤šæ˜¯ç”¨æ¡†æ¶å¼€å‘ï¼Œå…¶å®å·²æ—©æœ‰ç°æˆçš„æ¨¡æ¿é…ç½®ï¼Œè‡ªå·±åŠ¨æ‰‹ç”¨ Webpack æ¥æ­å»ºèƒ½æ›´å¥½çš„ç†Ÿæ‚‰é…ç½®çš„è¿‡ç¨‹ã€‚","text":"æœ¬ç¯‡ä»‹ç»åœ¨ Electron ä¸­é…ç½® React æˆ–è€… Vue æ¡†æ¶å¼€å‘ï¼Œæ¯•ç«Ÿç°åœ¨å‰ç«¯å¤šæ˜¯ç”¨æ¡†æ¶å¼€å‘ï¼Œå…¶å®å·²æ—©æœ‰ç°æˆçš„æ¨¡æ¿é…ç½®ï¼Œè‡ªå·±åŠ¨æ‰‹ç”¨ Webpack æ¥æ­å»ºèƒ½æ›´å¥½çš„ç†Ÿæ‚‰é…ç½®çš„è¿‡ç¨‹ã€‚ Electron åŸºç¡€é…ç½®12mkdir &lt;project name&gt; &amp;&amp; cd &lt;project name&gt;npm init -y &amp;&amp; npm install electron@11.1.1 å›½å†…ç›´æ¥å®‰è£… electron ä¼šæ¯”è¾ƒæ…¢ï¼Œå¯ä»¥é…ç½®æ·˜å®æºå®‰è£…ï¼Œç›´æ¥è¾“å…¥ï¼š 1npm set registry http://registry.npm.taobao.org ä½†ä¸‹è½½å®Œæˆåè®°å¾—æ”¹å›æ¥npmå®˜æ–¹çš„æºï¼Œè¦ä¸ç„¶ä¼šå½±å“è‡ªå·± npm æ¨¡å—çš„å‘å¸ƒï¼š 1npm config set registry https://registry.npmjs.org å¯ç”¨ npm get registry æŸ¥çœ‹æœ¬åœ°æ‰€å±çš„æº é¡¹ç›®åŸºç¡€æ¶æ„package.json ä¿®æ”¹æ”¹å¦‚ä¸‹ï¼š 12345678910111213&#123; &quot;name&quot;: &quot;electron-template&quot;, &quot;version&quot;: &quot;0.0.1&quot;, &quot;description&quot;: &quot;Electron + React é…ç½®é¡¹ç›®&quot;, &quot;author&quot;: &quot;ä½™ç¿¼&quot;, &quot;main&quot;: &quot;./app/main/electron.js&quot;, &quot;scripts&quot;: &#123; &quot;start:main&quot;: &quot;electron ./app/main/electron.js&quot; &#125;, &quot;dependencies&quot;: &#123; &quot;electron&quot;: &quot;^13.1.1&quot; &#125;&#125; åˆ›å»ºç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 123456electron-template |__app |__main # ä¸»è¿›ç¨‹æ–‡ä»¶å¤¹ï¼Œå³è·‘èµ· Electron çš„è¿›ç¨‹ï¼Œåªæœ‰ä¸€ä¸ªï¼Œ æ§åˆ¶æµè§ˆå™¨çª—å£çš„æ“ä½œç­‰ |__electron.js |__index.html |__renderer # æ¸²æŸ“è¿›ç¨‹æ–‡ä»¶å¤¹ï¼Œå³æ¸²æŸ“é¡µé¢çš„è¿›ç¨‹ï¼Œå‰ç«¯çš„ç•Œé¢çš„jsæ–‡ä»¶,å¯ä»¥æœ‰å¤šä¸ªæ–‡ä»¶ è®©æˆ‘ä»¬ä¿®æ”¹ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶ï¼š ç”¨äºå¯åŠ¨Electronçš„çª—å£ï¼šapp\\main\\electron.js 12345678910111213141516171819const path = require(&#x27;path&#x27;);const &#123; app, BrowserWindow &#125; = require(&#x27;electron&#x27;);const createWindow = () =&gt; &#123; const mainWindow = new BrowserWindow(&#123; width: 1000, height: 600, // é›†æˆnode webPreferences: &#123; nodeIntegration: true, &#125;, &#125;) mainWindow.loadFile(&#x27;index.html&#x27;)&#125;app.whenReady().then(() =&gt; &#123; createWindow() app.on(&#x27;activate&#x27;, () =&gt; if (BrowserWindow.getAllWindows().length === 0) createWindow())&#125;) app\\main\\index.html 123456789101112&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;title&gt;Electron template&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;hello world&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; è¿è¡Œ npm run start:main å¯ä»¥çœ‹åˆ°ç•Œé¢ï¼š React12npm install reactnpm install react-router react-router-dom react-dom é…ç½® babelbabel ç”¨æ¥ç¼–è¯‘es6åŠjsxä»£ç ï¼š 123456789# æ ¸å¿ƒ babel æ’ä»¶ï¼šnpm install -S @babel/polyfillnpm install -D @babel/core @babel/cli# å¤„ç† jsxnpm install -D @babel/preset-env @babel/preset-react @babel/preset-typescript # ç¼©å° @babel/polyfill å¼•å…¥æ—¶çš„çš„åº“ï¼Œè¿›è¡ŒæŒ‰éœ€å¼•å…¥npm install @babel/plugin-transform-runtime --save --dev# å°†ES modulesè½¬æ¢ä¸º CommonJSnpm install @babel/plugin-transform-modules-commonjs --save --dev ç¼–å†™ babel.config.js ï¼Œbabelå®˜ç½‘æ¨èçš„è¿™ç§å†™æ³•æ›¿æ¢ä»¥å‰çš„ .babelrcï¼Œapi.cache(true);æ®å®˜ç½‘çš„è¯´æ³•ï¼Œå¯ç¼“å­˜ä¼ è¿›æ¥çš„apiï¼Œæ•ˆç‡æ›´é«˜ 12345678910111213141516171819202122232425module.exports = function (api) &#123; api.cache(true); const presets = [ &#x27;@babel/preset-env&#x27;, // å…è®¸ä½¿ç”¨æœ€æ–°çš„JSè¯­æ³•ï¼Œè€Œæ— é¡»è€ƒè™‘ç¯å¢ƒçš„å½±å“ &#x27;@babel/preset-react&#x27;, &#x27;@babel/preset-typescript&#x27;, ] const plugins = [ &#x27;@babel/plugin-transform-runtime&#x27;, [ &#x27;@babel/plugin-transform-modules-commonjs&#x27;, &#123; allowTopLevelThis: true, loose: true, lazy: true &#125; ] ] return &#123; presets, plugins &#125;&#125; é…ç½® webpackï¼æ³¨æ„ï¼Œæˆªè‡³åˆ°æˆ‘å†™è¯¥æ–‡ä¸ºæ­¢ï¼Œå®‰è£…æœ€æ–°çš„webpack5å’Œwebpack-cli4ï¼Œå¹¶ä¸å…¼å®¹ï¼Œè¿è¡Œæ—¶ä¼šæŠ¥å¾ˆå¤šè«åå…¶å¦™çš„é”™è¯¯ï¼Œæ‰€ä»¥å¿…é¡»æŒ‡å®šwebpack4å’Œwebpack-cli3çš„ç‰ˆæœ¬ï¼Œå…¶ä»–ç‰ˆæœ¬æˆ‘ä¹Ÿè¯•è¿‡äº†ï¼Œåªæœ‰è¿™ä¸¤ä¸ªç‰ˆæœ¬ç›¸å®¹è¾ƒä¸ºç¨³å®š 1234# åŸºç¡€npm i -D webpack@4 webpack-cli@3# çƒ­æ›´æ–°npm i -D webpack-dev-server æˆ‘ä»¬ä¼šé…ç½®3ä¸ªwebpackæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ webpack.base.js â€“ åŸºç¡€é…ç½® webpack.render.js â€“ ä¸»è¿›ç¨‹é…ç½® webpack.main.js â€“ æ¸²æŸ“è¿›ç¨‹é…ç½® æ‰€ä»¥å®‰è£…è¿™æ¬¾æ’ä»¶ï¼Œç”¨äºå°†ä¸‹é¢ä¸¤ä¸ªä¸ªæ–‡ä»¶å¼•å…¥ webpack.base.js ä¸­ï¼Œå‡å°‘webpacké…ç½®çš„ä»£ç : 1npm i -D webpack-merge å®‰è£…å„ç§loaderï¼Œplugin 123npm i -D html-webpack-plugin@4 # ç”¨äºè¯»å–å…¥å£HTMLæ–‡ä»¶npm i -D clean-webpack-plugin # ä¸»è¿›ç¨‹åªç¼–è¯‘æ¯æ¬¡æ‰“åŒ…å¥½çš„æ–‡ä»¶ï¼Œè¦è¿™ä¸ªæ’ä»¶å¯ä»¥æ¯æ¬¡è‡ªåŠ¨æ¸…é™¤ä¸Šæ¬¡ç•™ä¸‹æ¥çš„æ–‡ä»¶npm i babel-loader é…ç½® cross-env æ’ä»¶ï¼Œç”¨äºæ‰§è¡Œä¸åŒç¯å¢ƒçš„è„šæœ¬ï¼š 1npm i cross-env webpacké…ç½®æ–‡ä»¶webpack.base.js123456789101112131415161718const path = require(&#x27;path&#x27;)const &#123; CleanWebpackPlugin &#125; = require(&#x27;clean-webpack-plugin&#x27;)module.exports = &#123; resolve: &#123; extensions: [&#x27;.js&#x27;, &#x27;.jsx&#x27;, &#x27;.ts&#x27;, &#x27;.tsx&#x27;], alias: &#123; // è·¯å¾„åˆ«åï¼Œå¯å°† import A from &#x27;../../../../../A&#x27;è¿™ç§å¯¼å…¥è·¯å¾„ï¼Œå˜æˆ import A from &#x27;@src/A&#x27; &#x27;@src&#x27;: path.join(__dirname, &#x27;../&#x27;, &#x27;app/renderer&#x27;) &#125; &#125;, module: &#123; rules: [ &#123; test: /\\.(jsx?|tsx?)$/, exclude: /node_modules/, use: &#123; loader: &#x27;babel-loader&#x27;,&#125;&#125;, ] &#125;, plugins: [ new CleanWebpackPlugin(), ],&#125; webpack.main.dev.js123456789101112131415161718192021222324const path = require(&#x27;path&#x27;)const webpack = require(&#x27;webpack&#x27;)const baseConfig = require(&#x27;./webpack.base.js&#x27;)const webpackMerge = require(&#x27;webpack-merge&#x27;)const mainConfig = &#123; entry: path.resolve(__dirname, &#x27;../app/main/electron.js&#x27;), // æ„å»ºå‡ºä¸åŒè¿è¡Œç¯å¢ƒçš„ä»£ç  target: &#x27;electron-main&#x27;, output: &#123; filename: &#x27;electron.js&#x27;, path: path.resolve(__dirname, &#x27;../dist&#x27;), &#125;, devtool: &#x27;inline-source-map&#x27;, mode: &#x27;development&#x27;, plugins: [ // ğŸ‘‡ æ ¹æ®å¯åŠ¨å‘½ä»¤çš„ node_envï¼ŒæŒ‡å®šæ„å»ºå˜é‡ new webpack.DefinePlugin(&#123; &#x27;process.env.NODE_ENV&#x27;: &#x27;&quot;development&quot;&#x27; &#125;) ],&#125;module.exports = webpackMerge.merge(baseConfig, mainConfig) webpack.render.dev.js1234567891011121314151617181920212223242526272829303132333435const path = require(&#x27;path&#x27;)const webpackMerge = require(&#x27;webpack-merge&#x27;)const baseConfig = require(&#x27;./webpack.base.js&#x27;)const HtmlWebPackPlugin = require(&#x27;html-webpack-plugin&#x27;)const devConfig = &#123; mode: &#x27;development&#x27;, entry: &#123; // app.jsx å…¥å£æ–‡ä»¶ index: path.resolve(__dirname, &#x27;../app/renderer/App.jsx&#x27;), &#125;, output: &#123; filename: &#x27;[name].[hash].js&#x27;, path: path.resolve(__dirname, &#x27;../dist&#x27;), &#125;, target: &#x27;electron-renderer&#x27;, devtool: &#x27;inline-source-map&#x27;, devServer: &#123; contentBase: path.join(__dirname, &#x27;../dist&#x27;), compress: true, host: &#x27;127.0.0.1&#x27;, port: 7001, hot: true, &#125;, plugins: [ new HtmlWebPackPlugin(&#123; // ä»¥æ­¤ä¸ºæ¨¡æ¿ï¼Œè‡ªåŠ¨ç”ŸæˆHTML template: path.resolve(__dirname, &#x27;../app/renderer/index.html&#x27;), filename: path.resolve(__dirname, &#x27;../dist/index.html&#x27;), chunks: [&#x27;index&#x27;], &#125;) ]&#125;module.exports = webpackMerge.merge(baseConfig, devConfig) é‡ç»„é¡¹ç›®ç»“æ„ç”±äºreactæ˜¯åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å°†å…¥å£æ–‡ä»¶ index.html ç§»åŠ¨åˆ° .app/render/ æ–‡ä»¶å¤¹ï¼Œ å¹¶åˆ›å»º app.jsxæ–‡ä»¶ä½œä¸ºreactçš„å…¥å£æ–‡ä»¶ 12mv ./app/main/index.html ./app/renderer/touch ./app/renderer/App.jsx index.html æ›´æ”¹å¦‚ä¸‹ï¼š 123456789101112131415&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;title&gt;Electron Platform&lt;/title&gt; &lt;style&gt; * &#123; margin: 0; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; App.jsx 1234567891011121314151617import React from &#x27;react&#x27;import ReactDOM from &#x27;react-dom&#x27;import &#123; HashRouter as Router, Route, Switch &#125; from &#x27;react-router-dom&#x27;function App() &#123; return ( &lt;Router&gt; &lt;Switch&gt; &lt;Route path=&#x27;/&#x27;&gt; &lt;div&gt;å¯è§†åŒ–å¼€å‘å¹³å°&lt;/div&gt; &lt;/Route&gt; &lt;/Switch&gt; &lt;/Router&gt; )&#125;ReactDOM.render(&lt;App/&gt;, document.getElementById(&#x27;root&#x27;)) ä¿®æ”¹electronä¸»çº¿ç¨‹é…ç½®ï¼Œé…åˆreactåšå•é¡µé¢åº”ç”¨æ—¢ç„¶åŸºç¡€æ–‡ä»¶ç»“æ„æ”¹äº†ï¼Œé‚£ä¹ˆ .app/main/electron.js ä¹Ÿå¾—è·Ÿç€å¢åŠ ä»¥ä¸‹é…ç½®ï¼š 12345678910111213141516...const isDev = () =&gt; &#123; // å¯¹åº” webpack.main.dev.jsé‡Œçš„ webpack.DefinePluginçš„å®šä¹‰ return process.env.NODE_ENV === &#x27;development&#x27;;&#125;...const createWindow = () =&gt; &#123; ... // åˆ©ç”¨ if (isDev()) &#123; mainWindow.loadURL(&#x27;http://127.0.0.1:7001&#x27;) &#125; else &#123; mainWindow.loadURL(`file://$&#123;path.join(__dirname, &#x27;./dist/index.html&#x27;)&#125;`) &#125;&#125; package.json çš„ script ä¿®æ”¹å¦‚ä¸‹ 1234&quot;scripts&quot;: &#123; &quot;start:main&quot;: &quot;cross-env NODE_ENV=development webpack --config ./webpack.main.dev.js &amp;&amp; electron ./dist/electron.js&quot;, &quot;start:render&quot;: &quot;webpack-dev-server --config ./webpack.renderer.dev.js&quot;&#125;, æŠ¥é”™å¤„ç† å¦‚æœå‡ºç°æŠ¥é”™ï¼šUncaught ReferenceError: require is not definedï¼Œè¯·æ£€æŸ¥ä½ æ˜¯å¦åœ¨ä¸»è¿›ç¨‹ä¸­æ·»åŠ è¿™è¡Œä»£ç ï¼Œå¦‚æœæ·»åŠ äº†ï¼Œè¯·ç¡®ä¿ä½ æ­å»ºé¡¹ç›®çš„ Electron ä¸æœ¬åº”ç”¨çš„ç‰ˆæœ¬ä¸€è‡´(å½“å‰é¡¹ç›®çš„ Electron@^11.1.1) è¯·è‡ªæ£€æŸ¥ä¸€ä¸‹ä½ çš„ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®ï¼Œè¿›å…¥ node_modulesï¼Œæ‰¾åˆ° electronï¼Œçœ‹çœ‹ package.json ä¸­çš„ version æ˜¯å¦æ˜¯ 11.1.1ã€‚ Vueç°æˆæ¨¡æ¿ï¼šelectron-react-boilerplate å’Œ electron-vueVue æˆ– React å‡æœ‰ä¸€ä¸ªç°æˆçš„æ¨¡æ¿å¯ç”¨ï¼Œè¿™ä¸¤ä¸ªè¯¥æ¨¡æ¿å…±åŒå¥½å¤„æ˜¯ï¼Œåªéœ€è¦ä¸€ä¸ªç»ˆç«¯ï¼Œä¾¿å¯è·‘èµ·ELectronçš„ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹ï¼Œé›†æˆåº¦æ›´é«˜ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªæ¨¡æ¿çš„é…ç½®ã€‚ electron-react-boilerplate ä¸¤ä¸ªç»ˆç«¯é›†æˆåŸç†electron-react-boilerplate é›†æˆä¸¤ä¸ªç»ˆç«¯æ˜¯ä½¿ç”¨äº†webpackçš„ä¸€ä¸ªapi webpack deverserve before apiï¼Œåœ¨å…¶æºç æ–‡ä»¶webpack.config.renderer.dev.babel.jsé‡Œå¯ä»¥çœ‹åˆ°é…ç½® 12345678910111213141516import &#123; spawn, execSync &#125; from &#x27;child_process&#x27;export default merge(baseConfig, &#123; ... before() &#123; console.log(&#x27;Starting Main Process...&#x27;); // åˆ©ç”¨nodeçš„ spawn api è·‘ä¸€ä¸ª start:main çš„å­è¿›ç¨‹ spawn(&#x27;npm&#x27;, [&#x27;run&#x27;, &#x27;start:main&#x27;], &#123; shell: true, env: process.env, stdio: &#x27;inherit&#x27;, &#125;) .on(&#x27;close&#x27;, (code) =&gt; process.exit(code)) .on(&#x27;error&#x27;, (spawnError) =&gt; console.error(spawnError)); &#125;,&#125; å…¶å®å¾ˆç®€å•ï¼Œåˆ©ç”¨äº†nodeçš„child_process api æ–°å¼€äº†ä¸ªè¿›ç¨‹ï¼Œè®©æ¸²æŸ“è¿›ç¨‹è·‘åœ¨è¯¥è¿›ç¨‹ä¹‹ä¸Š webpack.devserver.before api ç±»ä¼¼äº webpack çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè¿˜æœ‰ä¸€ä¸ª webpack.devserver.after electron-vue ä¸¤ä¸ªç»ˆç«¯é›†æˆåŸç†electron-vue æ˜¯å› ä¸ºè¿™ä¸ªçš„è„šæœ¬dev-runner.jsï¼Œåˆ©ç”¨ Promise.all()ï¼Œå‡½æ•°è¿›è¡Œè°ƒç”¨ï¼ŒæŠŠä¸¤ä¸ªç»ˆç«¯æ“ä½œèåˆåˆ°ä¸€èµ·ï¼š 12345678910111213141516...function init () &#123; greeting() // startRender() åˆ©ç”¨ Promise.all([startRenderer(), startMain()]) .then(() =&gt; &#123; startElectron() &#125;) .catch(err =&gt; &#123; console.error(err) &#125;)&#125;init()","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://zyzy.info/tags/React/"},{"name":"Webpack","slug":"Webpack","permalink":"https://zyzy.info/tags/Webpack/"},{"name":"Vue","slug":"Vue","permalink":"https://zyzy.info/tags/Vue/"},{"name":"Electron","slug":"Electron","permalink":"https://zyzy.info/tags/Electron/"}]},{"title":"Nginxè‡ªå­¦ç¬”è®°","slug":"ã€2021-05-28ã€‘Nginxè‡ªå­¦ç¬”è®°","date":"2021-05-28T01:36:33.000Z","updated":"2021-10-14T03:42:59.912Z","comments":true,"path":"2021/05/28/ã€2021-05-28ã€‘Nginxè‡ªå­¦ç¬”è®°/","link":"","permalink":"https://zyzy.info/2021/05/28/%E3%80%902021-05-28%E3%80%91Nginx%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0/","excerpt":"Ngixè¿™å‡ å¹´å¤ªç«äº†ï¼Œåœ¨ä¸ä¹…çš„å°†æ¥ä¼šè¶…è¿‡Apacheï¼Œç”±äºä»–çš„åº•å±‚ç”¨epollï¼Œç°åœ¨å¤šç”¨äºæœåŠ¡å™¨ç«¯çš„åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ ï¼Œå¼ºå¤§çš„å¹¶å‘æ€§èƒ½ä½¿å…¶åŸºæœ¬ä¸Šæ²¡æœ‰é¡¹ç›®ä¸ç”¨ä»–ã€‚æœ¬ç¯‡æŠŠ Ngix çš„åŸºç¡€é…ç½®æ’¸äº†ä¸€éï¼Œè®°ä¸‹æ¥ä»¥å…ä»¥åå¿˜äº†ã€‚","text":"Ngixè¿™å‡ å¹´å¤ªç«äº†ï¼Œåœ¨ä¸ä¹…çš„å°†æ¥ä¼šè¶…è¿‡Apacheï¼Œç”±äºä»–çš„åº•å±‚ç”¨epollï¼Œç°åœ¨å¤šç”¨äºæœåŠ¡å™¨ç«¯çš„åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡ ï¼Œå¼ºå¤§çš„å¹¶å‘æ€§èƒ½ä½¿å…¶åŸºæœ¬ä¸Šæ²¡æœ‰é¡¹ç›®ä¸ç”¨ä»–ã€‚æœ¬ç¯‡æŠŠ Ngix çš„åŸºç¡€é…ç½®æ’¸äº†ä¸€éï¼Œè®°ä¸‹æ¥ä»¥å…ä»¥åå¿˜äº†ã€‚ å®‰è£…å¯æŸ¥çœ‹Nginxå®˜ç½‘ è¿æ¥è¿œç¨‹æœåŠ¡å™¨1ssh root@8.134.120.206 è¾“å…¥å¯†ç åè§åˆ°ç™»å½•äº† å®‰è£…äº›å¿…è¦çš„å·¥å…·12yum -y install gcc gcc-c++ autoconf pcre-devel make automakeyum -y install wget httpd-tools vim è¿”å›å®¶ç›®åˆ›å»ºNginxä¸»è¦æ–‡ä»¶å¤¹123cd ~mkdir nginx-learn &amp;&amp; cd nginx-learnmkdir app backup download logs work app: æ”¾ç¨‹åºæºç backup: å¤‡ä»½æ–‡ä»¶download: ä¸‹è½½æ–‡ä»¶å¤¹logs: æ—¥å¿—work: æ”¾ä¸€äº›é¡¹ç›®æ–‡æ¡£ å®‰è£…æœ€æ–°ç‰ˆNginxéœ€æŸ¥çœ‹Nginxçš„yumæºçš„ç‰ˆæœ¬ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1yum list | grep nginx yum æºçš„æ›´æ–°é…ç½®ï¼Œå¤åˆ¶Nginxå®˜ç½‘è¿™é‡Œçš„é…ç½®ï¼Œæˆ‘æŠŠä»–ç²˜å‡ºæ¥ 123456789101112131415[nginx-stable]name=nginx stable repobaseurl=http://nginx.org/packages/centos/$releasever/$basearch/gpgcheck=1enabled=1gpgkey=https://nginx.org/keys/nginx_signing.keymodule_hotfixes=true[nginx-mainline]name=nginx mainline repobaseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/gpgcheck=1enabled=0gpgkey=https://nginx.org/keys/nginx_signing.keymodule_hotfixes=true 1vim /etc/yum.repos.d/nginx.repo å…¶ä¸­ baseurl=http://nginx.org/packages/centos/$releasever/$basearch/ çš„ $releasever æˆ‘ç”¨çš„æ˜¯centOS 7çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥æ”¹æˆ7ï¼Œå¦‚ä¸‹ï¼š è¿™æ¬¡å†å®‰è£…nginx 1234yum install nginxnginx -v# ornginx -V å¯ä»¥å‘ç°æ›´æ–°åˆ°æœ€æ–°çš„nginxç‰ˆæœ¬ æŸ¥çœ‹æ‰€æœ‰ nginx ç›®å½•åŠé…ç½®æ–‡ä»¶çš„å‘½ä»¤ï¼š 1rpm -ql nginx Nginxé…ç½®é¡¹è¯¦è§£é…ç½®é¡¹ï¼šå¤§éƒ¨åˆ†å·¥ä½œåœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶æ‰§è¡Œä¿®æ”¹ï¼š/etc/nginx/nginx.confcd /etc/nginxcat nginx.conf ä¸‹é¢è§£é‡Šä¸€ä¸‹å„é…ç½®çš„ä½œç”¨ï¼š 123456789101112131415161718192021222324252627282930313233343536373839user nginx; # é»˜è®¤ç”¨æˆ·worker_processes auto; # è¿›ç¨‹æ•°ï¼Œå³cpuæ•°error_log /var/log/nginx/error.log notice; # é”™è¯¯æ—¥å¿—pid /var/run/nginx.pid; # è¿›ç¨‹events &#123; worker_connections 1024; # å…è®¸æœ€å¤§è¿æ¥æ•°&#125;http &#123; include /etc/nginx/mime.types; # æ–‡ä»¶æ‰©å±•åçš„æ˜ å°„è¡¨ default_type application/octet-stream; # # è®¾ç½®æ—¥å¿—æ ¼å¼ï¼š log_format main &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27; &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27; &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;; # è®¿é—®æ—¥å¿—å­˜æ”¾ä½ç½® access_log /var/log/nginx/access.log main; # å¼€å¯é»˜è®¤ä¼ è¾“æ¨¡å¼ sendfile on; # å‡å°‘ç½‘ç»œæŠ¥æ–‡æ•°é‡ #tcp_nopush on; # è¶…æ—¶æ—¶é—´ keepalive_timeout 65; # å¼€å¯å‹ç¼© #gzip on; # å­é…ç½®é¡¹ include /etc/nginx/conf.d/*.conf;&#125; 12cd conf.d/vim default.conf 12345678910111213141516171819202122232425262728293031323334353637383940414243server &#123; listen 80; # ç›‘å¬ç«¯å£å· server_name localhost; #access_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;host.access.log main; location &#x2F; &#123; root &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html; index index.html index.htm; &#125; #error_page 404 &#x2F;404.html; # redirect server error pages to the static page &#x2F;50x.html # error_page 500 502 503 504 &#x2F;50x.html; location &#x3D; &#x2F;50x.html &#123; root &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html; &#125; # proxy the PHP scripts to Apache listening on 127.0.0.1:80 # #location ~ \\.php$ &#123; # proxy_pass http:&#x2F;&#x2F;127.0.0.1; #&#125; # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # #location ~ \\.php$ &#123; # root html; # fastcgi_pass 127.0.0.1:9000; # fastcgi_index index.php; # fastcgi_param SCRIPT_FILENAME &#x2F;scripts$fastcgi_script_name; # include fastcgi_params; #&#125; # deny access to .htaccess files, if Apache&#39;s document root # concurs with nginx&#39;s one # #location ~ &#x2F;\\.ht &#123; # deny all; #&#125;&#125; ç½‘ç«™æ ¹ç›®å½•æˆ‘ä»¬æ”¹åŠ¨ä¸€ç‚¹æ ¹ç›®å½•çš„å†…å®¹ï¼š 1vim /usr/share/nginx/html/index.html è¿è¡ŒNginxå¼€å¯1nginx å…³é—­123456# æ­£å¸¸å…³åœnginx -s quit# å‡ ç§å¼ºåˆ¶å…³åœnginx -s stopkillall nginx é‡è½½æ¯æ¬¡æ”¹å®Œé…ç½®æ–‡ä»¶åï¼Œéœ€è¦é‡è½½nginxï¼Œè¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š 1nginx -s reload Linuxé€šç”¨å‘½ä»¤æ‰§è¡Œå¼€å¯ï¼Œå…³é—­å’Œé‡è½½å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨Linuxçš„é€šç”¨å‘½ä»¤è¿›è¡Œå…³åœæˆ–é‡å¯ï¼š 12345678# æˆ– Linuxé€šç”¨å‘½ä»¤ï¼šsystemctl start nginx.service# Linuxé€šç”¨å‘½ä»¤å…³åœï¼šsystemctl stop nginx.service# é‡å¯ï¼šsystemctl restart nginx.service æŸ¥çœ‹è¿›ç¨‹é€šè¿‡æŸ¥çœ‹nginxæ‰€æœ‰è¿›ç¨‹ç¡®è®¤å…¶å·²ç»è¿è¡Œï¼š 1ps aux | grep nginx æŸ¥çœ‹æ‰€æœ‰å¼€å¯çš„ç«¯å£å·1netstat -tlnp é…ç½®ä¸€ä¸ª404é¡µé¢ï¼Œä¿®æ”¹ä¸€ä¸ªé…ç½®å¦‚ä¸‹ï¼š 1vim /etc/nginx/conf.d/default.conf å¢åŠ ä¸€è¡Œï¼Œæ”¹æˆè¿™æ ·ï¼š åšä¸€ä¸ª404é¡µé¢ï¼š 1vim /usr/share/nginx/html/404_error.html å†™å®Œé¡µé¢åï¼Œåœ°å€æ éšä¾¿è¾“å…¥ä¸€åœ°å€ä¼šå‘ç°å‡ºç°äº†404é¡µé¢ï¼š ä¹Ÿå¯ä»¥é‡å®šå‘åˆ°å…¶ä»–é¡µé¢ï¼Œå¦‚ï¼š 1vim /etc/nginx/conf.d/default.conf æƒé™æ§åˆ¶ç¦æ­¢æŸäº›ipä¸èƒ½è®¿é—®1vim /etc/nginx/conf.d/default.conf åœ¨default.confåŠ ä¸Š deny 113.65.137.13; ï¼Œå¦‚ä¸‹ï¼Œç¦æ­¢äº†æˆ‘æœ¬æœºä¸å¯ä»¥è®¿é—® å¦‚æœè¦ç¦æ­¢æŸä¸€ç½‘æ®µçš„IPä¸èƒ½è®¿é—®ï¼Œåˆ™å†™ï¼šdeny 113.65.137.13/200; ï¼Œè¡¨ç¤º 13 åˆ° 200 çš„æ‰€æœ‰IPå·éƒ½ä¸èƒ½è®¿é—® allow å…è®¸å“ªäº›IPå¯ä»¥è®¿é—® æ³¨æ„ï¼ï¼ï¼default.conf æ–‡ä»¶æ˜¯ä»ä¸Šå¾€ä¸‹æ‰§è¡Œï¼Œå¦‚ deny all; å†™åœ¨ allow 113.65.137.13;ä¹‹å‰ï¼Œé‚£ä¹ˆ113.65.137.13ä»ä¸èƒ½è®¿é—® å†æ¬¡åœ¨é¡µé¢æ‰“å¼€ï¼Œå°±ä¼šå‘ç°ä¸èƒ½è®¿é—®é¡µé¢ï¼Œå‡ºç°403é¡µé¢ï¼š ç²¾ç¡®åŒ¹é…è·¯å¾„è®¿é—®æƒé™ åœ¨ location é…ç½®æŸäº›è·¯å¾„å…è®¸å“ªäº›IP è¿›è¡Œè®¿é—®ï¼Œæ·»åŠ å¦‚ä¸‹ï¼š éƒ½æ˜¯æ­£åˆ™åŒ¹é…ï¼Œé™¤äº†è·¯å¾„ï¼Œè¿˜å¯åŒ¹é…ä¸èƒ½è®¿é—®çš„æ–‡ä»¶ï¼Œå¦‚ .php ç»“å°¾çš„æ–‡ä»¶ 123456789location =/img &#123; allow all;&#125;location =/admin &#123; deny all;&#125;location ~\\.php$ &#123; deny all;&#125; è™šæ‹Ÿä¸»æœºé…ç½®è™šæ‹Ÿä¸»æœºçš„å¥½å¤„ï¼Œå¯ä»¥çœé’±ï¼Œä¸€å°ç‰©ç†æœåŠ¡å™¨å¯åˆ’åˆ†å¤šä¸ªç©ºé—´ï¼Œæ¯ä¸ªç‹¬ç«‹ç©ºé—´å¯é…ç½®ç‹¬ç«‹çš„è™šæ‹Ÿä¸»æœºï¼Œå½¼æ­¤ç›¸äº’éš”ç¦»ï¼Œæ¯ä¸ªè™šæ‹Ÿä¸»æœºå¯ä»¥ç‹¬ç«‹é…ç½®webæœåŠ¡ åŸºäºç«¯å£å·é…ç½®è™šæ‹Ÿä¸»æœºåœ¨ /etc/nginx/conf.d/ ä¸‹æ–°å»º 8001.conf æ–‡ä»¶ï¼Œç”¨äºé…ç½® 8001 ç«¯å£çš„è™šæ‹Ÿä¸»æœº 1vim /etc/nginx/conf.d/8001.conf åŸºäºæ”¹è™šæ‹Ÿä¸»æœºé…ç½®ä¸€ä¸ª index.html æ–‡ä»¶ï¼š 1touch /usr/share/nginx/html/html8001/index.html å†™ä¸‹ 1&lt;h1&gt;welcome to port 8001&lt;/h1&gt; æˆ‘è¿™é‡Œç”¨çš„æ˜¯é˜¿é‡Œäº‘åšæ¼”ç¤ºï¼Œæ‰€ä»¥è¿”å›é˜¿é‡Œäº‘ç•Œé¢é…ç½®8001ç«¯å£ï¼š åŸºäºIPé…ç½®è™šæ‹Ÿä¸»æœºåŒæ ·æ˜¯æ”¹å˜ 8001.conf æ–‡ä»¶çš„ localhost é¡¹çš„é…ç½® 1vim /etc/nginx/conf.d/8001.conf å¦‚ï¼š 123456server&#123; listen 80; server_name 192.168.1.200; root /usr/share/nginx/html/html8001; index index.html;&#125; åŸºäºåŸŸåé…ç½®è™šæ‹Ÿä¸»æœºåœ¨é˜¿é‡Œäº‘ä¸Šç”³è¯·åŸŸåï¼Œè¿™é‡Œä¸æ¼”ç¤ºï¼Œç°åœ¨ .top ç»“å°¾çš„åŸŸååœ¨åšä¿ƒé”€ï¼Œèµ·ä¸ªç¨å¾®é•¿ç‚¹çš„åŸŸåæ³¨å†Œåªéœ€9å…ƒå°±èƒ½æ³¨å†Œä¸€å¹´ï¼Œ æˆ‘è¿™é‡Œæ³¨å†Œäº† service-learn.top èŠ±äº†9å…ƒ ç‚¹å‡»åŸŸåè§£æï¼š è¾“å…¥ipåœ°å€ï¼Œç±»å‹é€‰æ‹©Aç±»å‹ï¼š åœ¨nginx é…ç½® 1vim /etc/nginx/conf.d/default.conf å°† server_name localhost; æ”¹ä¸º server_name niginx.service-learn.top; åŒæ ·çš„åŸæ¥çš„åŸºäºç«¯å£çš„è™šæ‹Ÿæœº8001ç«¯å£ä¹Ÿä¿®æ”¹ï¼šå…ˆå»é˜¿é‡Œäº‘é…ç½®è§£æ nginx2.service-learn.top åœ°å€ 1vim /etc/nginx/conf.d/8001.conf å°† server_name localhost; æ”¹ä¸º server_name nginx2.service-learn.top;ï¼Œæ”¹åå¦‚ä¸‹ï¼š 123456server&#123; listen 80; server_name nginx2.service-learn.top; root /usr/share/nginx/html/html8001; index index.html;&#125; åå‘ä»£ç†æ­£å‘ä»£ç†ï¼ˆProxyï¼‰ä¸ºå®¢æˆ·ç«¯åšçš„ä»£ç†æœåŠ¡å™¨ï¼Œæœ€å½¢è±¡çš„è§£é‡Šå°±æ˜¯ï¼Œæˆ‘ä»¬å¹³æ—¶ç”¨vpnç¿»å¢™ä¸Šå¤–ç½‘ï¼Œ åå‘ä»£ç†ï¼ˆReverse Proxy)ä¸ºæœåŠ¡ç«¯åšçš„ä»£ç†æœåŠ¡ï¼Œåå‘ä»£ç†æœ€å¤§çš„å¥½å¤„æ˜¯ å®‰å…¨æ€§ï¼Œä½¿ç”¨åå‘ä»£ç†å®¢æˆ·ç«¯ç”¨æˆ·åªèƒ½é€šè¿‡å¤–æ¥ç½‘æ¥è®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶ä¸”ç”¨æˆ·å¹¶ä¸çŸ¥é“è‡ªå·±è®¿é—®çš„çœŸå®æœåŠ¡å™¨æ˜¯é‚£ä¸€å°ï¼Œå¯ä»¥å¾ˆå¥½çš„æä¾›å®‰å…¨ä¿æŠ¤ã€‚åœ¨é­å—ç½‘ç»œæ”»å‡»æ—¶ï¼Œä¼šè¢«åœç•™åœ¨åå‘ä»£ç†ä¸Šï¼Œæ”»å‡»ä¸åˆ°æˆ‘ä»¬çœŸå®çš„æœåŠ¡å™¨ã€‚ åŠŸèƒ½æ€§ï¼Œåå‘ä»£ç†çš„ä¸»è¦ç”¨é€”æ˜¯ä¸ºå¤šä¸ªæœåŠ¡å™¨æä¾›è´Ÿå€ºå‡è¡¡ã€ç¼“å­˜ç­‰åŠŸèƒ½ã€‚è´Ÿè½½å‡è¡¡å°±æ˜¯ä¸€ä¸ªç½‘ç«™çš„å†…å®¹è¢«éƒ¨ç½²åœ¨è‹¥å¹²æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥æŠŠè¿™äº›æœºå­çœ‹æˆä¸€ä¸ªé›†ç¾¤ï¼Œé‚£Nginxå¯ä»¥å°†æ¥æ”¶åˆ°çš„å®¢æˆ·ç«¯è¯·æ±‚â€œå‡åŒ€åœ°â€åˆ†é…åˆ°è¿™ä¸ªé›†ç¾¤ä¸­æ‰€æœ‰çš„æœåŠ¡å™¨ä¸Šï¼Œä»è€Œå®ç°æœåŠ¡å™¨å‹åŠ›çš„å¹³å‡åˆ†é…ï¼Œä¹Ÿå«è´Ÿè½½å‡è¡¡ã€‚ Nginxçš„åå‘ä»£ç†å®æ“è¿™é‡Œæˆ‘ä»¬ç”¨ 8001 çš„é…ç½®æ¥åšåå‘ä»£ç†ï¼Œè®¾ç½®ä¹Ÿå¾ˆç®€å•ï¼Œä¿®æ”¹ vim /etc/nginx/conf.d/8001.conf å¦‚ä¸‹ æˆ‘ä»¬è¦è®¿é—® 8.134.120.206:8001 ç«¯å£çš„ç½‘ç«™ï¼Œåå‘ä»£ç†åˆ° æˆ‘çš„åšå®¢ è¿™ä¸ªç½‘ç«™ä¸Š 1234567server&#123; listen 8001; server_name 8.134.120.206; location / &#123; proxy_pass http://zyzy.info; &#125;&#125; æ‰“å¼€æµè§ˆå™¨æ˜¾ç¤ºå¦‚ä¸‹ï¼Œåå‘ä»£ç†è®¾ç½®æˆåŠŸï¼š åå‘ä»£ç†å…¶ä»–é…ç½®å‚æ•°proxy_set_header :åœ¨å°†å®¢æˆ·ç«¯è¯·æ±‚å‘é€ç»™åç«¯æœåŠ¡å™¨ä¹‹å‰ï¼Œæ›´æ”¹æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚å¤´ä¿¡æ¯ã€‚proxy_connect_timeout:é…ç½®Nginxä¸åç«¯ä»£ç†æœåŠ¡å™¨å°è¯•å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´ã€‚proxy_read_timeout : é…ç½®Nginxå‘åç«¯æœåŠ¡å™¨ç»„å‘å‡ºreadè¯·æ±‚åï¼Œç­‰å¾…ç›¸åº”çš„è¶…æ—¶æ—¶é—´ã€‚proxy_send_timeoutï¼šé…ç½®Nginxå‘åç«¯æœåŠ¡å™¨ç»„å‘å‡ºwriteè¯·æ±‚åï¼Œç­‰å¾…ç›¸åº”çš„è¶…æ—¶æ—¶é—´ã€‚proxy_redirect :ç”¨äºä¿®æ”¹åç«¯æœåŠ¡å™¨è¿”å›çš„å“åº”å¤´ä¸­çš„Locationå’ŒRefreshã€‚ Nginxé€‚é…ç§»åŠ¨ç«¯è¿™é‡Œå’Œå‰ç«¯çš„è°ƒæ•´é¡µé¢å¸ƒå±€çš„è‡ªé€‚åº”ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œç°åœ¨çš„ç§»åŠ¨ç«¯é€‚é…ï¼Œæ˜¯ç”±äºä¸åŒåŸŸåçš„åˆ‡æ¢ï¼Œå¼•èµ·çš„é€‚é…ï¼Œæ‰€ä»¥Nginxåœ¨è¿™å—å°±èƒ½å‘æŒ¥ä½œç”¨ï¼Œè¿™ç§é€šè¿‡Nginxçš„é€‚é…ï¼Œä½“éªŒæ•ˆæœä¼šæ›´å¥½ï¼ŒåŒ…æ‹¬æ·˜å®äº¬ä¸œåœ¨å†…çš„å›½å†…å¤§å‹ç½‘ç«™éƒ½æ˜¯é‡‡ç”¨Nginxçš„æ–¹æ¡ˆ æˆ‘ä»¬å¯ä»¥æ‰“å¼€æµè§ˆå™¨æ‰“å¼€äº¬ä¸œçœ‹åˆ°è¿™ç§é€‚é…ï¼š æˆ‘ä»¬æ¥åšç±»ä¼¼çš„åŠŸèƒ½ï¼š å»ºç«‹pcå’Œç§»åŠ¨ç«¯ä¸¤ä¸ªæ–‡ä»¶å¤¹ 1mkdir /usr/share/nginx/pc /usr/share/nginx/mobile åˆ†åˆ«ç¼–è¾‘ vim /usr/share/nginx/mobile/pc/index.html å’Œ vim /usr/share/nginx/mobile/mobile/index.htmlï¼Œéšä¾¿å†™ç‚¹å†…å®¹ ç¼–è¾‘Nginxè®¾ç½®å¦‚ä¸‹å³å¯ 1234567891011server&#123; listen 8001; server_name 8.134.120.206; location / &#123; root /usr/share/nginx/pc; if ($http_user_agent ~* &#x27;Android|webOS|iPhone|BlackBerry&#x27;) &#123; root /usr/share/nginx/mobile; &#125; index index.html; &#125;&#125; æ‰“å¼€æµè§ˆå™¨çœ‹çœ‹æ•ˆæœ Gzipå‹ç¼©ç½‘é¡µçš„ä¸€ç§å‹ç¼©æŠ€æœ¯ï¼Œç»è¿‡Gzipå‹ç¼©è¿‡åçš„ç½‘é¡µï¼Œä¼šç¼©å°åˆ°åŸæ¥30%çš„å¤§å° æŸ¥çœ‹ä¸€ä¸ªç½‘ç«™æ˜¯å¦æœ‰gzipå‹ç¼©åœ¨ç«™é•¿å·¥å…· é‡ŒæŸ¥çœ‹ï¼Œç›´æ¥è¾“å…¥åŸŸåå³å¯ï¼Œä¾‹å¦‚æˆ‘ä»¬æŸ¥è¯¢ 8.134.120.206è¿˜æ²¡é…ç½®gzipå‹ç¼© Nginxçš„gzipå‹ç¼©åŠŸèƒ½éå¸¸ä¸°å¯Œï¼Œé…ç½®ä¹Ÿå¾ˆç®€å• 1vim /etc/nginx/nginx.conf æ·»åŠ ä¸¤è¡Œé…ç½®å¦‚ä¸‹ï¼š 12gzip on;gzip_types text/plain application/javascript text/css; æ”¹å®Œåé‡è½½NginxæœåŠ¡ï¼Œå†ç”¨ç«™é•¿å·¥å…·æŸ¥è¯¢å¯çœ‹åˆ°","categories":[],"tags":[{"name":"åç«¯","slug":"åç«¯","permalink":"https://zyzy.info/tags/%E5%90%8E%E7%AB%AF/"},{"name":"Nginx","slug":"Nginx","permalink":"https://zyzy.info/tags/Nginx/"},{"name":"åå‘ä»£ç†","slug":"åå‘ä»£ç†","permalink":"https://zyzy.info/tags/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"}]},{"title":"Dartè¯­æ³•è‡ªå­¦ç¬”è®°ï¼ˆäºŒï¼‰","slug":"ã€2021-05-26ã€‘Dartè¯­æ³•è‡ªå­¦ç¬”è®°ï¼ˆäºŒï¼‰","date":"2021-05-26T09:10:54.000Z","updated":"2021-10-14T03:42:59.912Z","comments":true,"path":"2021/05/26/ã€2021-05-26ã€‘Dartè¯­æ³•è‡ªå­¦ç¬”è®°ï¼ˆäºŒï¼‰/","link":"","permalink":"https://zyzy.info/2021/05/26/%E3%80%902021-05-26%E3%80%91Dart%E8%AF%AD%E6%B3%95%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/","excerpt":"æœ¬ç¯‡ä»‹ç»Dartçš„å‡½æ•°ï¼Œç±»ï¼ŒæŠ½è±¡ç±»ï¼Œæ¥å£ï¼Œæ³›å‹åŠåº“çš„ä½¿ç”¨","text":"æœ¬ç¯‡ä»‹ç»Dartçš„å‡½æ•°ï¼Œç±»ï¼ŒæŠ½è±¡ç±»ï¼Œæ¥å£ï¼Œæ³›å‹åŠåº“çš„ä½¿ç”¨ å‘½åå‡½æ•°ï¼ŒåŒ¿åå‡½æ•°ï¼Œç®­å¤´å‡½æ•°æ³¨æ„ï¼ï¼ç®­å¤´å‡½æ•°åªèƒ½å†™ä¸€ä¸ªè¯­å¥ 12345678910// void å¯çœç•¥void func () &#123; print(&#x27;hello world&#x27;);&#125;;// åŒ¿å() &#123; print(123); &#125;;// ç®­å¤´func2 () =&gt; print(123); å‡½æ•°çš„å®šä¹‰åŠè°ƒç”¨123456789101112int sunNum(int n)&#123; var sum = 0; for (var i =1; i&lt;=n; i++) &#123; sum+=i; &#125; return sum;&#125;void main() &#123; print(sumNum(10)); // 55&#125; å¯é€‰å‚æ•°ï¼Œ é»˜è®¤å‚æ•°ï¼Œå‘½åå‚æ•° å¯é€‰å‚æ•°ï¼Œç”¨ [] æ‹¬èµ·æ¥ï¼Œä¸”ä¸èƒ½æŒ‡å®šç±»å‹ é»˜è®¤å‚æ•°ï¼Œç›´æ¥ç­‰äºä¸€ä¸ªå€¼å°±æ˜¯é»˜è®¤å‚æ•°ï¼Œå¯æŒ‡å®šç±»å‹ 123456789String userInfo (String username, [age, String gender=&#x27;m&#x27;] ) &#123; if (age == null ) return &#x27;$username&#x27;; return &#x27;$username, $age, $gender&#x27;;&#125;void main()&#123; print(userInfo(&#x27;æ²¡åå­—&#x27;, 23)); // æ²¡åå­—, 23, m&#125; å‘½åå‚æ•°ï¼Œå’Œä¸Šé¢ä¸¤ç§ç±»ä¼¼ï¼Œå¦‚æœè¦æŒ‡å®šç±»å‹ï¼Œåˆ™å¿…é¡»æœ‰é»˜è®¤å€¼ 123456789yyy (String username, &#123;age, String gender=&#x27;male&#x27;, job=&#x27;programmer&#x27;&#125;) &#123; if (age == null || job == null) return &#x27;$username, å¹´é¾„ä¿å¯†, $gender&#x27;; return &#x27;$username, å¹´é¾„ä¿å¯†, $gender, $job&#x27;;&#125;void main () &#123; print(yyy(&#x27;å¼ ä¸‰&#x27;, age:23, gender: &#x27;female&#x27;)); // å¼ ä¸‰, å¹´é¾„ä¿å¯†, male programmer&#125; æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å‚12345678fn1() =&gt; print(&#x27;fn1&#x27;);fn2(fn)&#123; fn();&#125;void main() &#123; fn2(fn1); // fn1&#125; ç±»å’Œæ„é€ å‡½æ•° dartä¸ºå•ç»§æ‰¿è¯­è¨€ ç±»é‡Œçš„åŒåæ–¹æ³•ä¸ºæ„é€ å‡½æ•°ï¼Œåœ¨æ„é€ å‡½æ•°ç”Ÿæˆä¹‹å‰è¿˜èƒ½æ‰§è¡Œå…¶ä»–çš„æ“ä½œï¼Œå†™åœ¨æ‹¬å·å’Œå·¦èŠ±æ‹¬å·ä¹‹é—´ï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718class PersonY &#123; String name; int age; // ä¸”æ„é€ å‡½æ•°ä¹‹å‰è¿˜èƒ½è¿›è¡Œæ“ä½œ :name=&#x27;æ„é€ å‡½æ•°ä¹‹å‰ç”Ÿæˆçš„name&#x27;, age=999 .ç”¨çš„å°‘ PersonY(String name, int age): name=&#x27;æ„é€ å‡½æ•°ä¹‹å‰ç”Ÿæˆçš„name&#x27;, age=999 &#123; print(&#x27;æ„é€ å‡½æ•°ç”Ÿæˆä¹‹å‰æ‰“å°çš„å†…å®¹:$&#123;this.name&#125;--$&#123;this.age&#125;&#x27;); this.name=name; this.age=age; &#125;&#125;main() &#123; PersonY p2 = new PersonY(&#x27;æå››&#x27;, 45); print(p2.name); // æ„é€ å‡½æ•°ç”Ÿæˆä¹‹å‰æ‰“å°çš„å†…å®¹:æ„é€ å‡½æ•°ä¹‹å‰ç”Ÿæˆçš„name--999 // æå››&#125; æ„é€ å‡½æ•°å¯ä»¥ç®€å†™ dartæ„é€ å‡½æ•°åªæœ‰ä¸€ä¸ªï¼Œä½†å‘½åæ„é€ å‡½æ•°å¯ä»¥å†™å¤šä¸ªï¼š 123456789101112131415161718class PersonZ &#123; String name; int age; // ç®€å†™ï¼š PersonZ(this.name, this.age); // å‘½åæ„é€ å‡½æ•°ï¼šå¦‚æœæœ‰å±æ€§ï¼Œåˆ™ä¸€å®šè¦ä¼ å…¥å±æ€§ç»´æŠ¤èµ·æ¥ï¼šä¾‹å¦‚è¿™é‡Œçš„ this.name å’Œ this.age PersonZ.named(this.name, this.age) &#123; print(&#x27;è¿™æ˜¯å‘½åæ„é€ å‡½æ•°&#x27;); &#125;&#125;main() &#123; // è°ƒç”¨å‘½åæ„é€ å‡½æ•°ä»è¦ä¼ å‚ï¼š PersonZ pp = new PersonZ.named(&#x27;xxxx&#x27;, 12); print(pp.name); print(pp.age); &#125; ä»¥ä¸Šæ‰§è¡Œè¾“å‡ºå¦‚ä¸‹ï¼š è¿™æ˜¯å‘½åæ„é€ å‡½æ•°xxxx12 ç§æœ‰å±æ€§darté‡Œå¹¶æ²¡æœ‰ public private protected ç­‰å…³é”®å­—ï¼Œå®šä¹‰ç§æœ‰å±æ€§æ—¶ï¼Œå¿…é¡»ï¼š ä»¥ _ ä¸ºå¼€å¤´çš„å±æ€§ ç‹¬ç«‹ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸” import åˆ° main æ–¹æ³•é‡Œæ‰§è¡Œï¼Œæ‰èƒ½è¾¾åˆ°ç§æœ‰å±æ€§çš„æ•ˆæœ 12345678910111213141516171819202122class Pet&#123; // ç§æœ‰å±æ€§å‰åŠ ä¸‹åˆ’çº¿,å¹¶ä¸”å¿…é¡»å†™åœ¨ç‹¬ç«‹çš„æ–‡ä»¶é‡Œ: String _name; int age; Pet(this._name, this.age); void printInfo() &#123; // ç±»é‡Œå¯ä»¥ç›´æ¥è®¿é—®ç§æœ‰å±æ€§_name, Petå¤–éƒ¨åˆ™ä¸èƒ½ print(&#x27;$&#123;this._name&#125;====$&#123;this.age&#125;&#x27;); &#125; // ç§æœ‰æ–¹æ³•_run void _run()&#123; print(&#x27;ç§æœ‰æ–¹æ³•&#x27;); &#125; // å¤–éƒ¨è®¿é—®ç§æœ‰æ–¹æ³•: execRun()&#123; this._run(); &#125;&#125; è°ƒç”¨å¤„ï¼š 12345678910111213141516// 1. å¿…é¡»å¸è½½ç‹¬ç«‹çš„æ–‡ä»¶é‡Œ,ç§æœ‰å˜é‡æ‰ç”Ÿæ•ˆ:import &#x27;./08-ç§æœ‰å±æ€§/Pet.dart&#x27;;void main() &#123; Pet a = new Pet(&#x27;ç‹—&#x27;, 3); /* // print(a._name); 2. æŠ¥é”™,ä¸èƒ½ç›´æ¥è®¿é—®,_nameä¸ºç§æœ‰å±æ€§,é¡»è¦å®šä¹‰æ–¹æ³•è®¿é—® */ // éç§æœ‰å±æ€§,å¯ä»¥ç›´æ¥è®¿é—®: print(a.age); // 3 a.printInfo(); // ç‹—====3 a.execRun(); //é—´æ¥è°ƒç”¨ç§æœ‰æ–¹æ³•&#125; è¿ç¼€æ“ä½œç¬¦123456789Person p2 = new Person(&#x27;ç‹äº”&#x27;, 34);p1..name = &#x27;æå››&#x27; ..age = 30 ..printInfo();// ç›¸å½“äº// p1.name = &#x27;æå››&#x27;;// p1.age = 30;// p1.printInfo(); ç»§æ‰¿å¯åˆ©ç”¨ vs code é‡Œçš„å¿«æ·æ–¹å¼è¿›è¡Œæ“ä½œï¼Œä¸ç”¨è‡ªå·±å†™ï¼š super å…³é”®å­—1234567891011121314151617181920212223242526272829303132class Person &#123; String name; num age; Person(this.name, this.age); void printInfo() &#123; print(&#x27;çˆ¶ç±»çš„printInfoï¼š$&#123;this.name&#125;---$&#123;this.age&#125;&#x27;); &#125;&#125;class Web extends Person &#123; String gender=&#x27;m&#x27;; Web(String name, num age, // String gender å­ç±»è‡ªå·±çš„å±æ€§ï¼š String gender) : // super å¯ç”¨äºç»§æ‰¿çˆ¶ç±»çš„å±æ€§ï¼š super(name, age) &#123; // 2. å±äºè¯¥å‡½æ•°è‡ªç”±çš„æ„é€ å‡½æ•°å†™è¿™é‡Œ: this.gender = gender; &#125; run()&#123; // super å¯ç”¨äºç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•ï¼š super.printInfo(); print(&#x27;$&#123;this.name&#125;--$&#123;this.age&#125;--$&#123;this.gender&#125;&#x27;); &#125; // é‡å†™çˆ¶ç±»å­˜åœ¨çš„æ–¹æ³•: @override, ç”¨äºæ ‡ç¤ºï¼Œå¯çœç•¥ @override void printInfo() &#123; print(&#x27;å­ç±»é‡å†™çš„æ–¹æ³•ï¼š$&#123;this.gender&#125;-$&#123;this.name&#125;&#x27;); &#125;&#125; abstract æŠ½è±¡ç±» æŠ½è±¡ç±»ï¼š 12345678910abstract class Pet &#123; // æŠ½è±¡æ–¹æ³•ï¼Œä¸å†™æ–¹æ³•ä½“ï¼š eat(); run(); // æŠ½è±¡ç±»é‡Œçš„æ™®é€šæ–¹æ³•ï¼š printInfo()&#123; print(&#x27;æŠ½è±¡ç±»çš„æ™®é€šæ–¹æ³•&#x27;); &#125;&#125; æŠ½è±¡æ–¹æ³•è¢«ç»§æ‰¿æ—¶å‡è¦é‡å†™ï¼š 12345678910111213class Dog extends Pet &#123; @override eat() &#123; // TODO: implement eat print(&#x27;å°ç‹—åƒéª¨å¤´&#x27;); &#125; @override run() &#123; // TODO: implement run print(&#x27;å°ç‹—åœ¨è·‘&#x27;); &#125;&#125; implements æ¥å£ darté‡Œæ²¡æœ‰æ¥å£çš„æ¦‚å¿µï¼Œç”¨æŠ½è±¡ç±»æ›¿ä»£ æ¥å£ç»§æ‰¿æ—¶ï¼Œç”¨å…³é”®å­— implements ä¸‹é¢çš„ä¾‹å­ä¸¾è¿æ¥æ•°æ®åº“çš„æŠ½è±¡ç±»å’Œå®ä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132abstract class Db &#123; String uri=&#x27;&#x27;; //æ•°æ®åº“è¿æ¥åœ°å€ add(String data); save(); delete();&#125;class Mysql implements Db &#123; @override String uri; Mysql(this.uri); @override add(String data) &#123; // TODO: implement add print(&#x27;è¿™æ˜¯mysqlçš„addæ–¹æ³•:$&#123;data&#125;&#x27;); &#125; @override delete() &#123; // TODO: implement delete return null; &#125; @override save() &#123; // TODO: implement save return null; &#125; &#125; ä¸€ä¸ªç±»å¯ implements å¤šä¸ªæ¥å£ï¼š 123456789101112131415abstract class A &#123; printA(); &#125;abstract class B &#123; printB(); &#125;class C implements A, B &#123; @override printA() &#123; // TODO: implement printA return null; &#125; @override printB() &#123; // TODO: implement printB return null; &#125;&#125; mixins æ··åˆ dart ç‰¹æœ‰çš„ç‰¹æ€§ï¼Œå› ä¸ºdartæ˜¯å•ç»§æ‰¿ï¼Œmixins å¯è®©å…¶å®ç°å®ç°ç±»ä¼¼å¤šç»§æ‰¿çš„ç‰¹æ€§ï¼Œä¸€ä¸ªç±»å¯ mixins å¤šä¸ªç±» å®ç°è¯¥ç‰¹æ€§ç”¨ with å…³é”®å­— è¢« mixins çš„çˆ¶ç±»ä¸èƒ½æœ‰æ„é€ å‡½æ•°ï¼Œå¦‚æœ‰æ„é€ å‡½æ•°ï¼Œä¸èƒ½è¢« mixins 1234567891011// D å’Œ E æ²¡æœ‰æ„é€ å‡½æ•°ï¼šclass D &#123; printD()&#123; print(&#x27;D&#x27;); &#125;&#125;class E &#123; printE()&#123; print(&#x27;E&#x27;); &#125;&#125;class F with D, E &#123;&#125;main() &#123; F f = new F(); f.printD(); // D f.printE(); // E&#125; æœ‰æ„é€ å‡½æ•°è¢« mixinsçš„æ–¹æ³•ï¼šextends åå† with, å¦‚ä¸‹ä¾‹å­: 123456789101112131415161718class Person &#123; String name; int age; // æ„é€ å‡½æ•°: Person(this.name, this.age); void printInfo()&#123; print(&#x27;$&#123;this.name&#125;-$&#123;this.age&#125;&#x27;);&#125;&#125;class G &#123; void printG()&#123;print(&#x27;G&#x27;);&#125; &#125;// P ç»§æ‰¿è‡ªPerson, ä¸”æ··åˆG: å› Personä¸­æœ‰æ„é€ å‡½æ•°Person(this.name, this.age); æ•…ä¸èƒ½ç›´æ¥withclass P extends Person with G &#123; P(String name, int age) : super(name, age);&#125;main() &#123; P p = new P(&#x27;å‘µå‘µ&#x27;,37); p.printInfo(); // å‘µå‘µ-37 p.printG(); // G&#125; æ³›å‹æ³›å‹å³å®šä¹‰ä¼ å…¥å’Œè¿”å›ç±»å‹çš„æ ¡éªŒçš„ä¸€ç§è§„èŒƒ 12345678910// 1. å®šä¹‰ä¸€ç§æ³›å‹ï¼Œè¿”å›çš„æ˜¯æ³›å‹ Tï¼Œä¼ å…¥çš„æ˜¯ç±»å‹ &lt;T&gt;ï¼ŒT getData &lt;T&gt; (T value)&#123; print(value);&#125;main() &#123; // 2. è°ƒç”¨æ³›å‹æ–¹æ³•å¹¶æŒ‡å®šç±»å‹ï¼š print(getData &lt;String&gt; (&#x27;ä½ å¥½&#x27;)); // ä½ å¥½ print(getData &lt;int&gt; (123)); // 123&#125; æ³›å‹ç”¨äºç±» 1234567891011121314151617181920// &lt;T&gt; å°†æ£€éªŒç±»å‹ä½œä¸ºå‚æ•°ä¼ å…¥class PrintClass &lt;T&gt; &#123; List list = &lt;T&gt;[]; // T å°†æ£€éªŒç±»å‹ä½œä¸ºå‚æ•°ä¼ å…¥ void add(T value) &#123; this.list.add(value); &#125; void printInfo() &#123; for(var i=0; i&lt;this.list.length; i++) &#123; print(this.list[i]); &#125; &#125;&#125;main() &#123; // è°ƒç”¨æ—¶é¡»ä¼ å…¥æ£€éªŒçš„ç±»å‹ &lt;String&gt; PrintClass p = new PrintClass &lt;String&gt; (); p.add(&#x27;xxxxxxx&#x27;); p.printInfo(); // xxxxxxx&#125; æ³›å‹ç”¨äºæ¥å£ 123456789101112131415161718192021abstract class Cache &lt;T&gt; &#123; getByKey(String key); void setByKey(String key, T value);&#125;// 3.1 å®ç°:class FileCache &lt;T&gt; implements Cache &lt;T&gt; &#123; @override getByKey(String key) &#123; return null; &#125; @override void setByKey(String key, T value) &#123; print(&#x27;æˆ‘æ˜¯æ–‡ä»¶ç¼“å­˜, æŠŠkey=$&#123;key&#125; value=$&#123;value&#125;çš„æ•°æ®å†™å…¥å†…å­˜ä¸­&#x27;); &#125;&#125;main() &#123; MemoryCache m = new MemoryCache &lt;String&gt; (); m.setByKey(&#x27;index&#x27;, &#x27;123&#x27;); // æˆ‘æ˜¯å†…å­˜ç¼“å­˜, æŠŠkey=index value=123çš„æ•°æ®å†™å…¥å†…å­˜ä¸­&#125; åº“çš„ä½¿ç”¨ ç³»ç»Ÿå†…ç½®åº“ï¼Œå¦‚ï¼š 1234567891011121314import &#x27;dart:io&#x27;;import &#x27;dart:convert&#x27;;_getDataFromZhihu() async &#123; var httpClient = new HttpClient(); var uri = new Uri.http(&#x27;news-at.zhihu.com&#x27;, &#x27;/api/3/stories/latest&#x27;); var request = await httpClient.getUrl(uri); var response = await request.close(); return await response.transform(utf8.decoder).join(&#x27; &#x27;);&#125;main(List&lt;String&gt; args) async &#123; var result = await _getDataFromZhihu(); print(result);&#125; ç¬¬ä¸‰æ–¹åŒ…ç®¡ç†ç³»ç»Ÿpubï¼Œå®˜ç½‘åœ¨è¿™é‡Œï¼ŒåŠŸèƒ½ç±»ä¼¼npmçš„ç½‘ç«™ï¼Œè¿™é‡Œä¸¾ä¾‹ http åº“çš„ä½¿ç”¨ å¼•å…¥ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å†™ä¸‹ä¸€ä¸ªpubspec.yaml æ–‡ä»¶ï¼Œç±»ä¼¼ package.json å†™ä¸‹ä½ éœ€è¦å®‰è£…çš„åº“çš„ç‰ˆæœ¬ï¼Œå¦‚ä¸‹ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‹·è´å…¶ç‰ˆæœ¬å· 123456name: xxxdescription: A new flutter module.environment: sdk: &#x27;&gt;=2.10.0 &lt;3.0.0&#x27;dependencies: http: ^0.13.3 æ‰§è¡Œå®‰è£… æ–¹æ³•ä¸€ï¼Œåœ¨pubspec.yaml æ–‡ä»¶å†™å¥½ dependenciesï¼Œå†æ‰§è¡Œå¦‚ä¸‹ï¼š 1dart pub get æ–¹æ³•äºŒï¼Œç›´æ¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…æœ€æ–°ç‰ˆæœ¬ 1dart pub add http_parser ä½¿ç”¨ pub åº“æ˜¯ä»¥ package å¼€å¤´ï¼š 1import &#x27;package:http/http.dart&#x27; as http;","categories":[],"tags":[{"name":"Dart","slug":"Dart","permalink":"https://zyzy.info/tags/Dart/"},{"name":"flutter","slug":"flutter","permalink":"https://zyzy.info/tags/flutter/"}]},{"title":"Dartè¯­æ³•è‡ªå­¦ç¬”è®°ï¼ˆä¸€ï¼‰","slug":"ã€2021-05-25ã€‘Dartè¯­æ³•è‡ªå­¦ç¬”è®°ï¼ˆä¸€ï¼‰","date":"2021-05-25T00:22:49.000Z","updated":"2021-10-14T03:42:59.912Z","comments":true,"path":"2021/05/25/ã€2021-05-25ã€‘Dartè¯­æ³•è‡ªå­¦ç¬”è®°ï¼ˆä¸€ï¼‰/","link":"","permalink":"https://zyzy.info/2021/05/25/%E3%80%902021-05-25%E3%80%91Dart%E8%AF%AD%E6%B3%95%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/","excerpt":"flutteræ¡†æ¶ä»19å¹´å¼€å§‹å°±ç«äº†ï¼Œä¸»è¦ç”¨äºè·¨ç«¯è§£å†³æ–¹æ¡ˆï¼Œä¸€å¥—ä»£ç å¯ä»¥è¦†ç›–iosï¼ŒAndroidå’ŒWebï¼Œæ®è¯´æ³•æ‰§è¡Œæ•ˆç‡å¾ˆé«˜ï¼Œå› å»æ‰äº†åƒReact Nativeé‚£æ ·çš„è½¬è¯‘å±‚ï¼Œç›´æ¥ä½œç”¨äºåº•å±‚ï¼Œé‚£å¿…é¡»å­¦èµ·æ¥ã€‚ flutterå…¶frameworkå±‚é¢è°ƒç”¨çš„æ˜¯Dartï¼Œä¸€æ–°çš„é™æ€è¯­è¨€ï¼Œå’Œjsç‚’é¸¡åƒï¼Œæœ¬æ–‡ä»ç€é‡è®²è§£Dartçš„åŸºç¡€è¯­æ³•ï¼ŒåŒ…æ‹¬åŸºç¡€æ•°æ®è§£æ„ï¼Œå¸¸ç”¨apiåŠå¾ªç¯ï¼Œä¸ç½—åˆ—æ‰€æœ‰åŸºç¡€è¯­æ³•ç‚¹ï¼ŒåªæŒ‘ä¸€äº›æœ‰ç‰¹ç‚¹æ¼”ç¤ºã€‚","text":"flutteræ¡†æ¶ä»19å¹´å¼€å§‹å°±ç«äº†ï¼Œä¸»è¦ç”¨äºè·¨ç«¯è§£å†³æ–¹æ¡ˆï¼Œä¸€å¥—ä»£ç å¯ä»¥è¦†ç›–iosï¼ŒAndroidå’ŒWebï¼Œæ®è¯´æ³•æ‰§è¡Œæ•ˆç‡å¾ˆé«˜ï¼Œå› å»æ‰äº†åƒReact Nativeé‚£æ ·çš„è½¬è¯‘å±‚ï¼Œç›´æ¥ä½œç”¨äºåº•å±‚ï¼Œé‚£å¿…é¡»å­¦èµ·æ¥ã€‚ flutterå…¶frameworkå±‚é¢è°ƒç”¨çš„æ˜¯Dartï¼Œä¸€æ–°çš„é™æ€è¯­è¨€ï¼Œå’Œjsç‚’é¸¡åƒï¼Œæœ¬æ–‡ä»ç€é‡è®²è§£Dartçš„åŸºç¡€è¯­æ³•ï¼ŒåŒ…æ‹¬åŸºç¡€æ•°æ®è§£æ„ï¼Œå¸¸ç”¨apiåŠå¾ªç¯ï¼Œä¸ç½—åˆ—æ‰€æœ‰åŸºç¡€è¯­æ³•ç‚¹ï¼ŒåªæŒ‘ä¸€äº›æœ‰ç‰¹ç‚¹æ¼”ç¤ºã€‚ æœ¬æ–‡çš„ç¤ºä¾‹ä»£ç ï¼Œæ”¾åœ¨è¿™ä¸ª ä»“åº“ï¼Œæœ¬æ–‡é˜è¿°äº† 01-06 çš„ä»£ç  å®‰è£… Dartå®˜ç½‘ä¸Šæœ‰å‘½ä»¤è¡Œçš„å®‰è£…æ–¹æ³•ï¼Œæˆ‘ç”¨winå¹³å°ï¼Œå¯ä»¥ç›´æ¥ä»è¿™é‡Œä¸‹è½½ä¸€ä¸ªSDKå®‰è£…åŒ…ï¼Œç›´æ¥ä¸‹ä¸€æ­¥ä¸‹ä¸€æ­¥å®‰è£…å®Œæˆã€‚ å®‰è£…å®Œæˆåå¯ä»¥åœ¨å‘½ä»¤è¡Œæ£€éªŒç‰ˆæœ¬æ˜¯å¦å®‰è£…æˆåŠŸï¼š C:\\WINDOWS\\System32&gt;dart â€“versionDart SDK version: 2.13.0 (stable) (Wed May 12 12:45:49 2021 +0200) on â€œwindows_x64â€ æˆ‘ç”¨ vs code å¼€å‘ï¼Œå®‰è£… æ’ä»¶ Dart ï¼ŒCode Runner hello worldå…ˆæ¥ä¸ª hello worldï¼Œå‘ç°å’Œ go è¯­è¨€è¯­æ³•æœ‰ç‚¹åƒï¼Œ åŒæ ·æ˜¯ä¸»å…¥å£å‡½æ•° main()&#123;&#125; ä¸»å¯¼ç€æ•´ä¸ªæ–‡ä»¶çš„æ‰§è¡Œ ä¸€ä¸ªè¯­å¥å®Œæˆé¡»å¼ºè¡ŒåŠ  ; 1234// void å¯çœç•¥void main()&#123; print(&#x27;hello world&#x27;);&#125; è¿è¡Œ å‘½ä»¤è¡Œé‡Œç›´æ¥è·‘ dart &lt;DartDoc&gt;.dartï¼Œå°±å¯ä»¥çœ‹åˆ°æ‰“å°çš„ hello world E:\\study\\code\\2021\\dart-learn&gt;dart 01-hello-world.darthello world å˜é‡ var å¸¸é‡ const final dartç±»ä¼¼ ts æœ‰ç±»å‹æ£€æŸ¥åŠŸèƒ½ï¼Œ 12345String str1 = &#x27;ä½ å¥½&#x27;;print(str1); // ä½ å¥½int num1 = 123;print(num1); // 123 ä½† dart ä¹Ÿå¯è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ— é¡»å£°æ˜ç›´æ¥å®šä¹‰ï¼Œç±»ä¼¼ js ï¼š 12345var str = &#x27;hehe&#x27;;print(str); // heheconst e = 2.14;print(e); // 2.14 dart æœ‰ä¸€ä¸ªæƒ°æ€§å¸¸é‡ finalï¼Œå…¶å’Œæ™®é€šå¸¸é‡ const çš„åŒºåˆ«ï¼š final å¯ä»¥åªå®šä¹‰ï¼Œä¸èµ‹å€¼ï¼›const åˆ™ä¸å¯ä»¥ final åªæœ‰åœ¨è¿è¡Œæ—¶æ‰ä¼šåˆå§‹åŒ– ä¾‹å¦‚å®šä¹‰æ—¥æœŸï¼Œå®æ—¶ç”Ÿæˆçš„ï¼Œåªèƒ½ç”¨ final 1234final timeNow;timeNow = new DateTime.now();print(timeNow);// 2021-05-24 12:53:04.819814 æ•°æ®ç±»å‹dartä¸åƒjsï¼Œä¸èƒ½è¿›è¡Œç±»å‹è‡ªåŠ¨è½¬æ¢ï¼Œéœ€è¦æ‰‹åŠ¨è¿›è¡Œè½¬æ¢1234print(&#x27;string&#x27; + 1); // é”™è¯¯// æŠ¥é”™ï¼š// Error: A value of type &#x27;int&#x27; can&#x27;t be assigned to a variable of type &#x27;String&#x27;. boolå¸ƒå°”ç±»å‹ä¸ºä¸€ç§å•ç‹¬ç±»å‹ï¼Œä¸åŒäºjsï¼Œä¸èƒ½è½¬æ¢ä¸º0ï¼Œ1 12bool k = true;print(k); // true int doubleæ•´æ•°ç±»å‹å’Œæµ®ç‚¹ç±»å‹ï¼Œæ²¡å•¥å¥½è®²çš„ String å•è¡Œå­—ç¬¦ä¸²ã€‚å¯ä»¥å•å¼•å·&#39; &#39;æˆ–åŒå¼•å·&quot; &quot;å®šä¹‰ï¼› æ¢è¡Œçš„å­—ç¬¦ä¸²ã€‚ç±»ä¼¼ Python ï¼Œéœ€ç”¨ä¸‰å•å¼•&#39;&#39;&#39; &#39;&#39;&#39; æˆ– ä¸‰åŒå¼•&quot;&quot;&quot; &quot;&quot;&quot;ï¼› å ä½ç¬¦ç”¨ $ï¼Œå•è¡Œæˆ–å¤šè¡Œå­—ç¬¦ä¸²å‡å¯ä½¿ç”¨ï¼› 123456789String str = &#x27;1223&#x27;;var str2 = &#x27;&#x27;&#x27;line1: heheline2: haha&#x27;&#x27;&#x27;;print(&#x27;$str + $str2&#x27;);print(&#x27;-------------&#x27;);print(str + str2); ç»“æœï¼š 1223 + line1: hehe line2: haha 1223 line1: hehe line2: haha Listå®šä¹‰List123456789List l = [&#x27;aaa&#x27;, 3, true];print(l.length); // 3const l2 = [&#x27;vvv&#x27;, &#x27;xx&#x27;];print(&#x27;$l $l2&#x27;); // [aaa, 2, true] [vvv, 5]// å¢åŠ å…ƒç´  .add() æ–¹æ³•ï¼šList l3 = &lt;String&gt;[&#x27;foo&#x27;, &#x27;bar&#x27;];l3.add(&#x27;fee&#x27;); // [foo, bar, fee] åˆ›å»ºå›ºå®šé•¿åº¦Listï¼ŒList.filled(length, å¡«å……çš„å…ƒç´ )ï¼Œä¸èƒ½å¢åŠ æ•°æ®ä½¿ç”¨ add()123// &lt;String&gt; å¯çœç•¥List l5 = List&lt;String&gt;.filled(3, &#x27;&#x27;);print(l5); // [, , ] å¸¸ç”¨Listæ–¹æ³•:å°†ä¸€ä¸ªç°æœ‰Liståè½¬ .reversed.toList()12345List a = [&#x27;12&#x27;, &#x27;23&#x27;, &#x27;34&#x27;, &#x27;45&#x27;];print(a.reversed);// (45, 34, 23, 12)print(a.reversed.toList());// [45, 34, 23, 12] æ›¿æ¢å…ƒç´  fillRange(å¼€å§‹, ç»“æŸ, æ›¿æ¢çš„å…ƒç´ ) æ’å…¥ insert(æ’å…¥ä½ç½®ï¼Œæ’å…¥å…ƒç´ ) insertAll(æ’å…¥ä½ç½®ï¼Œæ’å…¥å¤šä¸ªå…ƒç´ )123456789List l = [&#x27;12&#x27;, &#x27;23&#x27;, &#x27;34&#x27;, &#x27;45&#x27;];l.fillRange(1,3, &#x27;c&#x27;);print(l); // [12, c, c, 45] l.insert(3, &#x27;å•ä¸ªå…ƒç´ &#x27;);print(l); // [12, c, c, å•ä¸ªå…ƒç´ , 45]l.insertAll(2, [&#x27;å…ƒç´ 1&#x27;, &#x27;å…ƒç´ 2&#x27;]);print(l); // [12, c, å…ƒç´ 1, å…ƒç´ 2, c, å•ä¸ªå…ƒç´ , 45] List â€”â€”&gt; Stringï¼š .join()ï¼›String â€”â€”&gt; Listï¼š.split()1234567891011List a = [12, &#x27;CC&#x27;, &#x27;zengjia&#x27;, &#x27;hehe&#x27;, &#x27;haha&#x27;, &#x27;CC&#x27;, 67];var b = a.join(&#x27;-&#x27;);print(b);// 12-CC-zengjia-hehe-haha-CC-67print(b is String);// truevar c = b.split(&#x27;-&#x27;);print(c);// [12, CC, zengjia, hehe, haha, CC, 67]print(c is List);// true Setå’Œ js çš„ Set ç±»ä¼¼ æœ€ä¸»è¦çš„åŠŸèƒ½å°±æ˜¯å»é™¤æ•°ç»„é‡å¤å†…å®¹ æ²¡æœ‰é¡ºåºä¸”ä¸èƒ½é‡å¤çš„é›†åˆï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ç´¢å¼•å»è·å–å€¼ 12345List l = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;];Set ss = new Set();ss.addAll(l);print(ss); // &#123;a, b, c&#125;print(ss.toList()); // [a, b, c] Mapç±»ä¼¼ js çš„objï¼Œå®šä¹‰Mapä¸¤ç§æ–¹æ³•ï¼š 12345var p = &#123;&#x27;name&#x27;: &#x27;zhangsan&#x27;, &#x27;age&#x27;:20&#125;;print(p); // &#123;name: zhangsan, age: 20&#125;var p2 = new Map();print(p2); // &#123;&#125; æ³¨æ„ï¼Map ä¸èƒ½ç”¨ç‚¹ . è¿ç®—ï¼Œåªèƒ½ç”¨å±æ€§é€‰æ‹©å™¨ [] 1print(p[&#x27;age&#x27;]); // 20 keys.toList() values.toList() è®©é”®æˆ–å€¼å˜æˆæ•°ç»„12345678Map p = &#123;&#x27;name&#x27;: &#x27;zhangsan&#x27;, &#x27;age&#x27;:20&#125;;print(person.keys.toList()); // [name, age]print(person.values.toList());// [xxx, 20]print(person.entries);// (MapEntry(name: xxx), MapEntry(age: 20)) is å…³é”®å­—åˆ¤æ–­ç±»å‹1234567String str = &#x27;1223&#x27;;if (str is String) print(&#x27;stringç±»å‹&#x27;);else if(str is int) print(&#x27;intç±»å‹&#x27;);else print(&#x27;å…¶ä»–&#x27;);// stringç±»å‹ å¯è¿­ä»£æ•°æ®çš„é€šç”¨æ–¹æ³•æ‹¼æ¥ .addAll()æ³¨æ„ï¼šList å’Œ Map æ‹¼æ¥å¯åœ¨åŸæ¥çš„åŸºç¡€ä¸Šæ‹¼æ¥ï¼Œå…¶å†…å­˜æŒ‡å‘ä¸å˜ï¼ŒSet æ‹¼æ¥åˆ™éœ€é‡æ–° new ä¸€ä¸ªå¯¹è±¡ 12345678910111213141516171819// List æ‹¼æ¥ï¼šList a = [&#x27;12&#x27;, &#x27;23&#x27;, &#x27;34&#x27;, &#x27;45&#x27;];a.addAll([&#x27;67&#x27;,&#x27;89&#x27;]);print(a);// [12, 23, 34, 45, 67, 89]// Set æ‹¼æ¥ï¼šList l = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;];Set ss = new Set();ss.addAll(l);print(ss); // &#123;a, b, c&#125;print(ss.toList()); // [a, b, c]// Map æ‹¼æ¥ï¼šMap m = &#123;&#x27;name&#x27;:&#x27;Tom&#x27;,&#x27;Id&#x27;:&#x27;E1001&#x27;&#125;;m.addAll(&#123;&#x27;dept&#x27;:&#x27;HR&#x27;,&#x27;email&#x27;:&#x27;tom@xyz.com&#x27;&#125;);print(m);// &#123;name: Tom, Id: E1001, dept: HR, email: tom@xyz.com&#125; è½¬æ¢ä¸ºæ•°ç»„ .toList()è§ä¸Šé¢æè¿‡çš„ä¾‹å­å…·æœ‰æ¶‰åŠ: Listï¼Œ Set è½¬æ¢ä¸ºå­—ç¬¦ä¸² .toString()Listï¼ŒSetï¼ŒMapå‡æœ‰æ­¤åŠŸèƒ½ ä¸¤ä¸ªç‰¹æ®Šè¿ç®—ç¬¦dartçš„è¿ç®—ç¬¦ï¼Œé™¤äº†è¿™é‡Œæåˆ°çš„ä¸¤ç§ç¬¦å·ï¼Œå…¶ä»–å’Œ js ä¸€æ · ~/ å’Œ ~/= å–æ•´ç¬¦å· ~/ï¼Œå¾ˆç®€å•ï¼š 1234int a = 12;int b = 5;print(a~/b);// 2 å¦å¤–ï¼Œå’Œå¤§å¤šæ•°è¯­è¨€ä¸€æ ·ï¼Œdarté‡Œæ²¡æœ‰ä¸‰ç­‰ç¬¦å·ï¼Œåªæœ‰ä¸¤ç­‰ == æ˜¯å¦ä¸ºç©ºèµ‹å€¼ ??=??= è¡¨ç¤ºï¼Œå¦‚æœå€¼ä¸ä¸ºç©ºï¼Œåˆ™èµ‹å€¼ä¸ºæ–°å€¼ï¼›å¦‚æœä¸ä¸ºç©ºï¼Œåˆ™ç”¨åŸå€¼ï¼› 1234567b??=89;print(b);// 5var c = 45;c ??= 8;print(c);// 45 ç±»å‹è½¬æ¢ String â€”â€”&gt; Number ï¼š int.parse() å’Œ double.parse()123456789String y = &#x27;123&#x27;;var m = int.parse(y);print(m is int);// trueString u = &#x27;23.345&#x27;;var x = double.parse(u);print(x is double);// true isEmpty å’Œ isNotEmpty åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºï¼›isNaN åˆ¤æ–­æ•°å€¼æ˜¯å¦åˆæ³•1234567891011var er = &#x27;xxx&#x27;;var xu = 0/0;if(er.isEmpty) print(&#x27;strä¸ºç©º&#x27;); else print(&#x27;strä¸ä¸ºç©º&#x27;);// strä¸ä¸ºç©ºif(xu.isNaN)&#123; print(&#x27;xuä¸åˆæ³•&#x27;);&#125;else&#123; print(&#x27;xuåˆæ³•&#x27;);&#125;// xuä¸åˆæ³• å¾ªç¯å’Œ js ç›¸ä¼¼åº¦è¾¾åˆ° 95% forï¼Œ for indartæ²¡æœ‰ for of å¾ªç¯ï¼Œfor for inå’Œ js åŸºæœ¬ä¸€æ ·çš„å†™æ³• 123456789// ä¾‹ï¼šæ‰“å°1åˆ°9ä¹‹é—´æ‰€æœ‰å¶æ•°ï¼šfor (int i=1; i&lt;=9; i++) &#123; if (i%2 == 0) &#123; print(i); &#125;&#125;// p.s. å¦‚æœåœ¨åŒä¸€è¡Œå†™å¯çœç•¥èŠ±æ‹¬å· `&#123;&#125;` for (int i in [1,2,3,4,5,6,7,8,9]) if(i%2 == 0) print(i); ä»¥ä¸Šå‡è¾“å‡ºï¼š 2468 forEach123456789101112131415161718// å¾ªç¯Listconst l2 = [2,3];l2.forEach((el) &#123; print(el);&#125;);// 2// 3// å¾ªç¯MapMap m = &#123;&#x27;a&#x27;:1, &#x27;b&#x27;:2&#125;;m.forEach((key, value) &#123; print(&#x27;$key --- $value&#x27;);&#125;);// a --- 1// b --- 2// æˆ–å¯å†™ä¸º ç®­å¤´å‡½æ•° =&gt;// m.forEach((key, value) =&gt; print(&#x27;$key --- $value&#x27;)); Listï¼Œ Set çš„é€šç”¨æ–¹æ³•: whereï¼Œanyï¼Œeveryä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„æ–¹æ³•ï¼Œç±»ä¼¼æ¡ä»¶è¯­å¥ï¼Œç”¨äºç‰¹å®šå…ƒç´ çš„æŸ¥æ‰¾å’Œ js çš„æ•°ç»„æ–¹æ³•çš„ .some() .every()ç­‰æ–¹æ³•ç±»ä¼¼ 1234567891011121314151617// ListList l3 = [2,3,6,8];var ll = l3.where((item) =&gt; item &gt;3);print(ll); // (6, 8)print(ll.toList()); // [6, 8]print(l3.any((item) =&gt; item &gt;=3)); // trueprint(l3.every((item) =&gt; item % 2 == 0 || item % 3 == 0 )); // truel3.removeWhere((item) =&gt; item &lt; 7 );print(l3); // [8]// SetSet s2 = &#123;2, 3, 4, 2, 8, 9, 8&#125;;bool ss = s2.any((item) =&gt; item &lt; 1);print(ss); // falseprint(s2.where((item) =&gt; item &gt; 3)); // (4, 8, 9)print(s2.every((item) =&gt; item &lt;= 10)); // true","categories":[],"tags":[{"name":"Dart","slug":"Dart","permalink":"https://zyzy.info/tags/Dart/"},{"name":"Flutter","slug":"Flutter","permalink":"https://zyzy.info/tags/Flutter/"},{"name":"è·¨ç«¯","slug":"è·¨ç«¯","permalink":"https://zyzy.info/tags/%E8%B7%A8%E7%AB%AF/"}]},{"title":"TSåœ¨ReactClasså’ŒReactHooksä¸­çš„åº”ç”¨ï¼ˆæ›´æ–°ï¼‰","slug":"ã€2021-05-04ã€‘TSåœ¨ReactClasså’ŒReactHooksä¸­çš„åº”ç”¨","date":"2021-05-23T00:43:25.000Z","updated":"2022-03-26T02:15:30.412Z","comments":true,"path":"2021/05/23/ã€2021-05-04ã€‘TSåœ¨ReactClasså’ŒReactHooksä¸­çš„åº”ç”¨/","link":"","permalink":"https://zyzy.info/2021/05/23/%E3%80%902021-05-04%E3%80%91TS%E5%9C%A8ReactClass%E5%92%8CReactHooks%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/","excerpt":"å¯¹äºç°è¡Œçš„ESè§„èŒƒï¼Œå·²ç»å…·æœ‰å¾ˆå¥½çš„è§„èŒƒæ€§ä¸å¯è¯»æ€§ï¼Œtype scriptè™½å½“ä¸‹å¤§è¡Œå…¶é“ï¼Œå…¶å®æˆ‘è§‰å¾—æ„ä¹‰ä¸ç®—å¾ˆå¤§ï¼Œtsæœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯ç±»å‹æ£€æŸ¥ï¼ŒåŒ…æ‹¬ interface, type ç­‰ä¹Ÿæ˜¯ä¸€ç§ç±»å‹æ£€æŸ¥ï¼Œä½†ä¸€ä¸å°å¿ƒå°±ä¼šå†™æˆ any scriptã€‚é‰´äºå°†æ¥çš„é¡¹ç›®æˆ–è€…ç°è¡Œçš„é¡¹ç›®å¯èƒ½ä¼šç”¨åˆ°ï¼Œè¿™é‡Œç»“åˆ React Hooks å†™ä¸ª tsx ç‰ˆçš„ demo","text":"å¯¹äºç°è¡Œçš„ESè§„èŒƒï¼Œå·²ç»å…·æœ‰å¾ˆå¥½çš„è§„èŒƒæ€§ä¸å¯è¯»æ€§ï¼Œtype scriptè™½å½“ä¸‹å¤§è¡Œå…¶é“ï¼Œå…¶å®æˆ‘è§‰å¾—æ„ä¹‰ä¸ç®—å¾ˆå¤§ï¼Œtsæœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯ç±»å‹æ£€æŸ¥ï¼ŒåŒ…æ‹¬ interface, type ç­‰ä¹Ÿæ˜¯ä¸€ç§ç±»å‹æ£€æŸ¥ï¼Œä½†ä¸€ä¸å°å¿ƒå°±ä¼šå†™æˆ any scriptã€‚é‰´äºå°†æ¥çš„é¡¹ç›®æˆ–è€…ç°è¡Œçš„é¡¹ç›®å¯èƒ½ä¼šç”¨åˆ°ï¼Œè¿™é‡Œç»“åˆ React Hooks å†™ä¸ª tsx ç‰ˆçš„ demo è‡ªå·±å†™çš„ TypeScript demoï¼ŒTSåŸºç¡€å†…å®¹å¯ä»¥ç¿»çœ‹è¯¥ä»“åº“å®‰è£…æ–°é¡¹ç›®ï¼Œåªéœ€å¸¦--template typescriptå‚æ•°å³å¯ï¼š123create-react-app &lt;app name&gt; --template typescript#or yarn create-react-app &lt;app name&gt; --template typescript è€é¡¹ç›®ï¼Œåœ¨åŸæœ‰JSXé¡¹ç›®create-react-appåŸºç¡€ä¸Šå¢åŠ typescriptå†…å®¹ï¼š12345npm install --save typescript @types/node @types/react @types/react-dom @types/jest # or yarn add typescript @types/node @types/react @types/react-dom @types/jest å®‰è£…ä¸€ä¸ªæ–°çš„åº“ï¼Œéœ€é…ç½® *.d.ts æ–‡ä»¶ï¼šå¤–éƒ¨npm installä¸€ä¸ªåº“æ—¶ï¼Œéœ€è¦å•ç‹¬åˆ›å»ºä¸€ä¸ª.d.tsç»“å°¾çš„æ–‡ä»¶, å¦åˆ™æŠ¥é”™, å¦‚ï¼štouch lib.d.ts: 1declare module &#x27;lodash&#x27; åˆå­¦è€…çš„ç¼–å†™åˆ©å™¨ â€”â€” vs code ä¸­çš„æç¤ºå¯ä»¥åˆ©ç”¨å¥½ vs code ä¸­è‡ªå¸¦çš„æç¤ºï¼Œä¾‹å¦‚ä¸‹é¢çš„æç¤ºï¼Œä¸‹é¢çš„ä¾‹å­ä¼šæˆªå›¾æ­¤ç±»æç¤ºæ¡†ï¼š æœ€å¤–å±‚ index.tsx12345678910111213141516171819import React from &#x27;react&#x27;;import ReactDOM from &#x27;react-dom&#x27;;import App from &#x27;./App&#x27;;// å…¨å±€å˜é‡ï¼Œå¦‚æœ‰ï¼šdeclare global &#123; interface Window &#123; API: any, _store: any &#125;&#125;ReactDOM.render( &lt;React.StrictMode&gt; &lt;App /&gt; &lt;/React.StrictMode&gt;, // HTMLElement æ¥å£ï¼š document.getElementById(&#x27;root&#x27;) as HTMLElement); ç»„ä»¶Function ç»„ä»¶1const App: React.FC = () =&gt; null vs code é‡Œçš„æç¤ºï¼š Class ç»„ä»¶123456// è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå†™åˆ°çƒ‚äº†export class ClassTS extends React.Component &#123; public render(): React.ReactNode &#123; return null &#125; &#125; propsFunction ç»„ä»¶é‡Œçš„props12345678910111213// 1ï¼Œç›´æ¥å†™ï¼šexport const TextField: React.FC&lt;&#123; text: string &#125;&gt; = () =&gt; &#123; return &lt;div&gt;&lt;input type=&quot;text&quot;/&gt;&lt;/div&gt;&#125;// 2. å°† &#123; text: string &#125; ç‹¬ç«‹ä¸ºæ¥å£ç±»ï¼šinterface Props &#123; text: string&#125;export const TextField: React.FC&lt;Props&gt; = () =&gt; &#123; return &lt;div&gt;&lt;input type=&quot;text&quot;/&gt;&lt;/div&gt;&#125; å…¶ä¸­ï¼Œæ¥å£ä¹Ÿå¯éšæ„æ‰©å±•åŠå®šä¹‰å­æ¥å£ï¼Œå¦‚ï¼š 12345678910111213interface Person &#123; firstName: string lastName: string&#125;interface Props &#123; text: string ok?: boolean i?: number fn?: (bob: string) =&gt; string // person: Person&#125; Class ç»„ä»¶é‡Œçš„ props123456789101112131415161718192021// 1ï¼Œç›´æ¥å†™, ä¸¤ä¸ªå‚æ•°é—´ç”¨é€—å·æˆ–åˆ†å·éš”å¼€å‡å¯ï¼šexport class ClassTS extends React.Component &lt;&#123; text: string, age?: number &#125;&gt; &#123; &#125; // 2. å°†propsçš„å‚æ•°ç‹¬ç«‹ä¸ºæ¥å£ç±»ï¼šinterface IProps &#123; text: string age?: number&#125;// 3. é¡ºå¸¦ä¸€æstateï¼Œåªæœ‰interfaceçš„å†™æ³•ï¼šinterface IState &#123; email: string name: string&#125;export class ClassTS extends React.Component &lt;IProps&gt; &#123; state: IState = &#123; name: &#x27;&#x27;, email: &#x27;&#x27; &#125;&#125; ç»„ä»¶é‡Œçš„å‡½æ•°Reactç‰¹æœ‰çš„ç±»å‹ï¼ŒReact.FormEventï¼Œè™šæ‹ŸDOMæŠŠæ‰€æœ‰åŸç”Ÿå‡½æ•°éƒ½æ’¸äº†ä¸ªé: 1234handleChange = ( e : React.FormEvent&lt;HTMLInputElement&gt; ) =&gt; &#123; const &#123; name, value &#125; : any = e.target this.setState(&#123; [name]: value &#125;)&#125; å‡½æ•°ç»„ä»¶çš„ hooksuseState12345678// æˆ–ç”¨ | ï¼Œä¸ç”¨ ||const [count, setCount] = useState &lt; string | null | &#123; text: string &#125; &gt;(&#123; text: &#x27;hello&#x27; &#125;)// æˆ– ç‹¬ç«‹ä¸ºæ¥å£ï¼šinterface TextNode &#123; text: string&#125;const [count, setCount] = useState &lt; number | TextNode &gt;(5) useRef1234// å› ä¸ºrefçš„ç›®æ ‡æ˜¯ä¸€ä¸ªinputæ¡†ï¼Œæ‰€ä»¥ç”¨ &lt;HTMLInputElement&gt;// å¦‚æœæ‰“ä¸Šrefçš„æ˜¯&lt;div&gt;&lt;/div&gt;, åˆ™ç”¨ &lt;HTMLDivElement&gt;const inputRef = useRef&lt;HTMLInputElement&gt;(null) å¦å¤–ï¼ŒhandleChange 123456// å¦‚æœæ˜¯Propsä¼ è¿‡æ¥ï¼Œå¹¶ä¸”å®šä¹‰äº†interfaceæ¥å£ï¼Œåˆ™è¦æ³¨æ˜ï¼šinterface Props &#123; handleChange: ( event: React.ChangeEvent&lt;HTMLInputElement&gt; ) =&gt; void // æˆ–è€…å¦‚ä¸‹å®šä¹‰ä¸ºanyï¼Œä½†ä¸å»ºè®®ï¼Œå› å¤±å»äº†æ£€æŸ¥çš„ä½œç”¨ï¼š // handleChange: ( event: any ) =&gt; void&#125; useReducer12345678910111213141516171819202122interface Todos &#123; text: string complete: boolean&#125;// type State = Array&lt;Todos&gt;// æˆ–ä¸‹é¢è¿™ç§ï¼Œæ›´å½¢è±¡åŒ–ï¼štype State = Todos[]type Actions = &#123; type: &#x27;add&#x27;, text: string &#125; | &#123; type:&#x27;remove&#x27;, idx: number &#125;const TodoReducer = ( state: State, action: Actions ) =&gt; &#123; switch (action.type) &#123; case &#x27;add&#x27;: return [...state, &#123; text: action.text, complete: false &#125;] case &#x27;remove&#x27;: return state.filter((_, i) =&gt; action.idx !== i) default: return state; &#125; &#125;const [todos, dispatch] = useReducer(TodoReducer, []) hooks çš„ render propså°† hooks å‡½æ•° setXXX ä½œä¸ºå‚æ•°ä¼ å‚ï¼Œè¿™ç§propsæ˜¯reactç‹¬æœ‰çš„ï¼ŒReact.Dispatch&lt;React.SetStateAction&lt;number&gt;&gt; 123456789101112131415interface Props &#123; children:( count: number, // å°†`setCount`ä½œä¸ºpropsè¿›è¡Œä¼ å‚ï¼š setCount: React.Dispatch&lt;React.SetStateAction&lt;number&gt;&gt; // è¿”å›å€¼ä¸ºReactç‹¬æœ‰çš„ï¼šJSX.Element ) =&gt; JSX.Element | null&#125;export const Counter: React.FC&lt;Props&gt; = (&#123; children &#125;) =&gt; &#123; const [count, setCount] = useState(0) return &lt;div&gt; &#123;children(count, setCount)&#125; &lt;/div&gt;&#125; å¦ä¸€ç§ï¼ŒåŸç”Ÿçš„å‡½æ•°åœ¨è™šæ‹ŸDOMé‡Œçš„å‡½æ•°ï¼š å†™çš„æ—¶å€™ vs code é‡Œçš„æç¤ºï¼š","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://zyzy.info/tags/React/"},{"name":"type script","slug":"type-script","permalink":"https://zyzy.info/tags/type-script/"}]},{"title":"Vue2+3è‡ªå­¦ç¬”è®°ï¼ˆä¸€ï¼‰","slug":"ã€2021-05-19ã€‘Vue2+3è‡ªå­¦ç¬”è®°ï¼ˆä¸€ï¼‰","date":"2021-05-19T08:20:33.000Z","updated":"2021-10-14T03:42:59.912Z","comments":true,"path":"2021/05/19/ã€2021-05-19ã€‘Vue2+3è‡ªå­¦ç¬”è®°ï¼ˆä¸€ï¼‰/","link":"","permalink":"https://zyzy.info/2021/05/19/%E3%80%902021-05-19%E3%80%91Vue2+3%E8%87%AA%E5%AD%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/","excerpt":"ä¸€ç›´ä»¥æ¥ï¼Œåšé¡¹ç›®éƒ½æ˜¯ç”¨Reactï¼Œæœ€è¿‘å…¬å¸çš„é¡¹ç›®æ¥è§¦åˆ° Vueï¼Œè¿™é‡Œå…ˆæ¡èµ·å¤šå¹´æœªç¢°çš„ Vue ï¼Œå†™ä¸€äº›demoï¼Œ é‡æ¸©ä¸€ä¸‹ Vue2 æœ€ç®€å•çš„ç”¨æ³•ï¼Œå¹¶ç»“åˆæ˜é‡‘çš„è¿™ç¯‡æ–‡ç« ï¼Œçœ‹çœ‹ Vue3 çš„æ–°å˜åŒ–","text":"ä¸€ç›´ä»¥æ¥ï¼Œåšé¡¹ç›®éƒ½æ˜¯ç”¨Reactï¼Œæœ€è¿‘å…¬å¸çš„é¡¹ç›®æ¥è§¦åˆ° Vueï¼Œè¿™é‡Œå…ˆæ¡èµ·å¤šå¹´æœªç¢°çš„ Vue ï¼Œå†™ä¸€äº›demoï¼Œ é‡æ¸©ä¸€ä¸‹ Vue2 æœ€ç®€å•çš„ç”¨æ³•ï¼Œå¹¶ç»“åˆæ˜é‡‘çš„è¿™ç¯‡æ–‡ç« ï¼Œçœ‹çœ‹ Vue3 çš„æ–°å˜åŒ– ä» Vue2 å¼€å§‹æ¬ç –ï¼Œè‡ªå·±å†™äº†ä¸ªTODO Listï¼Œå®Œæ•´ä»£ç åœ¨è¿™é‡Œï¼Œé…åˆVueå®˜æ–¹æ–‡æ¡£å†…å®¹ï¼Œè¿›è¡Œæœ¬æ–‡çš„é˜è¿° è„šæ‰‹æ¶å¼€å§‹é¡¹ç›®å®‰è£… 1yarn global add @vue/cli è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®å¹¶è¿è¡Œï¼š 12vue create &lt;AppName&gt; &amp;&amp; cd &lt;AppName&gt;vue run serve import åä»è¦å£°æ˜ç»„ä»¶ç”±äºvueæ˜¯ç»è¿‡å®ä¾‹åŒ–çš„ï¼Œå±æ€§éƒ½ç»‘å®šåœ¨thisä¸Šï¼Œä»¥thisä½œä¸ºä¸­è½¬ï¼Œæ‰€ä»¥ import åä»è¦åœ¨ component ä¸­å£°æ˜ä¸€æ¬¡ï¼Œå¦åˆ™æŠ¥é”™ï¼š 123456789&lt;script&gt;import Header from &#x27;./components/Header&#x27;export default &#123; components: &#123; Header, &#125;,&#125;&lt;/script&gt; props å±æ€§å¯ä»¥å£°æ˜æ•°ç»„æˆ–å¯¹è±¡å£°æ˜å¯¹è±¡æ—¶ç±»ä¼¼tsçš„ç±»å‹æ£€éªŒ 123456789 props: [&#x27;text&#x27;, &#x27;color&#x27;, &#x27;title&#x27;, &#x27;showAddTask&#x27;]// or props: &#123; text: String, color: String, title: String, showAddTask: Boolean &#125;, æ’å€¼è¡¨è¾¾å¼æ’å€¼è¡¨è¾¾å¼å…¶å€¼å¯æ¥è‡ªè‡ªèº«æ–‡ä»¶çš„ data å±æ€§ï¼Œä¹Ÿå¯æ¥è‡ª props å±æ€§ 12345678910&lt;button :style=&quot;&#123; background: color &#125;&quot; class=&quot;btn&quot;&gt;&#123;&#123; text &#125;&#125;&lt;/button&gt; props: &#123; text: String &#125;, // or data: &#123; text: &#x27;hehe&#x27; &#125; è¿˜æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„æ’å€¼è¡¨è¾¾å¼ v-text ç”¨äºæ˜¾ç¤ºå­—ç¬¦ä¸²ï¼š 123&lt;p v-text=&quot;data&quot;&gt;&lt;/p&gt;data: &#123; text: &#x27;æˆ‘æ˜¯è¦æ˜¾ç¤ºçš„ä¿¡æ¯&#x27; &#125; v-html ç”¨äºæ˜¾ç¤ºå¸¦HTMLçš„æ–‡æœ¬ï¼š 123&lt;div v-html=&quot;data&quot;&gt;&lt;/div&gt;data: `&lt;a&gt;1111111111&lt;/a&gt;` å®é™…ä¸Šï¼Œv-html ç¼–è¯‘åé•¿è¿™æ ·ï¼š123&lt;div&gt; &lt;a&gt;1111111111&lt;/a&gt;&lt;/div&gt; æ•°å€¼ç»‘å®š v-bind: æˆ–ç®€å†™ :ç”¨äºç»‘å®šæ ·å¼ï¼š 123&lt;button v-bind:style=&quot;&#123; background: color &#125;&quot; class=&quot;btn&quot;&gt;x&lt;/button&gt;&lt;!-- æˆ–ç®€å†™ä¸º --&gt;&lt;button :style=&quot;&#123; background: color &#125;&quot; class=&quot;btn&quot;&gt;x&lt;/button&gt; äº‹ä»¶ç»‘å®š v-on: æˆ–ç®€å†™ @12345678&lt;button @click=&quot;onClick()&quot; &gt;&#123;&#123; text &#125;&#125;&lt;/button&gt;// éœ€åœ¨ `methods` é‡Œå®šä¹‰ç»‘å®šäº‹ä»¶ï¼šmethods: &#123; onClick() &#123; // ... &#125;&#125; è¿˜æœ‰åŠ¨æ€å‚æ•°çš„ç¼©å†™(v2.6.0+)ï¼Œç±»ä¼¼å±æ€§é€‰æ‹©å™¨ï¼ŒeventName æ–¹æ³•åå¯åŠ¨æ€ä¼ å…¥ï¼Œæ‘˜è‡ªå®˜ç½‘ï¼š 1&lt;a @[eventName]=&quot;doSomething&quot;&gt; ... &lt;/a&gt; å¾ªç¯ v-for åŸºç¡€æ‰“æ³•â€”â€”ç”¨äºæ•°ç»„ï¼Œè¿™é‡Œç”¨åœ¨äº†ç»„ä»¶ &lt;Task :task=&quot;task&quot; /&gt; ä¸Šï¼Œ å¿…é¡»ç»‘å®škey å€¼ï¼Œ å’Œ React ä¸€æ ·ï¼Œç”±äºè™šæ‹ŸDOM Diffç®—æ³•çš„åŸå› ï¼Œkeyä¸èƒ½ç”¨æ•°ç»„ä¸‹æ ‡ï¼Œå¿…é¡»æ˜¯ä¸é‡å¤çš„å­—ç¬¦ä¸²ï¼š 123&lt;div v-for=&quot;task in tasks&quot; :key=&quot;task.id&quot;&gt; &lt;Task :task=&quot;task&quot; /&gt;&lt;/div&gt; è¿˜å¯ç”¨äºå¯¹è±¡objï¼š 12345678910111213&lt;ul id=&quot;v-for-object&quot; class=&quot;demo&quot;&gt; &lt;li v-for=&quot;value in object&quot;&gt; &#123;&#123; value &#125;&#125; &lt;/li&gt;&lt;/ul&gt;data: &#123; object: &#123; title: &#x27;How to do lists in Vue&#x27;, author: &#x27;Jane Doe&#x27;, publishedAt: &#x27;2016-04-10&#x27; &#125;&#125; æ˜¾ç¤ºä¸ºï¼š How to do lists in Vue Jane Doe 2016-04-10 objä¹Ÿå¯ä»¥ç”¨é”®å€¼å¯¹è§£æ„æ˜¾ç¤ºï¼Œä»–è¿˜æœ‰ç¬¬ä¸‰ä¸ªå‚æ•° index 123&lt;div v-for=&quot;(value, name, index) in object&quot;&gt; &#123;&#123; index &#125;&#125;. &#123;&#123; name &#125;&#125;: &#123;&#123; value &#125;&#125;&lt;/div&gt; æ˜¾ç¤ºä¸ºï¼š 0.title:How to do lists in Vue 1.name:Jane Doe 2.value:2016-04-10 ä½ ä¹Ÿå¯ä»¥ç”¨ of æ›¿ä»£ in ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå› ä¸ºå®ƒæ›´æ¥è¿‘ JavaScript è¿­ä»£å™¨çš„è¯­æ³•ï¼š 1&lt;div v-for=&quot;item of items&quot;&gt;&lt;/div&gt; äº‹ä»¶æ´¾å‘ $emit ä¸ç›‘å¬ :é¡¹ç›®ä¸­æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ•°æ®æµ å­ â€”â€”&gt; çˆ¶ çš„æ–¹å¼å°±æ˜¯ $emit â€”â€”&gt; @ ï¼Œå¦‚ï¼š å‘å°„å¤„ï¼Œå°†idä¹Ÿä¸€èµ·å‘å‡ºï¼Œ $emit(&#39;å‡½æ•°å&#39;, å‘å°„çš„å‚æ•°)ï¼Œå…¶ä¸­ï¼Œå‘å°„çš„å‚æ•°å¯ä»¥å¦‚ä¸‹ï¼Œä¸€ä¸ªç®€å•çš„id1234&lt;div v-for=&quot;task of tasks&quot; :key=&quot;task.id&quot;&gt; &lt;Task :task=&quot;task&quot; @delete-task=&quot;$emit(&#x27;delete-task&#x27;, task.id)&quot; /&gt;&lt;/div&gt;&lt;script&gt; script é‡Œä¹Ÿè¦æ³¨å†Œè¯¥äº‹ä»¶ï¼š1emits: [&#x27;delete-task&#x27;,], @ æ¥æ”¶è¯¥ emit å‡ºæ¥çš„äº‹ä»¶ï¼Œå¹¶å‘½åï¼š 1&lt;Task :task=&quot;task&quot; @delete-task=&quot;$emit(&#x27;delete-task&#x27;, task.id)&quot; /&gt; åœ¨ script é‡Œç»‘å®š deleteTask(id)&#123;&#125; äº‹ä»¶ï¼Œè¦æ³¨æ„ï¼Œè¿™é‡Œçš„ id å³ä¸º $emit ä¼ è¿‡æ¥çš„ç¬¬äºŒä¸ªå‚æ•° 1234567methods: &#123; deleteTask(id) &#123; if (confirm(&#x27;r u sure?&#x27;)) this.tasks = this.tasks.filter( task =&gt; task.id !== id ) &#125;, ...&#125; åŒå‘æ•°æ®ç»‘å®š v-model è¿™ä¸ªæ˜¯Vueæ¡†æ¶çš„ç²¾åæ‰€åœ¨ï¼ŒæŠ„è¢­Ngçš„ï¼Œåœ¨è¾“å…¥å¤„ç”¨ v-model ç»‘å®šï¼š 123456789&lt;!-- formè¡¨å•ç»‘å®š onSubmit äº‹ä»¶ --&gt;&lt;form class=&quot;add-form&quot; @submit=&quot;onSubmit&quot;&gt; &lt;!-- æœé›†è¾“å…¥ --&gt; &lt;input type=&quot;text&quot; name=&quot;text&quot; placeholder=&quot;Add Task&quot; v-model=&quot;text&quot; &gt; &lt;!-- æäº¤æŒ‰é’® --&gt; &lt;input type=&quot;submit&quot; value=&quot;Save Task&quot; class=&quot;btn btn-block&quot;&gt;&lt;/form&gt; script é‡Œç»‘å®š onSubmit(e) äº‹ä»¶ 12345678910111213141516171819onSubmit(e) &#123; e.preventDefault() if (!this.text) &#123; alert(&#x27;Pls add a task&#x27;) return &#125; const newTask = &#123; id: Math.floor(Math.random() * 100000), text: this.text, day: this.day, reminder: this.reminder &#125; this.$emit(&#x27;add-task&#x27;, newTask) this.text = &#x27;&#x27; this.day = &#x27;&#x27; this.reminder = false&#125;","categories":[],"tags":[{"name":"Vue","slug":"Vue","permalink":"https://zyzy.info/tags/Vue/"}]},{"title":"æ ‡ç­¾æ¨¡æ¿ï¼ˆTagged Template)â€”â€”ESçŸ¥è¯†ç‚¹è¡¥æ¼ç³»åˆ—ï¼ˆ2ï¼‰","slug":"ã€2021-05-12ã€‘æ ‡ç­¾æ¨¡æ¿ï¼ˆTagged-Template-â€”â€”ESçŸ¥è¯†ç‚¹è¡¥æ¼ç³»åˆ—ï¼ˆ2ï¼‰","date":"2021-05-12T01:18:46.000Z","updated":"2021-10-14T03:42:59.911Z","comments":true,"path":"2021/05/12/ã€2021-05-12ã€‘æ ‡ç­¾æ¨¡æ¿ï¼ˆTagged-Template-â€”â€”ESçŸ¥è¯†ç‚¹è¡¥æ¼ç³»åˆ—ï¼ˆ2ï¼‰/","link":"","permalink":"https://zyzy.info/2021/05/12/%E3%80%902021-05-12%E3%80%91%E6%A0%87%E7%AD%BE%E6%A8%A1%E6%9D%BF%EF%BC%88Tagged-Template-%E2%80%94%E2%80%94ES%E7%9F%A5%E8%AF%86%E7%82%B9%E8%A1%A5%E6%BC%8F%E7%B3%BB%E5%88%97%EF%BC%882%EF%BC%89/","excerpt":"å­—ç¬¦ä¸²æ¨¡æ¿ç›¸ä¿¡å¤§å®¶ç”¨çš„æŒºå¤šäº†ï¼Œè¿™é‡Œä¸èµ˜è¿°ï¼Œä»Šå¤©è§£é”å­—ç¬¦ä¸²æ¨¡æ¿çš„å¦ä¸€ä¸ªåŠŸèƒ½ï¼Œæ ‡ç­¾æ¨¡æ¿ï¼ˆTagged Templateï¼‰","text":"å­—ç¬¦ä¸²æ¨¡æ¿ç›¸ä¿¡å¤§å®¶ç”¨çš„æŒºå¤šäº†ï¼Œè¿™é‡Œä¸èµ˜è¿°ï¼Œä»Šå¤©è§£é”å­—ç¬¦ä¸²æ¨¡æ¿çš„å¦ä¸€ä¸ªåŠŸèƒ½ï¼Œæ ‡ç­¾æ¨¡æ¿ï¼ˆTagged Templateï¼‰ å¯ä½œä¸ºä¼ å‚ç”¨æ ‡ç­¾æ¨¡æ¿å¯ç”¨äºä¼ å‚ï¼Œå°±è¡Œæ™®é€šå‡½æ•°ä¸€æ ·æ¥æ”¶å‚æ•°ï¼Œè¯·çœ‹ç¤ºä¾‹ä»£ç ï¼š 12345678910const custom = (strings, ...placeholder) =&gt; &#123; console.log(strings) console.log(placeholder)&#125;const firstName = &#x27;å‘µå‘µ&#x27;const hobby = &#x27;ç‚¹èµ&#x27;// è°ƒç”¨æ—¶æ”¹ä¸ºæ ‡ç­¾æ¨¡æ¿ä¼ å‚ï¼Œä¸ç”¨æ™®é€šå‡½æ•°çš„()ä¼ å‚custom`my name is $&#123;firstName&#125;, my hobby is $&#123;hobby&#125;` ç›´æ¥åœ¨æ§åˆ¶å°æ‰§è¡Œåï¼Œä¼šå‘ç°ç»“æœå¦‚ä¸‹ï¼š 12[ &#x27;my name is &#x27;, &#x27;, my hobby is &#x27;, &#x27;&#x27; ][ &#x27;å‘µå‘µ&#x27;, &#x27;ç‚¹èµ&#x27; ] æˆ‘ä»¬å‘ç°æ ‡ç­¾æ¨¡æ¿å®é™…ä¸Šæ˜¯ä¸€ç§ç‰¹æ®Šå‡½æ•°ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•° @ç¬¬ä¸€ä¸ªå‚æ•° ï¼š é™¤äº†${}ä»¥å¤–çš„éƒ¨åˆ†å­—ç¬¦ä¸²éƒ¨åˆ†@ç¬¬äºŒä¸ªå‚æ•° ï¼š ${}é‡Œé¢çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨è§£æ„â€¦æ¥æ”¶æ‰€æœ‰${}çš„å‚æ•°ï¼Œå¦åˆ™åˆ™æŒ‰å½¢å‚ä¸€ä¸ªä¸ªæŒ‰é¡ºåºä¼ å…¥ å®é™…ä½œç”¨ä¸‹é¢ï¼Œæˆ‘ä»¬å°±è¿™ç§ç‰¹æ®Šå‡½æ•°çš„å®é™…ä½œç”¨ä¸¾2ä¸ªä¾‹å­ ç»™ç‰¹å®šæ–‡æœ¬æ·»åŠ æ ·å¼æ ‡ç­¾æ¨¡æ¿è¢«å‘æ˜å‡ºæ¥çš„æœ€ä¸»è¦ç›®çš„å°±æ˜¯æ‹¼æ¥HTMLå­—ç¬¦ä¸²çš„ï¼Œä¸‹é¢æˆ‘ä¸¾2ä¸ªä¾‹å­ï¼š ç”¨äºä¸€æ®µæ–‡å­—ä¸­æ·»åŠ HTMLæ ·å¼ï¼š 12345const a = (arr, ...placeholder) =&gt; arr.reduce((prev, cur, i) =&gt; prev + `&lt;span class=&quot;addColor&quot;&gt;$&#123;placeholder[i-1]&#125;&lt;/span&gt;`+ cur)console.log(a`my name is $&#123;firstName&#125;, my hobby is $&#123;hobby&#125;`)// my name is &lt;span class=&quot;addColor&quot;&gt;å‘µå‘µ&lt;/span&gt;, my hobby is &lt;span class=&quot;addColor&quot;&gt;ç‚¹èµ&lt;/span&gt; ç”¨äºæ ¡éªŒHTMLé‡Œçš„å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ç”¨æˆ·è¿›è¡ŒXSSæ”»å‡» 12345678910111213141516171819202122function filterMsg(data) &#123; let ret = data[0] // ç›´æ¥åˆ©ç”¨ function çš„ arguments å‚æ•°è¿›è¡Œæ‹¼æ¥ï¼š for (let i = 1; i &lt; arguments.length; i++) &#123; const arg = String(arguments[i]) ret += arg.replace(/&amp;/g, &quot;&amp;amp;&quot;) .replace(/&lt;/g, &quot;&amp;lt;&quot;) .replace(/&gt;/g, &quot;&amp;gt;&quot;) ret += data[i] &#125; return ret&#125;// ç”¨æˆ·è¾“å…¥ï¼šconst userInput = &#x27;&lt;script&gt;alert(&quot;123&quot;)&lt;/script&gt;&#x27;// è°ƒç”¨å¤„ï¼šconst safeMsg = filterMsg`&lt;div&gt;$&#123;userInput&#125; has been send&lt;/div&gt;`console.log(safeMsg)// è¾“å‡ºï¼š// &lt;div&gt;&amp;lt;script&amp;gt;alert(&quot;123&quot;)&amp;lt;/script&amp;gt; has been send&lt;/div&gt;","categories":[],"tags":[{"name":"ES","slug":"ES","permalink":"https://zyzy.info/tags/ES/"}]},{"title":"Symbolçš„ç†è§£â€”â€”ESçŸ¥è¯†ç‚¹è¡¥æ¼ç³»åˆ—ï¼ˆ1ï¼‰","slug":"ã€2021-05-11ã€‘Symbolçš„ç†è§£â€”â€”ESçŸ¥è¯†ç‚¹è¡¥æ¼ç³»åˆ—ï¼ˆ1ï¼‰","date":"2021-05-11T01:27:58.000Z","updated":"2021-10-14T03:42:59.911Z","comments":true,"path":"2021/05/11/ã€2021-05-11ã€‘Symbolçš„ç†è§£â€”â€”ESçŸ¥è¯†ç‚¹è¡¥æ¼ç³»åˆ—ï¼ˆ1ï¼‰/","link":"","permalink":"https://zyzy.info/2021/05/11/%E3%80%902021-05-11%E3%80%91Symbol%E7%9A%84%E7%90%86%E8%A7%A3%E2%80%94%E2%80%94ES%E7%9F%A5%E8%AF%86%E7%82%B9%E8%A1%A5%E6%BC%8F%E7%B3%BB%E5%88%97%EF%BC%881%EF%BC%89/","excerpt":"å¯¹äº Symbol çš„ç†è§£ï¼Œä¸€ç›´æ¯”è¾ƒé™Œç”Ÿï¼ŒåªçŸ¥é“ä»–æ˜¯ ES6 çš„è¯­æ³•è§„èŒƒï¼Œå…·ä½“æ¦‚å¿µï¼Œå¯å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„ Symbol æ–‡ç« ã€‚è¿™é‡Œæˆ‘å°±è‡ªå·±çš„ç†è§£å†™ï¼Œä¸è®²æ¦‚å¿µï¼Œå†™ä¸€ä¸ªå®¹æ˜“ç†è§£çš„demoï¼Œä»‹ç» Symbol çš„ä½œç”¨ã€‚","text":"å¯¹äº Symbol çš„ç†è§£ï¼Œä¸€ç›´æ¯”è¾ƒé™Œç”Ÿï¼ŒåªçŸ¥é“ä»–æ˜¯ ES6 çš„è¯­æ³•è§„èŒƒï¼Œå…·ä½“æ¦‚å¿µï¼Œå¯å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„ Symbol æ–‡ç« ã€‚è¿™é‡Œæˆ‘å°±è‡ªå·±çš„ç†è§£å†™ï¼Œä¸è®²æ¦‚å¿µï¼Œå†™ä¸€ä¸ªå®¹æ˜“ç†è§£çš„demoï¼Œä»‹ç» Symbol çš„ä½œç”¨ã€‚ ä¼ ç»Ÿobj keyå€¼çš„ç—›ç‚¹ä¸€ä¸ªäº¿ä¸‡å¯Œè±ªï¼Œæœ‰å‡ ä¸ªå„¿å­å’Œå¥³å„¿ï¼Œè¿˜æœ‰ä¸€ç§ç”Ÿå­ï¼Œå¦‚æœæ­¤æ—¶ï¼Œæˆ‘ä»¬ç›´æ¥è¿™æ ·å®šä¹‰è¿™ä¸ªäº¿ä¸‡å¯Œè±ªï¼š 12345let billionaire = &#123; son: [&#x27;son1&#x27;, &#x27;son2&#x27;, &#x27;son3&#x27;,], daughter: [&#x27;daughter1&#x27;, &#x27;daughter2&#x27;], son: &#x27;bastard&#x27;&#125; åœ¨æ§åˆ¶å°æˆ‘ä»¬ä¼šå‘ç°ï¼Œç§ç”Ÿå­bastard ä¼šç›´æ¥è¦†ç›–æ‰å‰é¢çš„sonï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸åˆé€‚çš„ äºæ˜¯ Symbol ä½œä¸ºESé‡ŒåŸå§‹çš„æ•°æ®ç±»å‹çš„ä½œç”¨å°±å‡ºç°äº† åˆ©ç”¨ Symbol æ·»åŠ ç§ç”Ÿå­, è§£å†³ç—›ç‚¹æ­£ç¡®çš„åšæ³•åº”è¯¥å¦‚ä¸‹ï¼Œå…ˆå®šä¹‰äº†å„¿å­å’Œå¥³å„¿ä»¬ï¼š 1234let billionaire = &#123; son: [&#x27;son1&#x27;, &#x27;son2&#x27;, &#x27;son3&#x27;,], daughter: [&#x27;daughter1&#x27;, &#x27;daughter2&#x27;]&#125; æŠŠç§ç”Ÿå­ son: &#39;bastard&#39; å•ç‹¬æŠ½å‡ºæ¥ï¼Œç”¨ Symbol å®šä¹‰ï¼Œä»¥ä¸‹æœ‰3ç§å®šä¹‰æ–¹æ³•ï¼š 1234567891011121314const son = Symbol(&#x27;son&#x27;)// 1.billionaire[son] = &#x27;bastard&#x27;// 2.let billionaire = &#123; son: [&#x27;son1&#x27;, &#x27;son2&#x27;, &#x27;son3&#x27;,], daughter: [&#x27;daughter1&#x27;, &#x27;daughter2&#x27;], [son] : &#x27;bastard&#x27;&#125;// 3. Object.defineProperty(billionaire, son, &#123; value: &#x27;bastard&#x27; &#125;) è‡³æ­¤ï¼ŒSymbol çš„ä½œç”¨å¾ˆæ˜ç¡®äº†ï¼Œ ç”±äº JS çš„ obj keyå€¼ä¸ºå­—ç¬¦ä¸²ï¼Œä¸ºäº†é¿å… JS çš„ obj ä¸­å±æ€§åå­—çš„å†²çªè€Œäº§ç”Ÿ ç§ç”Ÿå­èº«ä»½ç¥ç§˜ï¼Œæ™®é€šnewï¼Œ. ç­‰æ–¹æ³•å¯¹å…¶æ— æ•ˆï¼Œåªæœ‰äº¿ä¸‡å¯Œç¿è‡ªå·±çŸ¥é“ç”±äº Symbol æ˜¯åŸå§‹ç±»å‹ï¼Œæ²¡æœ‰æ„é€ å‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨ new å…³é”®å­— ä¹Ÿä¸èƒ½ç”¨ . è¿ç®—å°†å…¶ç‚¹å‡ºæ¥ï¼š ç§ç”Ÿå­çš„èº«ä»½ç¡®è®¤å¦‚ä½•å¾—åˆ°ä¿éšœï¼Ÿä½œä¸ºäº¿ä¸‡å¯Œè±ªçš„ç§ç”Ÿå­ï¼Œåªæœ‰äº¿ä¸‡å¯Œè±ªè‡ªå·±ä¸€ä¸ªäººçŸ¥é“å…¶èº«ä»½ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ç”¨æ™®é€šæ–¹æ³•æ˜¯æ‰¾ä¸åˆ°è¿™ä¸ªç§ç”Ÿå­çš„ï¼š è€Œç§ç”Ÿå­æœ‰ç‹¬ç‰¹çš„æ–¹æ³•èƒ½å¾—åˆ°ç¡®è®¤ï¼ŒSymbol ä¸ºæˆ‘ä»¬æä¾›äº†å‡ ç§æ–¹æ³• Object.getOwnPropertySymbols()1234const querySon = Object.getOwnPropertySymbols(billionaire)console.log(querySon)// [Symbol(son)] å¤šä¸ªç§ç”Ÿå­äº¿ä¸‡å¯Œè±ªä¹Ÿå¯èƒ½æœ‰ä¸æ­¢ä¸€ä¸ªç§ç”Ÿå­ï¼Œæ¯”å¦‚å’Œ â€˜çŸ¥å·±å°ç§˜â€™ ç”Ÿäº†ä¸€ä¸ªç§ç”Ÿå­ï¼Œå’Œ â€˜çµé­‚ä¼´ä¾£â€™ åˆç”Ÿäº†ä¸€ä¸ªç§ç”Ÿå­ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç”¨ Symbol.for() å®šä¹‰: 123456const bastard1 = Symbol.for(&#x27;çŸ¥å·±å°ç§˜&#x27;)billionaire[bastard1] = &#x27;çŸ¥å·±å°ç§˜å„¿å­1&#x27;const bastard2 = Symbol.for(&#x27;çµé­‚ä¼´ä¾£&#x27;)billionaire[bastard2] = &#x27;çµé­‚ä¼´ä¾£å„¿å­1&#x27;console.log(billionaire) 123456&#123; son: [ &#x27;son1&#x27;, &#x27;son2&#x27;, &#x27;son3&#x27; ], daughter: [ &#x27;daughter1&#x27;, &#x27;daughter2&#x27; ], [Symbol(çŸ¥å·±å°ç§˜)]: &#x27;çŸ¥å·±å°ç§˜å„¿å­1&#x27;, [Symbol(çµé­‚ä¼´ä¾£)]: &#x27;çµé­‚ä¼´ä¾£å„¿å­1&#x27;&#125; Symbol keyå€¼åŒåæ—¶ï¼Œå…¶ value ä¹Ÿèƒ½è¢«è¦†ç›–æ‰å¦‚æœ â€˜çµé­‚ä¼´ä¾£â€™ åˆç”Ÿå¤šäº†ä¸€ä¸ªç§ç”Ÿå­ â€˜çµé­‚ä¼´ä¾£å„¿å­2â€™ ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ 1234const bastard3 = Symbol.for(&#x27;çµé­‚ä¼´ä¾£&#x27;)billionaire[bastard3] = &#x27;çµé­‚ä¼´ä¾£å„¿å­2&#x27;console.log(billionaire) ç›´æ¥æ‰“å°å‡ºæ¥ï¼Œä¼šå‘ç° value å€¼ â€˜çµé­‚ä¼´ä¾£å„¿å­2â€™ è¦†ç›–æ‰äº† â€˜çµé­‚ä¼´ä¾£å„¿å­1â€™ 123456&#123; son: [ &#x27;son1&#x27;, &#x27;son2&#x27;, &#x27;son3&#x27; ], daughter: [ &#x27;daughter1&#x27;, &#x27;daughter2&#x27; ], [Symbol(çŸ¥å·±å°ç§˜)]: &#x27;çŸ¥å·±å°ç§˜å„¿å­1&#x27;, [Symbol(çµé­‚ä¼´ä¾£)]: &#x27;çµé­‚ä¼´ä¾£å„¿å­2&#x27;&#125; bastard2 å’Œ bastard3 éƒ½æ˜¯Symbolå€¼ï¼Œå®ƒä»¬éƒ½æ˜¯ç”±åŒæ ·å‚æ•°çš„ Symbol.for æ–¹æ³•ç”Ÿæˆçš„keyï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯ä»æ˜¯åŒä¸€ä¸ªå€¼: 12console.log(bastard2 === bastard3)// true æŸ¥è¯¢æ‰€æœ‰å„¿å¥³ï¼ŒåŒ…æ‹¬ç§ç”Ÿå­çš„Keyå€¼ï¼šReflect.ownKeys()ä¼šä»¥ä¸€ä¸ªæ•°ç»„è¿”å›æ‰€æœ‰ Key å€¼ï¼ŒåŒ…æ‹¬ Symbol Key 12console.log(Reflect.ownKeys(billionaire))// [ &#x27;son&#x27;, &#x27;daughter&#x27;, Symbol(çŸ¥å·±å°ç§˜), Symbol(çµé­‚ä¼´ä¾£) ] Symbol.for() å’Œ Symbol() ç”Ÿæˆçš„Keyå€¼æœ‰ä½•ä¸åŒSymbol.for() ä¼šè¢«ç™»è®°åœ¨å…¨å±€ç¯å¢ƒä¸­ä¾›æœç´¢ï¼Œè€Œ Symbol() å°±ä¸ä¼šï¼Œæˆ‘ä»¬æ”¹åŠ¨ç§ç”Ÿå­ä¸º Symbol() ç”Ÿæˆï¼Œå¦‚ï¼š 12345678910const bastard1 = Symbol.for(&#x27;çŸ¥å·±å°ç§˜&#x27;)billionaire[bastard1] = &#x27;çŸ¥å·±å°ç§˜å„¿å­1&#x27;const bastard2 = Symbol(&#x27;çµé­‚ä¼´ä¾£&#x27;)billionaire[bastard2] = &#x27;çµé­‚ä¼´ä¾£å„¿å­1&#x27;console.log(bastard1, Symbol.keyFor(bastard1))console.log(bastard2, Symbol.keyFor(bastard2))// Symbol(çŸ¥å·±å°ç§˜) çŸ¥å·±å°ç§˜// Symbol(çµé­‚ä¼´ä¾£) undefined æ¢å¥è¯è¯´ï¼ŒSymbol.for() æ¯æ¬¡ç”Ÿæˆå‰ï¼Œä¼šæ£€æŸ¥å…¨å±€ç¯å¢ƒä¸­æ˜¯å¦å­˜åœ¨è¯¥Keyï¼›Symbol() åˆ™ä¸ä¼šï¼Œæ¯æ¬¡è°ƒç”¨ä¼šæ¯æ¬¡éƒ½ç”Ÿæˆ 12345console.log(Symbol.for(&#x27;a&#x27;) === Symbol.for(&#x27;a&#x27;))// trueconsole.log(Symbol(&#x27;a&#x27;) === Symbol(&#x27;a&#x27;))// false","categories":[],"tags":[{"name":"ES","slug":"ES","permalink":"https://zyzy.info/tags/ES/"}]},{"title":"è„±ç¦»è„šæ‰‹æ¶webpacké…åˆ¶React+typescripté¡¹ç›®ï¼ˆäºŒï¼‰","slug":"ã€2021-05-04ã€‘è„±ç¦»è„šæ‰‹æ¶webpacké…åˆ¶React-typescripté¡¹ç›®ï¼ˆäºŒï¼‰","date":"2021-05-08T06:12:05.000Z","updated":"2021-10-14T03:42:59.911Z","comments":true,"path":"2021/05/08/ã€2021-05-04ã€‘è„±ç¦»è„šæ‰‹æ¶webpacké…åˆ¶React-typescripté¡¹ç›®ï¼ˆäºŒï¼‰/","link":"","permalink":"https://zyzy.info/2021/05/08/%E3%80%902021-05-04%E3%80%91%E8%84%B1%E7%A6%BB%E8%84%9A%E6%89%8B%E6%9E%B6webpack%E9%85%8D%E5%88%B6React-typescript%E9%A1%B9%E7%9B%AE%EF%BC%88%E4%BA%8C%EF%BC%89/","excerpt":"è¿™èŠ‚ä¼šç€é‡ä»‹ç»TSçš„é…ç½®ï¼Œè¿™ä¸ªæ˜¯å¯¹åº”çš„ repo","text":"è¿™èŠ‚ä¼šç€é‡ä»‹ç»TSçš„é…ç½®ï¼Œè¿™ä¸ªæ˜¯å¯¹åº”çš„ repo å®‰è£…jsx è¯­æ³•é‡Œå·²æ”¯æŒäº† TS, è¦å…ˆå®‰è£…ä»¥ä¸‹ä¸¤ä¸ªåº“: 1yarn add @types/react @types/react-dom React TSçš„ä¸‰ç§æ–¹æ¡ˆ1. awesome-typescript-loader æ–¹æ¡ˆ è¿™ç§ä¸å»ºè®®, å› ä¸ºè¯¥æ’ä»¶ä½œè€…å·²ç»å¾ˆä¹…ä¸æ›´æ–°äº†, ä¸”æœ‰äº›æ£€æŸ¥ä¸å…¨é¢ 2. ts-loader + fork-ts-checker-webpack-plugin æ–¹æ¡ˆ webpack ç¼–è¯‘ä¼šé€šè¿‡æœ¬åœ°çš„ typescript , æ‰€ä»¥æœ¬åœ°å¿…é¡»å®‰è£… typescript, æœ¬åœ° typescript ä¼šè°ƒç”¨ tsconfig.json æ–‡ä»¶ æ¯æ¬¡æ–‡ä»¶æ”¹åŠ¨æ—¶, ts-loader éƒ½ä¼šè¿›è¡Œè½¬ç§»å’Œç±»å‹æ£€æŸ¥, å½“æ–‡ä»¶å¤šæ—¶, é€Ÿåº¦ä¼šå˜æ…¢ fork-ts-checker-webpack-plugin, åˆ©ç”¨è¯¥æ’ä»¶å¼€è¾Ÿä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹å»æ‰§è¡Œç±»å‹æ£€æŸ¥, ä¼šæé«˜ webpack çš„ç¼–è¯‘é€Ÿåº¦. è¯¥æ’ä»¶æœ‰æœ€ä½å®‰è£…è¦æ±‚: Node.js 6.11.5ï¼Œwebpack 4ï¼ŒTypeScript 2.1 å’Œå¯é€‰çš„ ESLint 6ï¼ˆå…¶æœ¬èº«è¦æ±‚æœ€ä½ Node.js 8.10.0ï¼‰ å…ˆå®‰è£…ä¸Šè¿°lib 1yarn add -D typescript ts-loader fork-ts-checker-webpack-plugin tsconfig.json æ–‡ä»¶é…ç½®æœ€ä¸»è¦æ˜¯ä»¥ä¸‹ä¸¤é¡¹é…ç½®ï¼š 123456789&#123; &quot;compilerOptions&quot;: &#123; &quot;jsx&quot;: &quot;preserve&quot;, &quot;moduleResolution&quot;: &quot;node&quot;, // &quot;module&quot;: &quot;ESNEXT&quot;, &quot;target&quot;: &quot;es6&quot;, // &quot;esModuleInterop&quot;: true &#125;,&#125; jsx å‚æ•°æœ‰3ä¸ªï¼Œåˆ†åˆ«æ˜¯&#39;react&#39;ï¼Œ&#39;preserve&#39;ï¼Œ&#39;react-native&#39; &#39;react&#39; æ¨¡å¼ä¸‹ï¼Œts ä¼šå°† tsx ç¼–è¯‘æˆ jsx åå†å°† jsx ç¼–è¯‘æˆ js &#39;preserve&#39; å’Œ &#39;react-native&#39; æ¨¡å¼ä¸‹ï¼šTS ä¼šå°† tsx ç¼–è¯‘æˆ jsx åï¼Œä¸å†å°† jsx ç¼–è¯‘æˆ jsï¼Œä¿ç•™ jsx ã€‚ä¿ç•™ jsx æ—¶ï¼Œå°±éœ€è¦åœ¨webpack.config.js - module - ts-loader çš„å‰é¢åŠ ä¸Š babel-loader å»å¤„ç† jsxè¯­æ³• &quot;moduleResolution&quot; é¡»é…ç½®ä¸º &quot;node&quot;ï¼Œ å¦åˆ™ä¼šæŠ¥é”™å¦‚ä¸‹ webpack.config.js æ–‡ä»¶é…ç½®1234567891011121314151617181920212223242526272829303132333435const ForkTsCheckerWebpackPlugin = require(&#x27;fork-ts-checker-webpack-plugin&#x27;)module.export = &#123; ... module: &#123; rules: [ &#123; test: /\\.(jsx?)$/, exclude: /node_modules/, loader: &#x27;babel-loader&#x27;, options: &#123; cacheDirectory: true, cacheCompression: false &#125; &#125;, &#123; test: /\\.(tsx?)$/, exclude: /node_modules/, use: [ &#x27;babel-loader&#x27;, // ä¸Šé¢çš„ tsconfig.json çš„ compilerOptions.jsx å€¼ä¸º preserveï¼Œè¿™é‡ŒåŠ ä¸Š abel-loader è½¬è¯‘ jsx &#123; loader: &#x27;ts-loader&#x27;, options: &#123; // disable type checker - we will use it in fork plugin transpileOnly: true, &#125;&#125; ]&#125;, ... ] &#125;, plugins: [ new HtmlWebpackPlugin(&#123; template: &quot;./src/index.html&quot;, inject: true, &#125;), // fork ä¸€ä¸ªè¿›ç¨‹è¿›è¡Œæ£€æŸ¥ï¼š new ForkTsCheckerWebpackPlugin() ], &#125; 3. @babel/preset-typescript æ–¹æ¡ˆ æ¯”è¾ƒè½»çš„æ–¹æ¡ˆ, ç›´æ¥é€šè¿‡ babel-loader çš„æ’ä»¶è¿›è¡Œè½¬è¯‘, æœ¬åœ°æ— é¡»å®‰è£… typescript , å› æ­¤ä¸ä¼šå»åšç±»å‹æ£€æŸ¥ åœ¨ tsconfig.json é‡Œé…ç½®ååœ¨æ§åˆ¶å°æç¤ºè¯­æ³•é”™è¯¯, ä½†ä¸åšå¼ºåˆ¶æ€§æ£€æŸ¥, å¦‚æœå†™æ³•ä¸ä¸¥æ ¼, é¡¹ç›®ä¹Ÿä¸ä¼šç¼–è¯‘ä¸é€šè¿‡ è¿™ç§æ–¹æ¡ˆç›¸æ¯”èµ·ä¸Šä¸€ç§æ–¹æ¡ˆå°‘äº†ç±»å‹æ£€æŸ¥, å¦‚æœè¿˜æƒ³åšç±»å‹æ£€æŸ¥, é¡»è¿›è¡Œé¢å¤–æœ¬åœ°å®‰è£…typescript , ä¸”è¿›è¡Œé¢å¤–å³é…ç½®, è¿è¡Œ tsc çš„å‘½ä»¤ 1yarn add -D @babel/preset-typescript babel.config.js é‡Œå¢åŠ è¯¥æ’ä»¶: 12345const presets = [ ... &#x27;@babel/preset-typescript&#x27; ... ] webpack.config.js é‡Œç›¸åº”çš„ module - rules è¦åšç›¸åº”æ”¹åŠ¨: 123rules: [ &#123; test: /\\.(jsx?|tsx?)$/, exclude: /node_modules/, use: [&#x27;babel-loader&#x27;] &#125;,] ä»¥ä¸Šé…ç½®, å°±èƒ½é¡ºåˆ©çš„å†™å‡º ts è¯­æ³•äº†, å¦‚:app.tsx 123456789101112131415161718192021import React, &#123; Component, FC &#125; from &#x27;react&#x27;import ReactDOM from &#x27;react-dom&#x27;interface aProps &#123; data: string&#125;const A: React.FC&lt;aProps&gt; = (&#123;data&#125;) =&gt; &#123; return &lt;div&gt; &#123;data&#125; &lt;/div&gt;&#125;export default class App extends Component &#123; render() &#123; return &lt;div&gt; &lt;A data=&#x27;data from App&#x27; /&gt; &lt;/div&gt; &#125;&#125;ReactDOM.render(&lt;App /&gt;, document.getElementById(&#x27;root&#x27;)) é¢å¤–å¤šåŠ ç›‘æµ‹tscç¼–è¯‘ æœ¬åœ°åº”é¢å¤–å®‰è£… typescript è¯­æ³•åŠŸèƒ½ï¼š 1yarn add -D typescript ç›´æ¥ tsc --watch ç›‘å¬è¿è¡Œ ä¹Ÿå¯ä»¥ script é‡Œå¢åŠ ä¸€ä¸ªå‘½ä»¤ä¸“é—¨ç”¨äºç›‘å¬ï¼š 123&#123; &quot;ts-chk&quot;: &quot;tsc --watch&quot;&#125; tsconfig.json 12345678910&#123; &quot;compilerOptions&quot;: &#123; // ä¸ç”Ÿæˆç¼–è¯‘æ–‡ä»¶ï¼Œåªåšç±»å‹æ£€æŸ¥ï¼š &quot;noEmit&quot;: true, // jsæ¨¡å—å¯¼å…¥æ–¹å¼ä¸åštsçš„æ£€æŸ¥ï¼š &quot;esModuleInterop&quot;: true, // ä½¿å…¶è¾¨è®¤jsxè¯­æ³•ï¼Œéœ€é‡å¯tscç›‘å¬ï¼š &quot;jsx&quot;: &quot;preserve&quot;, &#125;&#125; å…¶ä¸­ï¼Œ&quot;esModuleInterop&quot;: true æ˜¯ç”±äºTSçš„æ¨¡å—å¯¼å…¥æ–¹å¼å’ŒJSä¸åŒï¼Œå¦‚æœå»æ‰ä¼šæŠ¥ä»¥ä¸‹é”™è¯¯ï¼š æŒ‰ç…§å…¶æç¤ºçš„é”™è¯¯ TSçš„å¯¼å…¥è§„åˆ™ï¼Œè¦æ”¹æˆè¿™æ ·ï¼Œè¿™æ˜¾ç„¶ä¸ç¬¦åˆå¹³æ—¶çš„ä¹ æƒ¯ï¼Œ 12import * as React from &#x27;react&#x27;import * as ReactDOM from &#x27;react-dom&#x27; å…³äºæ¨¡å—å¯¼å…¥æ–¹å¼å¯ä»¥å‚è€ƒçŸ¥ä¹çš„è¿™ç¯‡æ–‡ç« ","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://zyzy.info/tags/React/"},{"name":"Webpack","slug":"Webpack","permalink":"https://zyzy.info/tags/Webpack/"},{"name":"Babel","slug":"Babel","permalink":"https://zyzy.info/tags/Babel/"},{"name":"Type Script","slug":"Type-Script","permalink":"https://zyzy.info/tags/Type-Script/"}]},{"title":"è„±ç¦»è„šæ‰‹æ¶webpacké…åˆ¶React+typescripté¡¹ç›®ï¼ˆä¸€ï¼‰","slug":"ã€2021-05-04ã€‘è„±ç¦»è„šæ‰‹æ¶webpacké…åˆ¶React+typescripté¡¹ç›®ï¼ˆä¸€ï¼‰","date":"2021-05-04T03:11:58.000Z","updated":"2021-10-14T03:42:59.911Z","comments":true,"path":"2021/05/04/ã€2021-05-04ã€‘è„±ç¦»è„šæ‰‹æ¶webpacké…åˆ¶React+typescripté¡¹ç›®ï¼ˆä¸€ï¼‰/","link":"","permalink":"https://zyzy.info/2021/05/04/%E3%80%902021-05-04%E3%80%91%E8%84%B1%E7%A6%BB%E8%84%9A%E6%89%8B%E6%9E%B6webpack%E9%85%8D%E5%88%B6React+typescript%E9%A1%B9%E7%9B%AE%EF%BC%88%E4%B8%80%EF%BC%89/","excerpt":"å¦‚é¢˜ã€‚ä»¥å‰é…è¿‡ï¼Œä½†æ²¡ç›´æ¥æ”¯æŒtsçš„ï¼Œè¿™æ¬¡å¤ä¹ ä¸€éè®°å½•ä¸‹æ¥ï¼Œwebpack è¿™ä¸œè¥¿ï¼Œåœ¨é¡¹ç›®å¼€å§‹æ—¶æ•´ä¸€æ¬¡åç»å¸¸å°±å¾ˆå°‘ç¢°äº†ï¼Œæ›´è¦åŠ¨æ‰‹è®°å½•ä¸‹æ¥ã€‚","text":"å¦‚é¢˜ã€‚ä»¥å‰é…è¿‡ï¼Œä½†æ²¡ç›´æ¥æ”¯æŒtsçš„ï¼Œè¿™æ¬¡å¤ä¹ ä¸€éè®°å½•ä¸‹æ¥ï¼Œwebpack è¿™ä¸œè¥¿ï¼Œåœ¨é¡¹ç›®å¼€å§‹æ—¶æ•´ä¸€æ¬¡åç»å¸¸å°±å¾ˆå°‘ç¢°äº†ï¼Œæ›´è¦åŠ¨æ‰‹è®°å½•ä¸‹æ¥ã€‚ åˆå§‹åŒ–é¡¹ç›®1yarn init -y åŸºç¡€å®‰è£…é…ç½® webpack 1yarn add webpack webpack-cli@3* -D babel ç”¨äºå¤„ç†ES6+çš„ä»£ç è½¬æ¢ 1yarn add -D @babel/core @babel/preset-env babel-loader é…ç½® less ã€ sass æˆ– postcss ç­‰æ ·å¼é¢„å¤„ç†è¯­è¨€ï¼Œè¿™é‡Œä¸‰ä¸ªéƒ½ç»™ä»–é…ä¸Šï¼šautoprefixer å¯ä»¥è‡ªåŠ¨åœ¨æ ·å¼ä¸­æ·»åŠ æµè§ˆå™¨å‚å•†å‰ç¼€ï¼Œé¿å…æ‰‹åŠ¨å¤„ç†æ ·å¼å…¼å®¹é—®é¢˜ 123456# lessyarn add -D css-loader less less-loader style-loader# sass# postcss é…ç½®å¤„ç† HTML æ’ä»¶ 1yarn add -D html-webpack-plugin é…ç½®çƒ­æ›´æ–°æ’ä»¶ 1yarn add -D webpack-dev-server æ–°å»º src/app.jsï¼Œ webpack.config.jsï¼Œ src/index.html 1mkdir src &amp;&amp; touch src/app.js &amp;&amp; touch webpack.config.js æ”¯æŒreactçš„é…ç½®åŸºç¡€ï¼š 1yarn add react-dom react æ”¯æŒå„ç§è¯­æ³•ï¼š@babel/preset-react â€”â€” æ”¯æŒ jsx è¯­æ³•@babel/plugin-proposal-class-properties â€”â€” æ”¯æŒ class è¯­æ³•@babel/plugin-proposal-decorators â€”â€” æ”¯æŒè£…é¥°å™¨è¯­æ³• 1yarn add -D @babel/preset-react @babel/plugin-proposal-class-properties @babel/plugin-proposal-decorators babel é…ç½®åŸæ¥çš„ .babelrc ä»…é€‚ç”¨äºç®€å•å•ä¸ªåŒ…çš„é™æ€é…ç½®ï¼Œ babel7+ ç‰ˆæœ¬é‡‡ç”¨ babel.config.jsï¼Œå¯ä»¥é™æ€ç¼–è¯‘ node_modules æˆ‘ä»¬å»ºè®®ä½¿ç”¨babel.config.jsæ ¼å¼ã€‚babelæœ¬èº«æ­£åœ¨ä½¿ç”¨å®ƒã€‚ å¯¹äºå¤§å‹é¡¹ç›®ï¼Œbabelå®˜æ–¹è¿˜æ˜¯å»ºè®®é‡‡ç”¨ babel.config.js æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œå› ä¸º .babelrc æ˜¯ä»æ¯ä¸€ä¸ªæ–‡ä»¶å‘ä¸ŠæŸ¥æ‰¾é…ç½®çš„ï¼Œbabel.config.jsåˆ™ä¸ä¼š 1touch babel.config.js ç¼–å†™å¦‚ä¸‹ï¼š 1234567891011121314module.exports = function (api) &#123; api.cache(true) const presets = [ [ &#x27;@babel/preset-env&#x27;, &#123; modules: false &#125; ], &#x27;@babel/preset-react&#x27;, ] const plugins = [ [&#x27;@babel/plugin-proposal-decorators&#x27;, &#123; legacy: true &#125;], [&#x27;@babel/plugin-proposal-class-properties&#x27;, &#123; loose: true &#125;] ] return &#123; presets, plugins &#125;&#125; å®˜æ–¹æ–‡æ¡£ webpack.config.jsåŸºç¡€é…åˆ¶é…ç½®å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728const path = require(&#x27;path&#x27;)const HtmlWebpackPlugin = require(&#x27;html-webpack-plugin&#x27;)module.exports = &#123; entry: &#x27;./src/app.js&#x27;, output: &#123; path: path.resolve(__dirname, &#x27;dist&#x27;), filename: &#x27;bundle.js&#x27;, library: &#x27;ReactByWebpack&#x27;, libraryTarget: &#x27;umd&#x27; &#125;, module: &#123; rules: [ &#123; test: /\\.(jsx?)$/, exclude: /node_modules/, use: [&#x27;babel-loader&#x27;] &#125;, &#123; test: /\\.less$/, exclude: /node_modules/, use: [&#x27;style-loader&#x27;, &#x27;css-loader&#x27;, &#x27;less-loader&#x27;]&#125; ] &#125;, plugins: [ new HtmlWebpackPlugin(&#123; template: &quot;./src/index.html&quot;, &#125;) ], devServer: &#123; contentBase: &#x27;./dist&#x27;, port: 8888, compress: true &#125;&#125; é”™è¯¯è§£å†³ ï¼šwebpack4 å’Œ webpack-cli4 å‘ç”Ÿå†²çª1234567891011121314151617181920212223242526yarn run v1.22.10$ webpack-dev-serverinternal/modules/cjs/loader.js:883 throw err; ^Error: Cannot find module &#x27;webpack-cli/bin/config-yargs&#x27;Require stack:- E:\\study\\code\\tech-blog-code\\2021\\11-webpack-react-ts-config\\node_modules\\webpack-dev-server\\bin\\webpack-dev-server.js at Function.Module._resolveFilename (internal/modules/cjs/loader.js:880:15) at Function.Module._load (internal/modules/cjs/loader.js:725:27) at Module.require (internal/modules/cjs/loader.js:952:19) at require (internal/modules/cjs/helpers.js:88:18) at Object.&lt;anonymous&gt; (E:\\study\\code\\tech-blog-code\\2021\\11-webpack-react-ts-config\\node_modules\\webpack-dev-server\\bin\\webpack-dev-server.js:65:1) at Module._compile (internal/modules/cjs/loader.js:1063:30) at Object.Module._extensions..js (internal/modules/cjs/loader.js:1092:10) at Module.load (internal/modules/cjs/loader.js:928:32) at Function.Module._load (internal/modules/cjs/loader.js:769:14) at Function.executeUserEntryPoint [as runMain] (internal/modules/run_main.js:72:12) &#123; code: &#x27;MODULE_NOT_FOUND&#x27;, requireStack: [ &#x27;E:\\\\study\\\\code\\\\tech-blog-code\\\\2021\\\\11-webpack-react-ts-config\\\\node_modules\\\\webpack-dev-server\\\\bin\\\\webpack-dev-server.js&#x27; ]&#125;error Command failed with exit code 1.info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command. è§£å†³åŠæ³•ï¼šä» webpack repo issue #1948 é‡Œå¯ä»¥æ‰¾åˆ°ç­”æ¡ˆ: If you upgrade webpack to 5. *, and webpack cli to 4. *, an error &gt; will be reported: Error: Cannot find module â€˜webpack-cli/bin/config-yargsâ€™ Temporary solution:Back off webpack cli to version 3. * for example: â€œwebpack-cliâ€: â€œ^ 3.3.12â€ é¡»è¦æŠŠ webpack-cli é™å›3åŠä»¥ä¸‹ç‰ˆæœ¬ 12yarn remove webpack-cliyarn add -D webpack-cli@3 é…ç½®å…¥å£æ–‡ä»¶1mkdir src &amp;&amp; touch src/app.js &amp;&amp; touch src/index.html app.js12345678910111213import React, &#123; Component &#125; from &#x27;react&#x27;import ReactDOM from &#x27;react-dom&#x27;const A = () =&gt; 123export default class App extends Component &#123; render() &#123; return &lt;div&gt; &lt;A/&gt; &lt;/div&gt; &#125;&#125;ReactDOM.render(&lt;App /&gt;, document.getElementById(&#x27;root&#x27;)) index.html123456789&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div id=&#x27;root&#x27;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; è¿è¡Œæ·»åŠ  script å¦‚ä¸‹ 1234&quot;scripts&quot;: &#123; &quot;dev&quot;: &quot;webpack-dev-server&quot;, &quot;build&quot;: &quot;webpack --mode=production&quot;&#125;, è‡³æ­¤ï¼Œæ™®é€šçš„ React é¡¹ç›®å·²é…ç½®æˆåŠŸï¼Œå¯ä»¥å°½æƒ…å†™ jsx äº†ï¼Œä¸‹ä¸€èŠ‚ä¼šç»§ç»­åŠ ä¸ŠTSé…ç½®","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://zyzy.info/tags/React/"},{"name":"Webpack","slug":"Webpack","permalink":"https://zyzy.info/tags/Webpack/"},{"name":"Babel","slug":"Babel","permalink":"https://zyzy.info/tags/Babel/"}]},{"title":"é€šè¿‡ReactHooksç›´æ¥æ“ä½œapiç¥åº“ï¼šReactQuery","slug":"ã€2021-04-26ã€‘é€šè¿‡ReactHooksç›´æ¥æ“ä½œapiç¥åº“ï¼šReactQuery","date":"2021-04-26T02:17:07.000Z","updated":"2021-10-14T03:42:59.910Z","comments":true,"path":"2021/04/26/ã€2021-04-26ã€‘é€šè¿‡ReactHooksç›´æ¥æ“ä½œapiç¥åº“ï¼šReactQuery/","link":"","permalink":"https://zyzy.info/2021/04/26/%E3%80%902021-04-26%E3%80%91%E9%80%9A%E8%BF%87ReactHooks%E7%9B%B4%E6%8E%A5%E6%93%8D%E4%BD%9Capi%E7%A5%9E%E5%BA%93%EF%BC%9AReactQuery/","excerpt":"React Query æ˜¯ä¸€ä¸ªä»¥react hooksä¸ºåŸºç¡€è¿›è¡Œå¼‚æ­¥è·å–ï¼Œç¼“å­˜å’Œæ›´æ”¹æ•°æ®çš„åº“ï¼Œreact queryä»“åº“æ–‡æ¡£åŸæ–‡æè¿°ï¼š Hooks for fetching, caching and updating asynchronous data in React æ¢è¨€ä¹‹ï¼Œæ˜¯ä¸€ä¸ªå¼‚æ­¥å¤„ç†æ•°æ®çš„åº“ã€‚è¿™ä¹ˆé‡è¦è€Œä¸”å¥½ç”¨çš„åº“å½“ç„¶è¦æ”¶å…¥å›Šä¸­ï¼ŒæŠŠä»–å­¦èµ·æ¥ï¼Œæœ¬ç¯‡ç€é‡ä»‹ç»æ•´ä¸ªé¡¹ç›®çš„æ„å»ºè¿‡ç¨‹ã€‚p.s è¯¥ç¯‡çš„åç«¯æœåŠ¡ç”¨è¿™ç¯‡ é…ç½®çš„æœåŠ¡ç«¯","text":"React Query æ˜¯ä¸€ä¸ªä»¥react hooksä¸ºåŸºç¡€è¿›è¡Œå¼‚æ­¥è·å–ï¼Œç¼“å­˜å’Œæ›´æ”¹æ•°æ®çš„åº“ï¼Œreact queryä»“åº“æ–‡æ¡£åŸæ–‡æè¿°ï¼š Hooks for fetching, caching and updating asynchronous data in React æ¢è¨€ä¹‹ï¼Œæ˜¯ä¸€ä¸ªå¼‚æ­¥å¤„ç†æ•°æ®çš„åº“ã€‚è¿™ä¹ˆé‡è¦è€Œä¸”å¥½ç”¨çš„åº“å½“ç„¶è¦æ”¶å…¥å›Šä¸­ï¼ŒæŠŠä»–å­¦èµ·æ¥ï¼Œæœ¬ç¯‡ç€é‡ä»‹ç»æ•´ä¸ªé¡¹ç›®çš„æ„å»ºè¿‡ç¨‹ã€‚p.s è¯¥ç¯‡çš„åç«¯æœåŠ¡ç”¨è¿™ç¯‡ é…ç½®çš„æœåŠ¡ç«¯ å‰ç«¯åŸºç¡€æœåŠ¡æ­å»ºåˆå§‹åŒ–é¡¹ç›®: 1npx create-react-app client &amp;&amp; cd client å®‰è£…ä¾èµ–å¹¶è¿è¡Œ:å…¶ä¸­ react-hook-from @rebass/forms @rebass/preset styled-components react-loader-spinner å‡ä¸ºæ ·å¼ç»„ä»¶ 12yarn add react-query react-router-dom react-hook-from @rebass/forms @rebass/preset styled-components react-loader-spinneryarn start ä¿®æ”¹src/client.js æ–‡ä»¶å¦‚ä¸‹: QueryClientProvideræ–‡æ¡£ 12345678910111213141516171819202122232425262728import React from &#x27;react&#x27;import ReactDOM from &#x27;react-dom&#x27;import &quot;react-loader-spinner/dist/loader/css/react-spinner-loader.css&quot;import App from &#x27;./App&#x27;import &#123; BrowserRouter &#125; from &quot;react-router-dom&quot;import &#123; ThemeProvider &#125; from &quot;styled-components&quot;import preset from &quot;@rebass/preset&quot;// æ ¸å¿ƒéƒ¨åˆ†: react-queryimport &#123; QueryClientProvider, QueryClient &#125; from &quot;react-query&quot;// å®ä¾‹åŒ–queryClientconst queryClient = new QueryClient()ReactDOM.render( &#123;/* Reactä¸¥æ ¼æ¨¡å¼ï¼Œå®˜æ–¹æ–‡æ¡£ï¼š https://react.html.cn/docs/strict-mode.html */&#125; &lt;React.StrictMode&gt; &#123;/* QueryClientProvider å¯ä½œä¸ºå…¨å±€å¯¹è±¡æ³¨å…¥ï¼Œç±»ä¼¼ react-redux */&#125; &lt;QueryClientProvider client=&#123;queryClient&#125;&gt; &#123;/* æ ·å¼ç»„ä»¶ï¼š */&#125; &lt;ThemeProvider theme=&#123;preset&#125;&gt; &lt;BrowserRouter&gt; &lt;App /&gt; &lt;/BrowserRouter&gt; &lt;/ThemeProvider&gt; &lt;/QueryClientProvider&gt; &lt;/React.StrictMode&gt;, document.getElementById(&#x27;root&#x27;)) åŸºç¡€è·¯ç”±æ¨¡å—åŠåŸºç¡€æ¶æ„ï¼šsrc/App.js åˆ©ç”¨ &#39;react-router-dom&#39; ä½œä¸ºè·¯ç”±çš„ç®¡ç†å™¨ï¼Œä¹Ÿæ˜¯reactå¸¸è§çš„ç»“æ„æ¨¡å¼ï¼š ä¿®æ”¹src/App.jsæ–‡ä»¶å¦‚ä¸‹: 12345678910111213141516import &#123; Switch, Route &#125; from &#x27;react-router-dom&#x27;import &#123; BooksList &#125; from &#x27;./BookList&#x27;import &#123; CreateBook &#125; from &#x27;./CreateBook&#x27;import &#123; UpdateBook &#125; from &#x27;./UpdateBook&#x27;function App() &#123; return &lt;&gt; &lt;Switch&gt; &lt;Route path=&#x27;/update-book/:id&#x27;&gt;&lt;UpdateBook/&gt;&lt;/Route&gt; &lt;Route path=&#x27;/create-book&#x27;&gt;&lt;CreateBook /&gt;&lt;/Route&gt; &lt;Route path=&#x27;/&#x27;&gt;&lt;BooksList /&gt;&lt;/Route&gt; &lt;/Switch&gt; &lt;/&gt;&#125;export default App; è·å–æ‰€æœ‰å›¾ä¹¦åˆ›å»º src/BookList/index.js å’Œ src/BookList/BookList.jsx ï¼š src/BookList/index.js: 1export * from &#x27;./BooksList&#x27; src/BookList/BookList.jsx: 123export const BooksList = () =&gt; &#123; return null&#125; åˆ›å»ºå›¾ä¹¦åˆ›å»º src/BookList/index.js å’Œ src/BookList/BookList.jsx : src/CreateBook/index.js: 1export * from &#x27;./CreateBook&#x27; src/CreateBook/CreateBook.jsx: 12345678910export const CreateBook = () =&gt; &#123; return null&#125;``` ### æ›´æ–°å›¾ä¹¦ åˆ›å»º `src/BookList/index.js` å’Œ `src/BookList/BookList.jsx` : `src/UpdateBook/index.js`:```jsexport * from &#x27;./UpdateBook&#x27; src/UpdateBook/UpdateBook.jsx: 123export const UpdateBook = () =&gt; &#123; return null&#125; åŸºæœ¬ç»“æ„ï¼š1234567891011src |_App.js |_BookList | |_index.js | |_BookList.jsx |_CreateBook | |_CreateBook.jsx | |_index.js |_UpdateBook |_UpdateBook.jsx |_index.js æ·»åŠ å¯¼èˆªæ æ ·å¼src/shared/NavBar.jsx: 12345678910111213141516171819202122import &#123; Flex, Box, Link as StyledLink, Image &#125; from &#x27;rebass/styled-components&#x27;import &#123; Link &#125; from &#x27;react-router-dom&#x27;import &#123; Container &#125; from &#x27;./Container&#x27;import logo from &#x27;./logo.svg&#x27;export const NavBar = () =&gt; &#123; return &lt;Flex bg=&quot;black&quot; color=&quot;white&quot; justifyContent=&quot;center&quot;&gt; &lt;Container&gt; &lt;Flex px=&#123;2&#125; width=&#x27;100%&#x27; alignItems=&#x27;center&#x27;&gt; &lt;Image size=&#123;20&#125; src=&#123;logo&#125; /&gt; &lt;Link component=&#123;StyledLink&#125; variant=&#x27;nav&#x27; to=&#x27;/&#x27;&gt; React Query CRUD &lt;/Link&gt; &lt;Box mx=&quot;auto&quot;/&gt; &lt;Link component=&#123;StyledLink&#125; variant=&#x27;nav&#x27; to=&#x27;/create-book&#x27;&gt; + Add new book &lt;/Link&gt; &lt;/Flex&gt; &lt;/Container&gt; &lt;/Flex&gt;&#125; src/shared/Container.jsx : 1234567import &#123; Box &#125; from &#x27;rebass/styled-components&#x27;export const Container = (&#123;children&#125;) =&gt; &#123; return &lt;Box sx=&#123;&#123; width: &quot;100%&quot;, maxWidth: 1024, mx: &quot;auto&quot; &#125;&#125;&gt; &#123;children&#125; &lt;/Box&gt;&#125; è¿”å› src/App.js æŠŠå¯¼èˆªæ åŠ ä¸Š: 123import &#123; NavBar &#125; from &#x27;./shared/NavBar&#x27;&lt;NavBar/&gt; åˆ›å»º api.js æ¥å£æ–‡ä»¶è·å–å¹¶æ•°æ®ï¼šé…åˆ¶æ–‡ä»¶ .envè·¯å¾„å¿…é¡»åœ¨æ ¹ç›®å½• 1REACT_APP_SERVER &#x3D; http:&#x2F;&#x2F;localhost:4800 src/api.js12345export const getAllBooks = async () =&gt; &#123; const response = await fetch(`$&#123;process.env.REACT_APP_SERVER&#125;/books`) if (!response.ok) throw new Error(&#x27;something wrong&#x27;) return response.json()&#125; ã€ useQuery ã€‘ åº”ç”¨ â€”â€” src/BookList.jsx ä¸­æŸ¥è¯¢æ‰€æœ‰å›¾ä¹¦123456789101112131415161718192021222324252627import &#123; useQuery &#125; from &#x27;react-query&#x27;import &#123; Flex &#125; from &#x27;rebass&#x27;import &#123; getAllBooks &#125; from &#x27;../api&#x27;import &#123; Container &#125; from &#x27;../shared/Container&#x27;import Loader from &#x27;react-loader-spinner&#x27;export const BooksList = () =&gt; &#123; // useQueryå·²ç»å‡†å¤‡å¥½äº†å„ç§çŠ¶æ€ï¼Œç›´æ¥è°ƒç”¨å³å¯ï¼š const &#123; data, error, isLoading, isError &#125; = useQuery(&#x27;books&#x27;, getAllBooks) if (isLoading) return &lt;Container&gt; &lt;Flex&gt; &lt;Loader type=&#x27;ThreeDots&#x27; color=&#x27;#ccc&#x27; height=&#123;30&#125; /&gt; &lt;/Flex&gt; &lt;/Container&gt; if (isError) return &lt;span&gt; Error: &#123;error.message&#125; &lt;/span&gt; return &lt;Container&gt; &lt;Flex flexDirection=&#x27;column&#x27; alignItems=&#x27;center&#x27;&gt; &#123; data.map((&#123;author, title, id&#125;) =&gt; &lt;div key=&#123;id&#125;&gt; &#123;author&#125; - &#123;title&#125; &lt;/div&gt; )&#125; &lt;/Flex&gt; &lt;/Container&gt;&#125; æ­¤æ—¶ç•Œé¢å¯çœ‹åˆ°æ•ˆæœï¼š æ¯æ¡è®°å½•å•ç‹¬æŠ½ç¦»åšæ¨¡å— src\\BookList\\BookItem.jsx123456789101112131415import &#123; Flex, Text, Button, Link as StyledLink &#125; from &#x27;rebass/styled-components&#x27;import &#123; Link &#125; from &#x27;react-router-dom&#x27;export const BookItem = (&#123; author, title, id &#125;) =&gt; &#123; return &lt;Flex p=&#123;3&#125; width=&quot;100%&quot; alignItems=&#x27;center&#x27;&gt; &lt;Link component=&#123;StyledLink&#125; to=&#123;`/update-book/$&#123;id&#125;`&#125; mr=&quot;auto&quot;&gt; &#123; title &#125; &lt;/Link&gt; &lt;Text&gt;&#123;author&#125;&lt;/Text&gt; &lt;Button ml=&quot;3&quot;&gt; remove &lt;/Button&gt; &lt;/Flex&gt;&#125; ä» src\\BookList\\BookList.jsx å¯¼å…¥å¹¶å–ä»£å…·ä½“è®°å½•çš„ä½ç½®12345import &#123; BookItem &#125; from &#x27;./BookItem&#x27;data.map((&#123;author, title, id&#125;) =&gt; &lt;BookItem author=&#123;author&#125; title=&#123;title&#125; id=&#123;id&#125; key=&#123;id&#125;/&gt;) çœ‹çœ‹é¡µé¢çš„æ•ˆæœï¼š ã€ useMutation ã€‘å’Œã€ queryClient ã€‘ çš„åº”ç”¨ â€”â€” åˆ é™¤å›¾ä¹¦åœ¨ src\\api.js å¢åŠ åˆ é™¤æ¥å£ï¼š1234567export const removeBook = async id =&gt; &#123; const response = await fetch(`$&#123;process.env.REACT_APP_API_SERVER&#125;/books/$&#123;id&#125;`, &#123; method: &#x27;DELETE&#x27; &#125;) if (!response.ok) throw new Error(response.json().message) return true&#125; ä¸ºåˆ é™¤å›¾ä¹¦ä¿®æ”¹ç•Œé¢å¹¶åœ¨ src\\BookList\\BookList.jsx é‡Œå¢åŠ ç›¸åº”çš„ useMutation å’Œ queryClient çš„å†™æ³•ï¼š 1234567891011121314import &#123; removeBook &#125; from &#x27;../api&#x27;const queryClient = useQueryClient()// å°† removeBook ç›´æ¥ä¼ å…¥ useMutationconst &#123; mutateAsync, isLoading &#125; = useMutation(removeBook)const remove = async () =&gt; &#123; await mutateAsync(id) queryClient.invalidateQueries(&#x27;books&#x27;)&#125;&lt;Button ml=&quot;3&quot; onClick=&#123;remove&#125;&gt; &#123; isLoading ? &lt;Loader type=&#x27;ThreeDots&#x27; color=&#x27;#fff&#x27; height=&#123;10&#125; /&gt;: &#x27;Remove&#x27; &#125;&lt;/Button&gt; queryClient.invalidateQueries() ç”¨äºæ¸…é™¤ç¼“å­˜å¹¶åˆ·æ–°é¡µé¢ï¼š æ¥è‡ªä¸­æ–‡å®˜æ–¹æ–‡æ¡£çš„è§£é‡Šï¼š å¯ä»¥æ™ºèƒ½åœ°å°†æŸ¥è¯¢æ ‡è®°ä¸ºè¿‡æ—¶çš„ï¼Œå¹¶ä½¿ä¹‹å¯ç”¨é‡æ–°è·å–æ•°æ®ï¼Œ ç®€è¨€ä¹‹ï¼ŒqueryClient.invalidateQueries(&#39;books&#39;) å¯æ¸…é™¤æ—§ â€˜booksâ€™ çš„æ˜¾ç¤ºç¼“å­˜ï¼Œå¹¶ç›´æ¥åˆ·æ–°æœ€æ–°çš„ â€˜booksâ€™ æ¥å£æ•°æ®ï¼Œå¦‚æœä¸åŠ ï¼Œé¡µé¢å°±ä¸ä¼šåˆ·æ–°ï¼Œéœ€è¦æ‰‹åŠ¨åˆ·æ–° å˜æ›´ä¸€æœ¬å›¾ä¹¦ä¿¡æ¯src\\api.js å¢åŠ è·å–ä¸€æœ¬ä¹¦çš„æ¥å£ï¼š12345678export const getBook = async (&#123; queryKey &#125;) =&gt; &#123; // useQuery ä¼ è¿‡æ¥çš„å‚æ•°ï¼š const [_key, &#123; id &#125;] = queryKey const response = await fetch(`$&#123;process.env.REACT_APP_API_SERVER&#125;/books/$&#123;id&#125;`) if (!response.ok) throw new Error(response.json().message) return response.json()&#125; src\\api.js å¢åŠ  updateBook æ¥å£ï¼š123456789101112export const updateBook = async (&#123; id, ...data &#125;) =&gt; &#123; const response = await fetch(`$&#123;process.env.REACT_APP_API_SERVER&#125;/books/$&#123;id&#125;`, &#123; method: &#x27;PUT&#x27;, headers: &#123; &#x27;Content-Type&#x27; : &#x27;application/json&#x27; &#125;, body: JSON.stringify(data) &#125;) if (!response.ok) throw new Error(response.json().message) return response.json()&#125; æ–°å»º src\\shared\\BookForm.jsx ç”¨åšæ›´æ–°å›¾ä¹¦çš„è¾“å…¥ç•Œé¢ï¼š12345678910111213141516171819202122232425import &#123; Box, Button &#125; from &#x27;rebass/styled-components&#x27;import &#123; Label, Input &#125; from &#x27;@rebass/forms&#x27;import &#123; useForm &#125; from &#x27;react-hook-form&#x27;import Loader from &#x27;react-loader-spinner&#x27;export const BookForm = (&#123; defaultValues, onFormSubmit, isLoading &#125;) =&gt; &#123; const &#123; register, handleSubmit &#125; = useForm(&#123; defaultValues &#125;) const onSubmit = handleSubmit( data =&gt; &#123; onFormSubmit(data) &#125;) return &lt;form onSubmit=&#123;onSubmit&#125;&gt; &lt;Box sx=&#123;&#123; marginBottom : 3 &#125;&#125;&gt; &lt;Label htmlFor=&quot;title&quot;&gt;Title&lt;/Label&gt; &lt;Input ref=&#123;register&#125; id=&#x27;title&#x27; name=&#x27;title&#x27; type=&#x27;text&#x27; /&gt; &lt;/Box&gt; &lt;Box sx=&#123;&#123; marginBottom : 3 &#125;&#125;&gt; &lt;Label htmlFor=&#x27;author&#x27;&gt;Author&lt;/Label&gt; &lt;Input ref=&#123;register&#125; id=&#x27;author&#x27; name=&#x27;author&#x27; type=&#x27;text&#x27; /&gt; &lt;/Box&gt; &lt;Button&gt; &#123; isLoading ? &lt;Loader type=&#x27;ThreeDots&#x27; color=&#x27;#fff&#x27; height=&#123;10&#125; /&gt; : &#x27;Submit&#x27; &#125; &lt;/Button&gt; &lt;/form&gt;&#125; src\\UpdateBook\\UpdateBook.jsx æ›´æ”¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940import Loader from &quot;react-loader-spinner&quot;import &#123; useMutation, useQuery &#125; from &quot;react-query&quot;import &#123; useHistory, useParams &#125; from &quot;react-router-dom&quot;import &#123; Box, Flex, Heading &#125; from &quot;rebass/styled-components&quot;import &#123; getBook, updateBook &#125; from &quot;../api&quot;import &#123; BookForm, Container &#125; from &quot;../shared&quot;export const UpdateBook = () =&gt; &#123; const &#123; id &#125; = useParams() const history = useHistory() // è·å–å•æœ¬ä¹¦çš„æ¥å£ï¼š const &#123; data, error, isLoading, isError &#125; = useQuery([&#x27;book&#x27;, &#123;id&#125;], getBook) // æ›´æ”¹å•æœ¬ä¹¦ useMutation const &#123; mutateAsync, isLoading: isMutating &#125; = useMutation(updateBook) // å°†æ•°æ®ä¼ ç»™åç«¯ï¼š const onFormSubmit = async data =&gt; &#123; await mutateAsync(&#123; ...data, id &#125;) history.push(&#x27;/&#x27;) &#125; if ( isLoading ) return &lt;Container&gt; &lt;Flex&gt; &lt;Loader type=&#x27;ThreeDots&#x27; color=&#x27;#ccc&#x27; height=&#123;30&#125; /&gt; &lt;/Flex&gt; &lt;/Container&gt; if ( isError ) return &lt;Container&gt; &lt;Flex py=&#x27;5&#x27; justifyContent=&#x27;center&#x27;&gt; Error: &#123;error.message&#125; &lt;/Flex&gt; &lt;/Container&gt; return &lt;Container&gt; &lt;Box sx=&#123;&#123; py: 3 &#125;&#125;&gt; &lt;Heading sx=&#123;&#123; marginBottom: 3 &#125;&#125;&gt;Update Book&lt;/Heading&gt; &lt;BookForm defaultValues=&#123;data&#125; onFormSubmit=&#123;onFormSubmit&#125; isLoading=&#123;isMutating&#125; /&gt; &lt;/Box&gt; &lt;/Container&gt;&#125; æ–°å»º src\\shared\\index.js å°†æ‰€æœ‰å…±ç”¨ç»„ä»¶å¯¼å‡ºï¼š 123export * from &#x27;./Container&#x27;export * from &#x27;./BookForm&#x27;export * from &#x27;./NavBar&#x27; çœ‹çœ‹é¡µé¢çš„æ•ˆæœï¼š æ–°å»ºä¸€æœ¬å›¾ä¹¦src\\api.js é‡Œæ·»åŠ 1234567891011export const createBook = async (data) =&gt; &#123; const response = await fetch(`$&#123;process.env.REACT_APP_API_SERVER&#125;/books/`, &#123; method: &#x27;POST&#x27;, headers: &#123; &#x27;Content-Type&#x27;: &#x27;application/json&#x27; &#125;, body: JSON.stringify(data) &#125;) if (!response.ok) throw new Error(response.json().message) return response.json()&#125; æ›´æ”¹åˆ›å»ºå›¾ä¹¦ç•Œé¢ src\\CreateBook.jsx å¦‚ä¸‹ï¼š12345678910111213141516171819202122import &#123; useMutation &#125; from &quot;react-query&quot;import &#123; useHistory &#125; from &quot;react-router-dom&quot;import &#123; Box, Heading &#125; from &quot;rebass&quot;import &#123; createBook &#125; from &quot;../api&quot;import &#123; BookForm, Container, &#125; from &#x27;../shared&#x27;export const CreateBook = () =&gt; &#123; const history = useHistory() const &#123; mutateAsync, isLoading &#125; = useMutation(createBook) const onFormSubmit = async data =&gt; &#123; await mutateAsync(data) history.push(&#x27;/&#x27;) &#125; return &lt;Container&gt; &lt;Box sx=&#123;&#123; py: 3 &#125;&#125;&gt; &lt;Heading sx=&#123;&#123; marginBottom: 3 &#125;&#125;&gt;Create New Book&lt;/Heading&gt; &lt;BookForm onFormSubmit=&#123;onFormSubmit&#125; isLoading=&#123;isLoading&#125; /&gt; &lt;/Box&gt; &lt;/Container&gt;&#125; çœ‹çœ‹é¡µé¢çš„æ•ˆæœï¼š","categories":[],"tags":[{"name":"React Query","slug":"React-Query","permalink":"https://zyzy.info/tags/React-Query/"}]},{"title":"SwaggerUIé€šè¿‡swagger-jsdocåœ¨nodeé‡Œçš„åº”ç”¨å’Œé…ç½®","slug":"ã€2021-04-25ã€‘SwaggerUIé€šè¿‡swagger-jsdocåœ¨nodeé‡Œçš„åº”ç”¨å’Œé…ç½®","date":"2021-04-25T00:48:17.000Z","updated":"2021-10-14T03:42:59.910Z","comments":true,"path":"2021/04/25/ã€2021-04-25ã€‘SwaggerUIé€šè¿‡swagger-jsdocåœ¨nodeé‡Œçš„åº”ç”¨å’Œé…ç½®/","link":"","permalink":"https://zyzy.info/2021/04/25/%E3%80%902021-04-25%E3%80%91SwaggerUI%E9%80%9A%E8%BF%87swagger-jsdoc%E5%9C%A8node%E9%87%8C%E7%9A%84%E5%BA%94%E7%94%A8%E5%92%8C%E9%85%8D%E7%BD%AE/","excerpt":"SwaggerUIï¼Œåœ¨Javaé‡Œåº”è¯¥æ˜¯å¸¸ç”¨å·¥å…·ï¼Œèƒ½æ ¹æ®apiæ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆç½‘é¡µç‰ˆçš„apiæ–‡æ¡£ç•Œé¢ï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ï¼Œå…¶å®ä»–æ”¯æŒå„ç§è¯­è¨€ï¼Œæœ¬ç¯‡åˆ†äº«ä¸€ä¸‹åœ¨nodeé‡Œçš„ç®€å•é…ç½®æ–¹æ³•ï¼Œé¡ºæ‰‹æ­å»ºäº†ä¸ªç®€å•çš„æœåŠ¡ã€‚ï¼ˆp.s. æœ¬ç¯‡åç»­æœ‰ç»­ç¯‡ï¼Œåˆ©ç”¨æœ¬ç¯‡çš„æœåŠ¡ï¼Œä»‹ç»ä¸€ä¸‹å‰ç«¯çš„çŠ¶æ€ç®¡ç†ç»„ä»¶React Queryçš„ç©æ³•ï¼Œé…åˆæœ¬ç¯‡æ­å»ºçš„æœåŠ¡ä½¿ç”¨ã€‚ï¼‰","text":"SwaggerUIï¼Œåœ¨Javaé‡Œåº”è¯¥æ˜¯å¸¸ç”¨å·¥å…·ï¼Œèƒ½æ ¹æ®apiæ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆç½‘é¡µç‰ˆçš„apiæ–‡æ¡£ç•Œé¢ï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ï¼Œå…¶å®ä»–æ”¯æŒå„ç§è¯­è¨€ï¼Œæœ¬ç¯‡åˆ†äº«ä¸€ä¸‹åœ¨nodeé‡Œçš„ç®€å•é…ç½®æ–¹æ³•ï¼Œé¡ºæ‰‹æ­å»ºäº†ä¸ªç®€å•çš„æœåŠ¡ã€‚ï¼ˆp.s. æœ¬ç¯‡åç»­æœ‰ç»­ç¯‡ï¼Œåˆ©ç”¨æœ¬ç¯‡çš„æœåŠ¡ï¼Œä»‹ç»ä¸€ä¸‹å‰ç«¯çš„çŠ¶æ€ç®¡ç†ç»„ä»¶React Queryçš„ç©æ³•ï¼Œé…åˆæœ¬ç¯‡æ­å»ºçš„æœåŠ¡ä½¿ç”¨ã€‚ï¼‰ åŸºæœ¬æ¶æ„åˆå§‹åŒ–é¡¹ç›®ï¼Œå®‰è£…ä¾èµ–: 123npm init -yyarn add express lowdb morgan nanoid cors swagger-jsdoc swagger-ui-expresstouch index.js index.js å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425const express = require(&quot;express&quot;);const cors = require(&quot;cors&quot;);const morgan = require(&quot;morgan&quot;);const low = require(&quot;lowdb&quot;);const PORT = process.env.PORT || 4800const FileSync = require(&quot;lowdb/adapters/FileSync&quot;)// ç”¨ db.json æ–‡ä»¶å……å½“æ•°æ®åº“: const adapter = new FileSync(&quot;db.json&quot;)const db = low(adapter)db.defaults(&#123; books: [] &#125;).write()const app = express()app.db = dbapp.use(cors())app.use(express.json())app.use(morgan(&quot;dev&quot;))app.listen(PORT, () =&gt; console.log(`the server run on port $&#123;PORT&#125;`)) è¯•ç€è¿è¡Œä¸€ä¸‹ï¼Œä¼šå‘ç°ç”Ÿæˆäº†ä¸€ä¸ª db.json æ–‡ä»¶ï¼Œæ€»ä½“ç›®å½•å¦‚ä¸‹ï¼š server |__node_modules/ |__db.json |__index.js |__package.json |__yarn.lock å»ºç«‹è·¯ç”±1mkdir route &amp;&amp; cd route &amp;&amp; touch books.js books.js å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445const express = require(&quot;express&quot;);const router = express.Router()const &#123; nanoid &#125; = require(&quot;nanoid&quot;);const idLength = 8router.get(&#x27;/&#x27;, (req, res) =&gt; &#123; const books = req.app.db.get(&#x27;books&#x27;) res.send(books)&#125;)router.get(&#x27;/:id&#x27;, (req, res) =&gt; &#123; const book = req.app.db.get(&#x27;books&#x27;).find(&#123; id: req.params.id &#125;).value() if (!book) res.send(404) res.send(book)&#125;)router.post(&#x27;/&#x27;, (req, res) =&gt; &#123; try &#123; const book = &#123; id: nanoid(idLength), ...req.body &#125; req.app.db.get(&#x27;books&#x27;).push(book).write() res.send(book) &#125;catch (error) &#123; return res.status(500).send(error) &#125;&#125;)router.put(&#x27;/:id&#x27;, (req, res) =&gt; &#123; try &#123; req.app.db.get(&#x27;books&#x27;).find(&#123; id: req.params.id &#125;).assign(req.body).write() res.send(req.app.db.get(&#x27;books&#x27;)).find(&#123;id: req.params.id&#125;) &#125;catch (error) &#123; return res.status(500).send(error) &#125;&#125;)router.delete(&#x27;/:id&#x27;, (req, res) =&gt; &#123; req.app.db.get(&#x27;books&#x27;).remove(&#123; id: req.params.id &#125;).write() res.sendStatus(200)&#125;)module.exports = router åº”ç”¨SwaggerUI:åœ¨ index.js é‡Œå¼•ç”¨ SwaggerUIï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š 12345678910111213141516171819202122const swaggerUI = require(&quot;swagger-ui-express&quot;);const swaggerJsDoc = require(&quot;swagger-jsdoc&quot;);const booksRouter = require(&quot;./route/books&quot;);const specs = swaggerJsDoc(&#123; definition: &#123; // å¿…é¡»å‚æ•°ï¼Œä¸å¡«åˆ™æ²¡æœ‰æƒé™ï¼Œå¡«çš„è¯ä¹Ÿåªæ”¯æŒ 3.0.n openapi: &quot;3.0.0&quot;, // ä¸€äº›æè¿°ï¼Œå¯é€‰ï¼š info: &#123; title: &quot;Library API&quot;, version: &quot;1.0.0&quot;, description: &quot;A simple Express Library API&quot; &#125;, servers: [&#123; url: &quot;http://localhost:4800&quot;&#125;], &#125;, apis: [&quot;./route/*.js&quot;]&#125;)app.use(&quot;/api-docs&quot;, swaggerUI.serve, swaggerUI.setup(specs))app.use(&#x27;/books&#x27;, booksRouter) å¯åœ¨ç•Œé¢çœ‹åˆ°ï¼š è‡ªåŠ¨ç”Ÿæˆapiæ–‡æ¡£é¡µé¢ï¼šå‚ç…§å…¶æ–‡æ¡£ï¼Œæ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯swagger-jsdocï¼Œä»–å°†å¤šè¡Œæ³¨é‡Šé‡Œçš„apié…ç½®è½¬æ¢ä¸ºé¡µé¢çš„æ–‡æ¡£é…ç½®ï¼Œæˆ‘ä»¬å°† route/books.js æ”¹å†™ä¸ºä»¥ä¸‹æ ¼å¼ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181/** * @swagger * components: * schemas: * Book: * type: object * required: * - title * - author * properties: * id: * type: string * description: The auto-generated id of the book * title: * type: string * description: The book title * author: * type: string * description: The book author * example: * id: d5fE_asz * title: The New Turing Omnibus * author: Alexander K. Dewdney *//** * @swagger * tags: * name: Books * description: The books managing API *//** * @swagger * /books: * get: * summary: Returns the list of all the books * tags: [Books] * responses: * 200: * description: The list of the books * content: * application/json: * schema: * type: array * items: * $ref: &#x27;#/components/schemas/Book&#x27; */router.get(&#x27;/&#x27;, (req, res) =&gt; &#123; const books = req.app.db.get(&#x27;books&#x27;) res.send(books)&#125;)/** * @swagger * /books/&#123;id&#125;: * get: * summary: Get the book by id * tags: [Books] * parameters: * - in: path * name: id * schema: * type: string * required: true * description: The book id * responses: * 200: * description: The book description by id * contents: * application/json: * schema: * $ref: &#x27;#/components/schemas/Book&#x27; * 404: * description: The book was not found */router.get(&#x27;/:id&#x27;, (req, res) =&gt; &#123; const book = req.app.db.get(&#x27;books&#x27;).find(&#123; id: req.params.id &#125;).value() if (!book) res.send(404) res.send(book)&#125;)/** * @swagger * /books: * post: * summary: Create a new book * tags: [Books] * requestBody: * required: true * content: * application/json: * schema: * $ref: &#x27;#/components/schemas/Book&#x27; * responses: * 200: * description: The book was successfully created * content: * application/json: * schema: * $ref: &#x27;#/components/schemas/Book&#x27; * 500: * description: Server Error */router.post(&#x27;/&#x27;, (req, res) =&gt; &#123; try &#123; const book = &#123; id: nanoid(idLength), ...req.body &#125; req.app.db.get(&#x27;books&#x27;).push(book).write() res.send(book) &#125;catch (error) &#123; return res.status(500).send(error) &#125;&#125;)/** * @swagger * /books/&#123;id&#125;: * put: * summary: Update the book by the id * tags: [Books] * parameters: * - in: path * name: id * schema: * type: string * required: true * description: The book id * requestBody: * required: true * content: * application/json: * schema: * $ref: &#x27;#/components/schemas/Book&#x27; * responses: * 200: * description: The Book was updated * content: * application/json: * schema: * $ref: &#x27;#/components/schemas/Book&#x27; */router.put(&#x27;/:id&#x27;, (req, res) =&gt; &#123; try &#123; req.app.db.get(&#x27;books&#x27;).find(&#123; id: req.params.id &#125;).assign(req.body).write() res.send(req.app.db.get(&#x27;books&#x27;)).find(&#123;id: req.params.id&#125;) &#125;catch (error) &#123; return res.status(500).send(error) &#125;&#125;)/** * @swagger * /books/&#123;id&#125;: * delete: * summary: Update the book by the id * tags: [Books] * parameters: * - in: path * name: id * schema: * type: string * required: true * description: The book id * responses: * 200: * description: The Book was deleted * 404: * description: The Book was not found */router.delete(&#x27;/:id&#x27;, (req, res) =&gt; &#123; req.app.db.get(&#x27;books&#x27;).remove(&#123; id: req.params.id &#125;).write() res.sendStatus(200)&#125;)module.exports = router é‡è·‘æœåŠ¡ï¼Œå¯ä»¥å‘ç°ä»¥ä¸‹ç•Œé¢ï¼š swagger-jsdoc æ˜¯é€šè¿‡ openapi çš„3.0ç‰ˆæœ¬è¿›è¡Œçš„æ”¹åŠ¨ï¼Œä¼ ç»Ÿçš„ openapi æ˜¯é€šè¿‡ç‹¬ç«‹çš„ json æ–‡ä»¶å¯¹ swaggerè¿›è¡Œé…ç½®ï¼Œä¸åœ¨æœ¬ç¯‡è®¨è®ºèŒƒå›´ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹è¿™ç¯‡å›½å¤–çš„demo","categories":[],"tags":[{"name":"Swagger UI","slug":"Swagger-UI","permalink":"https://zyzy.info/tags/Swagger-UI/"},{"name":"åç«¯","slug":"åç«¯","permalink":"https://zyzy.info/tags/%E5%90%8E%E7%AB%AF/"},{"name":"Nodejs","slug":"Nodejs","permalink":"https://zyzy.info/tags/Nodejs/"},{"name":"swagger-jsdoc","slug":"swagger-jsdoc","permalink":"https://zyzy.info/tags/swagger-jsdoc/"}]},{"title":"æ— é™æ»šåŠ¨å’Œæ‡’åŠ è½½é€šè¿‡IntersectionObserverå’ŒReact_Hookså®ç°","slug":"ã€2021-04-23ã€‘æ— é™æ»šåŠ¨å’Œæ‡’åŠ è½½é€šè¿‡IntersectionObserverå’ŒReact_Hookså®ç°","date":"2021-04-23T01:05:33.000Z","updated":"2021-10-14T03:42:59.910Z","comments":true,"path":"2021/04/23/ã€2021-04-23ã€‘æ— é™æ»šåŠ¨å’Œæ‡’åŠ è½½é€šè¿‡IntersectionObserverå’ŒReact_Hookså®ç°/","link":"","permalink":"https://zyzy.info/2021/04/23/%E3%80%902021-04-23%E3%80%91%E6%97%A0%E9%99%90%E6%BB%9A%E5%8A%A8%E5%92%8C%E6%87%92%E5%8A%A0%E8%BD%BD%E9%80%9A%E8%BF%87IntersectionObserver%E5%92%8CReact_Hooks%E5%AE%9E%E7%8E%B0/","excerpt":"ç”¨React Hooksåšé¡¹ç›®æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œç‚’é¸¡å–œæ¬¢ï¼Œè¿™é‡Œç»“åˆ IntersectionObserver åŸç”Ÿjs apiåŠå„ç§hooksï¼Œåšä¸ªç®€å•çš„æ— é™æ»šåŠ¨+æ‡’åŠ è½½é¡µé¢ï¼Œå…³äº IntersectionObserverï¼Œ é˜®å¤§ç¥çš„è¿™ç¯‡åšå®¢æ–‡ç« é‡Œæœ‰éå¸¸è¯¦å°½çš„æè¿°ï¼ˆp.s. dataç”¨åˆ°æ•°æ®æ¥å£éœ€ç§‘å­¦ä¸Šç½‘ï¼‰","text":"ç”¨React Hooksåšé¡¹ç›®æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œç‚’é¸¡å–œæ¬¢ï¼Œè¿™é‡Œç»“åˆ IntersectionObserver åŸç”Ÿjs apiåŠå„ç§hooksï¼Œåšä¸ªç®€å•çš„æ— é™æ»šåŠ¨+æ‡’åŠ è½½é¡µé¢ï¼Œå…³äº IntersectionObserverï¼Œ é˜®å¤§ç¥çš„è¿™ç¯‡åšå®¢æ–‡ç« é‡Œæœ‰éå¸¸è¯¦å°½çš„æè¿°ï¼ˆp.s. dataç”¨åˆ°æ•°æ®æ¥å£éœ€ç§‘å­¦ä¸Šç½‘ï¼‰ åŸºç¡€æ¶æ„ ç”¨ create-react-app æ„å»ºé¡¹ç›®åè£… axiosï¼ŒApp.jsä¿®æ”¹å¦‚ä¸‹ï¼Œé¡µé¢å‘ˆç°å¦‚ä¸‹ç®€å•æ•ˆæœï¼Œå³åœ¨è¾“å…¥æ¡†è¾“å…¥æŸä¸€ä¹¦ç±å…³é”®å­—æ—¶ï¼Œä¼šå‡ºç°å¯¹åº”æ‰€æœ‰çš„ä¹¦ç±åˆ—è¡¨ï¼š 1234567891011const App = () =&gt; &#123; return &lt;div&gt; &lt;input type=&quot;text&quot;/&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Loading...&lt;/div&gt; &lt;div&gt;Error&lt;/div&gt; &lt;/div&gt;&#125; è‡ªå®šä¹‰ custom hooks ä½œä¸ºå¼‚æ­¥è¯·æ±‚æ•°æ®ï¼šæ ¹æ®hooksä¹ æƒ¯ï¼Œåå­—ç”¨useå¼€å¤´ï¼š 1234567891011121314151617181920import &#123; useState, useRef, useCallback &#125; from &#x27;react&#x27;/** * @params * input è¾“å…¥æ¡†è¾“å…¥éœ€è¦æŸ¥è¯¢çš„å­—æ®µ * pageNum é¡µç ï¼Œå¦‚æœé¡µé¢ä¸€é¡µå±•ç¤ºä¸ç©ï¼Œä¼šæŒç»­æ·»åŠ pageNum*/export const useBookSearch = (query, pageNum) =&gt; &#123; useEffect(() =&gt; &#123; axios(&#123; method: &#x27;GET&#x27;, url: &#x27;http://openlibrary.org/search.json&#x27;, params: &#123; q: query, page: pageNum &#125;, &#125;).then(res =&gt; &#123; // è¿œç¨‹è·å–æ•°æ®ï¼Œæš‚æ—¶æ§åˆ¶å°æ‰“å°ï¼š console.log(res.data) &#125;) &#125;, [query, pageNum]) return null&#125; åœ¨ App.js é‡Œå¼•å…¥è‡ªå®šä¹‰hooks 123456789101112const App = () =&gt; &#123; useBookSearch(query, pageNum) return &lt;div&gt; &lt;input type=&quot;text&quot;/&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Loading...&lt;/div&gt; &lt;div&gt;Error&lt;/div&gt; &lt;/div&gt;&#125; å®ç°åŠ¨æ€æ•ˆæœ ç»§ç»­æ”¹é€  App.js query å’Œ pageNumä¸¤ä¸ªå‚æ•°éœ€è¦åœ¨æœ¬é¡µè¿›è¡Œå˜åŠ¨ï¼Œäºæ˜¯åŠ å…¥ useState é’©å­ 1234567891011121314151617181920212223import &#123; useState, useRef, useCallback &#125; from &#x27;react&#x27;const App = () =&gt; &#123; const [query, setInput] = useState(&#x27;&#x27;) const [pageNum, setPageNum] = useState(1) const handleSearch = e =&gt; &#123; setInput(e.target.value) // é‡æ–°è¾“å…¥æŸ¥è¯¢å­—æ®µåï¼Œé¡µæ•°é‡æ–°è®¾ç½®ä¸º1ï¼š pageNum(1) &#125; useBookSearch(query, pageNum) return &lt;div&gt; &lt;input type=&quot;text&quot; onChange=&#123;handleSearch&#125;/&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Title&lt;/div&gt; &lt;div&gt;Loading...&lt;/div&gt; &lt;div&gt;Error&lt;/div&gt; &lt;/div&gt;&#125; query é€šè¿‡è¾“å…¥æ¡†æ”¹å˜ï¼Œä¼ é€’ç»™ useBookSearch(query, pageNum)ï¼Œæ§åˆ¶å°èƒ½çœ‹åˆ°è¯·æ±‚å›æ¥çš„æ•°æ®ï¼Œå¦‚ä¸‹æ¼”ç¤ºï¼Œä½†è¿™ç§è¯·æ±‚æ˜¯å®æ—¶çš„ï¼Œå³æ¯è¾“å…¥ä¸€ä¸ªå­—ç¬¦å°±ä¼šè¯·æ±‚ä¸€æ¬¡ï¼Œä¼šæµªè´¹æ€§èƒ½ï¼Œå¿…é¡»ä¼˜åŒ– useBookSearch ä¼˜åŒ–è¯·æ±‚æ€§èƒ½ï¼š axios æœ‰ä¸ªå‚æ•° CancelTokenï¼Œå¯å–æ¶ˆé‡å¤è¯·æ±‚ï¼Œåšå¦‚ä¸‹æ”¹åŠ¨ï¼š 123456789101112131415161718192021useEffect(() =&gt; &#123; setLoading(true) setError(false) // å®šä¹‰å–æ¶ˆå˜é‡ let cancel axios(&#123; method: &#x27;GET&#x27;, url: &#x27;http://openlibrary.org/search.json&#x27;, params: &#123; q: query, page: pageNum &#125;, // æ‰§è¡Œå–æ¶ˆå˜é‡ï¼š cancelToken: new axios.CancelToken(c =&gt; cancel = c) &#125;).then(res =&gt; console.log(res.data) ).catch(e =&gt; &#123; if (axios.isCancel(e)) return setError(true) &#125;) // æœ€åï¼ŒuseEffecté‡Œå¿…é¡»åˆ é™¤newå‡ºæ¥çš„å®ä¾‹ return () =&gt; cancel()&#125;, [query, pageNum]) æ”¹é€ å®Œæˆåï¼Œç»§ç»­é‡æ–°å°è¯•ï¼š é¡µé¢UIå®ç°ï¼š é’ˆå¯¹ç•Œé¢å®ç°çš„ä¸°å¯Œï¼Œæˆ‘ä»¬å¯¹ useBookSearch å‡½æ•°ç»§ç»­åšæ”¹é€ ï¼Œåˆ†åˆ«å¢åŠ ä»¥ä¸‹çŠ¶æ€ï¼š loading : è¯»å– error : è·å–æ•°æ®é”™è¯¯ hasMore : åˆ¤æ–­æ˜¯å¦è¿˜æœ‰æ•°æ® books : è·å–åˆ°çš„æ‰€æœ‰ä¹¦ç±çš„æ•°æ® 12345678910111213141516171819202122232425262728293031323334353637383940414243const useBookSearch = (query, pageNum) =&gt; &#123; const [loading, setLoading] = useState(true) const [error, setError] = useState([]) const [books, setBooks] = useState([]) const [hasMore, setHasMore] = useState(false) useEffect(() =&gt; &#123; setLoading(true) setError(false) let cancel axios(&#123; method: &#x27;GET&#x27;, url: &#x27;http://openlibrary.org/search.json&#x27;, params: &#123; q: query, page: pageNum &#125;, cancelToken: new axios.CancelToken(c =&gt; cancel = c) &#125;) .then(res =&gt; &#123; // å°†åé¢è¯·æ±‚å›æ¥booksåŠ å…¥ç°æœ‰æ•°ç»„ä¸­ï¼šç”¨Setå»é‡ï¼š setBooks(prevBooks =&gt; &#123; return [...new Set([...prevBooks, ...res.data.docs.map(b =&gt; b.title)])] &#125;) // æ¯æ¬¡åªèƒ½æ˜¾ç¤ºæ»¡å±çš„æ•°æ®ï¼Œå¦‚æœè¯·æ±‚çš„æ•°æ®æ²¡æ˜¾ç¤ºå®Œ setHasMore(res.data.docs.length &gt; 0) // åˆ™æŠŠloadingæ˜¾ç¤ºä¸ºfalse setLoading(false) &#125;) .catch(e =&gt; &#123; if (axios.isCancel(e)) return // è®¾ç½®é”™è¯¯ï¼š setError(true) &#125;) return () =&gt; cancel() &#125;, [query, pageNum]) // æ¯æ¬¡æ”¹å˜ useEffect(() =&gt; &#123; setBooks([]) &#125;, [query]) // å°†ä¸Šé¢çš„çŠ¶æ€ä¸€æ¦‚å¯¼å‡ºï¼Œç»™Appå‡½æ•°ç”¨ï¼š return &#123; loading, error, books, hasMore &#125;&#125; æ”¹é€ ä¸»é¡µé¢çš„ App ç»„ä»¶: 123456789101112131415161718192021222324import &#123; useState &#125; from &#x27;react&#x27;const App = () =&gt; &#123; const [query, setInput] = useState(&#x27;&#x27;) const [pageNum, setPageNum] = useState(1) // å°†çŠ¶æ€ä»useBookNameSearchè§£æ„å‡ºæ¥ï¼š const &#123; books, hasMore, loading, error &#125; = useBookSearch(query, setPageNum) const handleSearch = e =&gt; &#123; setInput(e.target.value) pageNum(1) &#125; return ( &lt;&gt; &lt;input type=&quot;text&quot; onChange=&#123;handleSearch&#125;/&gt; &#123; books.map((book, index) =&gt; &lt;div key=&#123;book&#125;&gt;&#123;book&#125;&lt;/div&gt;)&#125; &lt;div&gt;&#123; loading &amp;&amp; &#x27;Loading...&#x27; &#125;&lt;/div&gt; &lt;div&gt;&#123; error &amp;&amp; &#x27;Error&#x27; &#125;&lt;/div&gt; &lt;/&gt; );&#125;export default App; æœ€åï¼Œç»§ç»­åšç¿»é¡µçš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬è¦å®ç°çš„æ•ˆæœæ˜¯ï¼Œæ»šåŠ¨åˆ°é¡µé¢æœ€ä¸‹é¢ï¼Œåˆ™è‡ªåŠ¨è§¦å‘loadingå’Œç¿»é¡µï¼Œåœ¨ App é‡Œç”¨åˆ°useRef é’©å­ï¼Œæ£€æµ‹åˆ°æ»šåŠ¨åˆ°æœ€åä¸€è¡Œ ç”¨åˆ° useCallback é’©å­ï¼Œå…·æœ‰ç¼“å­˜ä½œç”¨ï¼Œä¾èµ–æ”¹å˜æ‰é‡æ–°æ¸²æŸ“ã€‚ ç”¨åˆ° IntersectionObserver api, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œå…¶ entries ä¸ºæ£€æµ‹åˆ°çš„è§¦å‘çš„ç‚¹ 12345678910111213const last = useRef()const lastRecordRef = useCallback( node =&gt; &#123; if (loading) return if (observer.current) observer.current.disconnect() observer.current = new IntersectionObserver(entries =&gt; &#123; // entries[0].isIntersectingæ£€æµ‹å¯è§é¡µé¢å†…æ˜¯å¦éœ€è¦è°ƒç”¨æ–°çš„æ•°æ®ï¼š if( entries[0].isIntersecting &amp;&amp; hasMore ) &#123; setPageNum(prevPageNumber =&gt; prevPageNumber + 1) &#125; &#125;) // æ£€æµ‹æ˜¯å¦æœ€åä¸€ä¸ªèŠ‚ç‚¹node if (node) observer.current.observe(node)&#125;, [loading, hasMore] æ§åˆ¶å°æ‰“å°äº†entries[0].isIntersectingï¼Œå½“å‡ºç°LoadingçŠ¶æ€æ—¶ï¼Œè¯¥å€¼ä¸ºtrue, å•å½“å®ŒæˆåŠ è½½åä¸ºfalseï¼Œå¦‚ä¸‹ï¼š è´´å‡ºå®Œæ•´ä»£ç ï¼š App.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344import useBookSearch from &#x27;./useBookSearch&#x27;import &#123; useState, useRef, useCallback &#125; from &#x27;react&#x27;function App() &#123; const [query, setQuery] = useState(&#x27;&#x27;) const [pageNumber, setPageNumber] = useState(1) const &#123; books, hasMore, loading, error &#125; = useBookSearch(query, pageNumber) const observer = useRef() const lastBookElementRef = useCallback(node =&gt; &#123; if (loading) return if (observer.current) observer.current.disconnect() observer.current = new IntersectionObserver(entries =&gt; &#123; // detected is it the last one: if( entries[0].isIntersecting &amp;&amp; hasMore ) &#123; setPageNumber(prevPageNumber =&gt; prevPageNumber + 1) &#125; &#125;) if (node) observer.current.observe(node) &#125;, [loading, hasMore]) const handleSearch = e =&gt; &#123; setQuery(e.target.value) setPageNumber(1) &#125; return ( &lt;&gt; &lt;input type=&quot;text&quot; onChange=&#123;handleSearch&#125;/&gt; &#123; books.map( (book, index) =&gt; &#123; if (books.length === index + 1) &#123; return &lt;div ref=&#123;lastBookElementRef&#125; key=&#123;book&#125;&gt;&#123;book&#125;&lt;/div&gt; &#125;else&#123; return &lt;div key=&#123;book&#125;&gt;&#123;book&#125;&lt;/div&gt; &#125; &#125;)&#125; &lt;div&gt;&#123; loading &amp;&amp; &#x27;Loading...&#x27; &#125;&lt;/div&gt; &lt;div&gt;&#123; error &amp;&amp; &#x27;Error&#x27; &#125;&lt;/div&gt; &lt;/&gt; );&#125;export default App; useBookSearch ç‹¬ç«‹æˆä¸€ä¸ªæ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243import &#123; useEffect, useState &#125; from &#x27;react&#x27;import axios from &#x27;axios&#x27;const useBookSearch = (query, pageNumber) =&gt; &#123; const [loading, setLoading] = useState(true) const [error, setError] = useState([]) const [books, setBooks] = useState([]) const [hasMore, setHasMore] = useState(false) useEffect(() =&gt; &#123; setLoading(true) setError(false) let cancel axios(&#123; method: &#x27;GET&#x27;, url: &#x27;http://openlibrary.org/search.json&#x27;, params: &#123; q: query, page: pageNumber &#125;, cancelToken: new axios.CancelToken(c =&gt; cancel = c) &#125;) .then(res =&gt; &#123; setBooks(prevBooks =&gt; &#123; return [...new Set([...prevBooks, ...res.data.docs.map(b =&gt; b.title)])] &#125;) setHasMore(res.data.docs.length &gt; 0) setLoading(false) &#125;) .catch(e =&gt; &#123; if (axios.isCancel(e)) return setError(true) &#125;) return () =&gt; cancel() &#125;, [query, pageNumber]) useEffect(() =&gt; &#123; setBooks([]) &#125;, [query]) return &#123; loading, error, books, hasMore &#125;&#125;export default useBookSearch","categories":[],"tags":[{"name":"React","slug":"React","permalink":"https://zyzy.info/tags/React/"},{"name":"React Hooks","slug":"React-Hooks","permalink":"https://zyzy.info/tags/React-Hooks/"},{"name":"IntersectionObserver","slug":"IntersectionObserver","permalink":"https://zyzy.info/tags/IntersectionObserver/"}]},{"title":"å‘ç°ä¸€å…è´¹CDNï¼Œæˆ‘ç”¨æ¥å­˜è¯¥ç«™çš„å›¾","slug":"ã€2021-04-22ã€‘å‘ç°ä¸€å…è´¹CDNï¼Œæˆ‘ç”¨æ¥å­˜è¯¥ç«™çš„å›¾","date":"2021-04-22T02:25:24.000Z","updated":"2021-10-14T03:42:59.910Z","comments":true,"path":"2021/04/22/ã€2021-04-22ã€‘å‘ç°ä¸€å…è´¹CDNï¼Œæˆ‘ç”¨æ¥å­˜è¯¥ç«™çš„å›¾/","link":"","permalink":"https://zyzy.info/2021/04/22/%E3%80%902021-04-22%E3%80%91%E5%8F%91%E7%8E%B0%E4%B8%80%E5%85%8D%E8%B4%B9CDN%EF%BC%8C%E6%88%91%E7%94%A8%E6%9D%A5%E5%AD%98%E8%AF%A5%E7%AB%99%E7%9A%84%E5%9B%BE/","excerpt":"å…ˆä¸Šç½‘å€ï¼šhttps://www.jsdelivr.com/?docs=gh","text":"å…ˆä¸Šç½‘å€ï¼šhttps://www.jsdelivr.com/?docs=gh è¯´è¯´æˆ‘é‡åˆ°çš„ç—›ç‚¹ï¼Œè¯¥ç«™é‡‡ç”¨hexoç”Ÿæˆï¼Œåœ¨ç½‘ä¸Šæœäº†ä¸€åœˆï¼Œå»ºè®®ç”¨hexo-asset-imageå·¥å…·ï¼Œä½†_postæ–‡ä»¶å¤¹é‡Œä¼šå¤šå‡ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸“é—¨ç”¨äºå­˜å‚¨å›¾ç‰‡ï¼Œä¸”è¯¥å·¥å…·è¿˜æœ‰ä¸€ç‚¹bugï¼Œè™½ç„¶æœ€åä¹Ÿè§£å†³äº†ï¼Œä½†æ€»æœ‰ç‚¹ä¸çˆ½ã€‚æ€å‰æƒ³åï¼Œè¿˜æ˜¯æ–°å»ºä¸€ä¸ªæ”¾å›¾ç‰‡çš„git repoæœ€çœäº‹ï¼Œå¦‚æœç›´æ¥è´´ä»“åº“ï¼Œå¯èƒ½é€Ÿåº¦æœ‰ç‚¹æ…¢ï¼Œäºæ˜¯å°±å¾—æ‰¾CDNäº†ã€‚ CDN ï¼ˆContent Delivery Network/Content Distribution Networkï¼‰å†…å®¹åˆ†å‘ç½‘ç»œã€‚æ˜¯æŒ‡ä¸€ç§é€è¿‡äº’è”ç½‘äº’ç›¸è¿æ¥çš„ç”µè„‘ç½‘ç»œç³»ç»Ÿï¼Œåˆ©ç”¨æœ€é è¿‘æ¯ä½ç”¨æˆ·çš„æœåŠ¡å™¨ï¼Œæ›´å¿«ã€æ›´å¯é åœ°å°†éŸ³ä¹ã€å›¾ç‰‡ã€å½±ç‰‡ã€åº”ç”¨ç¨‹åºåŠå…¶ä»–æ–‡ä»¶å‘é€ç»™ç”¨æˆ·ï¼Œæ¥æä¾›é«˜æ€§èƒ½ã€å¯æ‰©å±•æ€§åŠä½æˆæœ¬çš„ç½‘ç»œå†…å®¹ä¼ é€’ç»™ç”¨æˆ·ã€‚ é€‰æ‹©äº†GitHubç‰ˆæœ¬ï¼Œæ“ä½œå¦‚ä¸‹ï¼š é¦–å…ˆï¼Œæ–°å»ºä¸€ä¸ªGitHubä»“åº“ï¼šä¾‹å¦‚æˆ‘è‡ªå·±çš„å›¾ç‰‡çš„ä»“åº“ï¼š https://github.com/ys558/my-blog-imgs å°†ä½ è¦æ”¾ç½‘ç»œçš„å›¾ç‰‡æ¨åˆ°ä½ è‡ªå·±ä»“åº“ å…³é”®çš„ä¸€æ­¥ï¼šç»™ä»“åº“ç‰ˆæœ¬æ‰“æ ‡ç­¾ï¼Œä¸¤ä¸ªæ–¹æ³•ï¼šæ–¹æ³•ä¸€ã€å‘½ä»¤è¡Œ, ä¾‹å¦‚ï¼š 1git tag -a v1.4 -m &quot;my version 1.4&quot; å‘½ä»¤è¡Œæ›´è¯¦ç»†çš„æ“ä½œå¯å‚è€ƒè¿™é‡Œ æ–¹æ³•äºŒã€æ¨å®Œå›¾ç‰‡åï¼Œç›´æ¥åœ¨ä½ githubå›¾ç‰‡ä»“åº“ä¸Šæ“ä½œï¼š å°†ä½ æ”¾å›¾ç‰‡é“¾æ¥çš„ä½ç½®æ›¿æ¢ä¸º jsdelivr ä¸¾ä¾‹çš„CDNæ ¼å¼å³å¯ï¼Œä»¥æˆ‘å¤´åƒçš„å›¾ç‰‡ä¸¾ä¾‹ï¼Œç”¨GitHubçš„æ ¼å¼ä¸ºï¼š 1https://cdn.jsdelivr.net/gh/user/repo@version/file æ›¿æ¢ä¸ºï¼š 1https://cdn.jsdelivr.net/gh/ys558/my-blog-imgs@0.17/avatar/å®‡èˆªå‘˜.svg","categories":[],"tags":[{"name":"CDN","slug":"CDN","permalink":"https://zyzy.info/tags/CDN/"}]},{"title":"GraphQLå­¦ä¹ ","slug":"ã€2021-04-20ã€‘GraphQLå­¦ä¹ ","date":"2021-04-20T02:15:27.000Z","updated":"2021-10-14T03:42:59.909Z","comments":true,"path":"2021/04/20/ã€2021-04-20ã€‘GraphQLå­¦ä¹ /","link":"","permalink":"https://zyzy.info/2021/04/20/%E3%80%902021-04-20%E3%80%91GraphQL%E5%AD%A6%E4%B9%A0/","excerpt":"å»å¹´è‡ªå­¦äº†GraphQLï¼Œè¿™é‡Œé‡æ–°æ•´ç†ä¸€ä¸‹ç¬”è®°ã€‚å›½å†…ä½¿ç”¨GraphQLçš„é¡¹ç›®æ¯•ç«Ÿè¿˜ä¸å¤šï¼Œè¿™é‡Œå†™ä¸ªdemoï¼Œåšä¸ªå°å°çš„æ¢ç´¢ã€‚ GraphQLæ˜¯facebookå‘æ˜çš„ä¸€å¥—APIæŸ¥è¯¢è¯­è¨€ï¼Œæ”¯æŒå¤šç§è¯­è¨€ï¼Œè¿™é‡Œç”¨jsæ¼”ç¤ºï¼Œå®˜ç½‘æœ‰è¯¦ç»†çš„è¯´æ˜æ¯”èµ·ä¼ ç»Ÿçš„åç«¯APIæ•´åˆ","text":"å»å¹´è‡ªå­¦äº†GraphQLï¼Œè¿™é‡Œé‡æ–°æ•´ç†ä¸€ä¸‹ç¬”è®°ã€‚å›½å†…ä½¿ç”¨GraphQLçš„é¡¹ç›®æ¯•ç«Ÿè¿˜ä¸å¤šï¼Œè¿™é‡Œå†™ä¸ªdemoï¼Œåšä¸ªå°å°çš„æ¢ç´¢ã€‚ GraphQLæ˜¯facebookå‘æ˜çš„ä¸€å¥—APIæŸ¥è¯¢è¯­è¨€ï¼Œæ”¯æŒå¤šç§è¯­è¨€ï¼Œè¿™é‡Œç”¨jsæ¼”ç¤ºï¼Œå®˜ç½‘æœ‰è¯¦ç»†çš„è¯´æ˜æ¯”èµ·ä¼ ç»Ÿçš„åç«¯APIæ•´åˆ GraphQLä¸ºä½ çš„APIæ•°æ®æä¾›äº†ä¸€ç§å®Œæ•´ä¸”æ˜“äºç†è§£çš„æè¿°ã€‚ï¼ˆGraphQL provides a complete and understandable description of the data in your APIï¼‰ ä»¥ä¸Šæ˜¯å®˜ç½‘å¯¹GraphQLçš„è§£é‡Šï¼Œåˆ©ç”¨GraphQLå¯ä»¥æŒ‰éœ€å–å­—æ®µç»™å‰ç«¯åˆ©ç”¨ï¼Œä¸å¿…å–åˆ°ä¸éœ€è¦çš„å­—æ®µï¼Œè§ä¸‹å›¾è§£é‡Šï¼š GraphQLåˆ™å¯ä»¥ç²¾ç¡®æŸ¥æ‰¾æƒ³è¦çš„å­—æ®µï¼Œæ•ˆç‡æ˜¾è‘—æé«˜ï¼š ä¸‹é¢ï¼Œç»“åˆè‡ªå·±å†™çš„demoï¼šhttps://github.com/ys558/tech-blog-code/tree/master/2020/04-graphql-learn å®Œæˆä»¥ä¸‹å®Œæˆæœ¬ç¯‡åšå®¢ï¼š ä¸€ã€HelloWorld å°†é¡¹ç›®æ‹‰ä¸‹æ¥åï¼Œcdåˆ°å¯¹åº”ç›®å½•ä¸‹ï¼Œç”¨npm installæˆ–yarnå®‰è£…ä¾èµ–ï¼Œè¿è¡Œnpm run hello æˆ– yarn helloï¼Œå…ˆä» 01helloworld.js æ–‡ä»¶è·‘èµ·ï¼Œæµè§ˆå™¨è¿è¡Œhttp://localhost:5000/å·¦è¾¹è¾“å…¥æ¡†è¾“å…¥123query &#123; message&#125; æ³¨æ„ï¼Œè¿™ç§æ˜¯GraphQLç‰¹æœ‰çš„æŸ¥è¯¢è¯­æ³• ç‚¹å‡»è¿è¡Œï¼Œ( æˆ–å¿«æ·é”® ctrl+enter ) åï¼Œå³è¾¹ä¼šæ˜¾ç¤ºï¼š 01helloworld.jsè§£æï¼š graphqlHTTP ä¸º express-graphql åº“è§£æ„çš„å®ä¾‹1const &#123; graphqlHTTP &#125; = require(&#x27;express-graphql&#x27;) GraphQLè‡ªå¸¦å›¾å½¢åŒ–ç•Œé¢ä¸”å‹å¥½ï¼Œï¼Œåªéœ€åœ¨å®ä¾‹ graphqlHTTP ä¸­è®¾ç½®graphiql: trueå³å¯ï¼š1app.use(&#x27;/&#x27;, graphqlHTTP(&#123; schema, graphiql: true &#125;)) åœ¨queryå®ä¾‹ä¸­ï¼Œfields å­—æ®µç”¨äºè®¾ç½®æŸ¥è¯¢æ¡ä»¶ï¼Œæ˜¯å›è°ƒå‡½æ•°ï¼Œ fields å‡½æ•°è¿”å›çš„ä¸œè¥¿ç”¨ resolve å‡½æ•°æ¥æ”¶å…¶è¿”å›ç»“æœï¼Œæ¥æ”¶ç»“æœä¹Ÿä¸ºå›è°ƒå‡½æ•° åœ¨æ¥æ”¶ç»“æœä¸­ï¼Œå¯ä»¥è§„å®šå…¶è¿”å›ç±»å‹ typeï¼Œå…¶å€¼ä¸º Scalar Type (æ ‡é‡ç±»å‹)1234567891011const schema = new GraphQLSchema(&#123; query: new GraphQLObjectType(&#123; name: &#x27;helloWorld&#x27;, fields: () =&gt; (&#123; message: &#123; type: GraphQLString, resolve: () =&gt; &#x27;Hello World&#x27; &#125; &#125;) &#125;)&#125;) äºŒã€åŸºç¡€æ“ä½œ è¿è¡Œnpm run ds2 æˆ– yarn ds2ï¼Œæµè§ˆå™¨è·‘ http://localhost:5000/booksï¼Œ 123456&#123; books &#123; id name &#125;&#125; è¾“å…¥ä»¥ä¸Šæ¡ä»¶ï¼Œé€šè¿‡ books å­—æ®µæŸ¥è¯¢å…¶å¯¹åº”çš„ id, name åè¿è¡Œï¼Œå¯ä»¥æŸ¥è¯¢å‡ºä»¥ä¸‹ç»“æœï¼š 02base.js è§£æï¼š booksæŸ¥è¯¢å‡ºæ¥çš„ä¸ºä¸€æ•°ç»„ï¼Œå…¶æ ‡é‡ å®šä¹‰ä¸º GraphQLList1234567891011121314151617181920212223const RootQueryType = new GraphQLObjectType(&#123; name: &#x27;Query&#x27;, description: &#x27;Root Query&#x27;, fields: () =&gt; (&#123; /* ç¬¬ä¸€ä¸ª books æ˜¯å‘½åï¼Œä¹Ÿå¯å« aaaï¼Œå¦‚æœæ”¹ aaa åˆ™ åœ¨ query æ¡ä»¶æ”¹ä¸ºï¼š aaa &#123; books &#123; id name &#125; &#125; */ books: &#123; // BookType as params pass to RootQueryType type: new GraphQLList(BookType), description: &#x27;List of all books&#x27;, // è¿™é‡Œçš„ books å¯¹åº”å®é™…çš„ books æ•°ç»„ï¼Œ // è¦æŸ¥è¯¢æ•°ç»„ booksé‡Œçš„ä¸œè¥¿ï¼š resolve: () =&gt; books &#125; &#125;)&#125;) BookType ç‹¬ç«‹ä¸ºæ ‡é‡GraphQLObjectTypeçš„å®ä¾‹åŒ–ï¼Œç”±äºå…¶ä¸ºæœ€åä¸€å±‚æ•°æ®ï¼Œæ— éœ€å‘ä¸‹æ·±æŒ–ï¼Œæ‰€ä»¥resolve æ–¹æ³•ä¸éœ€è¦ GraphQLNonNull è¡¨ç¤ºè¯¥å­—æ®µä¸ºå¿…é¡»å­—æ®µ12345678const BookType = new GraphQLObjectType(&#123; name: &#x27;Book&#x27;, description: &#x27;this is represents a book written by an author&#x27;, fields: () =&gt; (&#123; id: &#123; type: GraphQLNonNull(GraphQLInt) &#125;, name: &#123; type: GraphQLNonNull(GraphQLString) &#125;, &#125;)&#125;) ä¸‰ã€é€šè¿‡ä¹¦ç±æŸ¥è¯¢å¯¹åº”ä½œè€…ï¼ˆä¸€å¯¹ä¸€å…³ç³»æŸ¥è¯¢ï¼‰åŠä½œè€…æŸ¥è¯¢å¯¹åº”çš„ä¹¦ç±ä¿¡æ¯ï¼ˆä¸€å¯¹å¤šæŸ¥è¯¢ï¼‰ è·‘ 03listQuery.js æ–‡ä»¶ï¼Œè¾“å…¥ 12345678&#123; authors &#123; books &#123; id name &#125; &#125;&#125; å¯ä»¥å¾—åˆ°ç»“æœï¼š è§£æ03listQuery.js ï¼š å¯ä»¥æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•ç»§ç»­ä¸°å¯ŒæŸ¥è¯¢ï¼Œå»ºç«‹ä¸€ä¸ªæ¨¡æ‹Ÿæ•°æ® author ï¼Œå†…å®¹å¦‚ä¸‹ï¼š 12345const authors = [ &#123; id: 1, name: &#x27;J. K. Rowling&#x27;&#125;, &#123; id: 2, name: &#x27;J. R. R. Tolkien&#x27;&#125;, &#123; id: 3, name: &#x27;Brent Weeks&#x27;&#125;,] åŒæ ·çš„ï¼Œå»ºç«‹ä¸¤ä¸ªå®ä¾‹æŸ¥è¯¢å¯¹åº”ä¿¡æ¯ï¼šresolve éƒ¨åˆ†å¯¹åº”ç›¸åº”çš„æ•°æ® 123456789101112&#123; books: &#123; type: new GraphQLList(BookType), description: &#x27;List of all books&#x27;, resolve: () =&gt; books &#125;, authors: &#123; type: new GraphQLList(AuthorType), description: &#x27;List of all Authors&#x27;, resolve: () =&gt; authors &#125;&#125; æ ¹æ®ä¸Šé¢çš„å­—æ®µåå­—books å’Œ authors åˆ›å»ºå¯¹åº”çš„æŸ¥è¯¢å®ä¾‹ï¼š bookså®ä¾‹é‡Œï¼Œid, name, authorId å‡æ˜¯ books å¯¹è±¡é‡Œçš„ï¼Œå¯ç›´æ¥æŸ¥å‡ºï¼Œ authorå­—æ®µåœ¨ author æ•°ç»„é‡Œ books æ•°æ®æœ‰å…³è”çš„æ˜¯authorIdï¼Œç”¨jsçš„æ•°ç»„æ–¹æ³•.find()å»æ‰¾ books &lt;â€“&gt; authors æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼ŒAuthorTypeæœ¬èº«å°±æ˜¯GraphQLObjectType æ ‡é‡ï¼Œå¯ç›´æ¥ä½¿ç”¨ 12345678910111213141516const BookType = new GraphQLObjectType(&#123; name: &#x27;Book&#x27;, description: &#x27;this is represents a book written by an author&#x27;, fields: () =&gt; (&#123; id: &#123; type: GraphQLNonNull(GraphQLInt) &#125;, name: &#123; type: GraphQLNonNull(GraphQLString) &#125;, authorId: &#123; type: GraphQLNonNull(GraphQLInt)&#125;, author: &#123; type: AuthorType, // query book by authorId resolve: book =&gt; &#123; return authors.find( author =&gt; author.id === book.authorId ) &#125; &#125; &#125;)&#125;) authorså®ä¾‹ä¹Ÿæ˜¯åŒæ ·é“ç† authors &lt;â€“&gt; books æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼ŒBookTypeå®ä¾‹è¦è£…å…¥GraphQLListæ ‡é‡ä¸­ 123456789101112131415const AuthorType = new GraphQLObjectType(&#123; name: &#x27;Author&#x27;, description: &#x27;this is represents a author of a book&#x27;, fields: () =&gt; (&#123; id: &#123; type: GraphQLNonNull(GraphQLInt) &#125;, name: &#123; type: GraphQLNonNull(GraphQLString) &#125;, // query author by book&#x27;s id books: &#123; type: new GraphQLList(BookType), resolve: author =&gt; &#123; return books.filter(book =&gt; book.authorId === author.id) &#125; &#125; &#125;)&#125;) å››ã€é€šè¿‡ä¹¦ç±idæŸ¥è¯¢ä¹¦æœ¬ä¿¡æ¯ è¿è¡Œ04singleQuery.jsï¼Œè¾“å…¥ä»¥ä¸‹æŸ¥è¯¢æ¡ä»¶ï¼š 12345678&#123; book(id: 4) &#123; name author &#123; name &#125; &#125;&#125; æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š è¾“å…¥ä»¥ä¸‹æ¡ä»¶ 12345678&#123; book(id: 4) &#123; name author &#123; name &#125; &#125;&#125; æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š 04singleQuery.jsè§£æï¼š ä»ä»¥ä¸Šçš„æŸ¥è¯¢æ¡ä»¶ book(id: 4) å¯çœ‹å‡ºï¼Œé€šè¿‡ä¼ å‚idæŸ¥è¯¢å…·ä½“ä¹¦ç±ä¿¡æ¯ï¼Œè¿™é‡Œçš„idå°±ä½“ç°åœ¨argså‚æ•°ä¸Šï¼š args åœ¨ resolve å‡½æ•°é‡Œå¤„äºç¬¬äºŒä¸ªå‚æ•°çš„ä½ç½®1234567book: &#123; type: BookType, description: &#x27;A Single Book&#x27;, // must query this book by params of book id: args: &#123; id: &#123; type: GraphQLInt &#125; &#125;, resolve: ( parent, args ) =&gt; books.find( book =&gt; book.id === args.id )&#125;, åŒæ ·çš„ï¼Œ authorä¹Ÿå¯ä»¥æŒ‰ç…§ä¼ å…¥authorIdæŸ¥è¯¢å¾—åˆ°ï¼š1234567author: &#123; type: AuthorType, description: &#x27;A Single Author&#x27;, // query an author by params of author id: args: &#123; id: &#123; type: GraphQLInt &#125; &#125;, resolve: ( parent, args ) =&gt; authors.find( author =&gt; author.id === args.id )&#125;, ç”¨ author(id) æŸ¥è¯¢ç»“æœï¼š äº”ã€ä¿®æ”¹æ•°æ®ï¼ˆMutationTypeï¼‰ è¿è¡Œyarn ds5ï¼Œæµè§ˆå™¨è¾“å…¥ï¼š 123456mutation &#123; addBook(name: &quot;new book&quot;, authorId: 1) &#123; id name &#125;&#125; å¯ä»¥çœ‹åˆ°å¢åŠ å•æœ¬ä¹¦æˆåŠŸï¼š è¾“å…¥ï¼š 12345mutation &#123; addAuthor(name: &quot;new author&quot;) &#123; name &#125;&#125; å¯ä»¥çœ‹åˆ°å¢åŠ ä¸€ä¸ªä½œè€…æˆåŠŸï¼š ç‚¹å‡»å³ä¸Šè§’çš„ &lt; Docsï¼Œå¯ä»¥å‘ç°è¯¥æ–‡ä»¶çš„Mutationå‡½æ•°ï¼Œå…¶ä¸­!æ„ä¸ºå¿…è¦å­—æ®µï¼š 05mutationType.jsè§£æï¼š æƒ³è¦å®ç° Mutation Type é¡»åœ¨GraphQLSchemaå®ä¾‹é‡Œæ·»åŠ mutationç±»å‹ï¼š1234const Schema = new GraphQLSchema(&#123; query: RootQueryType, mutation: RootMutationType&#125;) å’Œæ™®é€šçš„ Query Type ç±»ä¼¼ï¼Œåªä¸è¿‡ Mutation Type åœ¨ resolve é‡Œç›´æ¥å¯¹æ•°æ®è¿›è¡Œæ”¹åŠ¨è€Œå·²ï¼š123456789101112131415161718192021222324252627fields: () =&gt; (&#123; addBook: &#123; type: BookType, description: &#x27;Add a book&#x27;, args: &#123; name: &#123; type: GraphQLNonNull(GraphQLString) &#125;, authorId: &#123; type: GraphQLNonNull(GraphQLInt) &#125; &#125;, resolve: ( parent, args ) =&gt; &#123; const book = &#123; id: books.length + 1, name: args.name, authorId: args.authorId &#125; books.push(book) return book &#125; &#125;, addAuthor: &#123; type: AuthorType, description: &#x27;Add a author&#x27;, args: &#123; name: &#123; type: GraphQLNonNull(GraphQLString) &#125; &#125;, resolve: ( parent, args ) =&gt; &#123; const author = &#123; id: authors.length + 1, name: args.name &#125; authors.push(author) return author &#125; &#125;,&#125;)","categories":[],"tags":[{"name":"GraphQL","slug":"GraphQL","permalink":"https://zyzy.info/tags/GraphQL/"}]},{"title":"Github Pageå»ºç«™å¿ƒå¾—åŠæ‰€è¸©çš„å‘","slug":"ã€2021-04-19ã€‘GithubPageå»ºç«™å¿ƒå¾—åŠæ‰€è¸©çš„å‘","date":"2021-04-19T02:46:18.000Z","updated":"2021-10-14T03:42:59.909Z","comments":true,"path":"2021/04/19/ã€2021-04-19ã€‘GithubPageå»ºç«™å¿ƒå¾—åŠæ‰€è¸©çš„å‘/","link":"","permalink":"https://zyzy.info/2021/04/19/%E3%80%902021-04-19%E3%80%91GithubPage%E5%BB%BA%E7%AB%99%E5%BF%83%E5%BE%97%E5%8F%8A%E6%89%80%E8%B8%A9%E7%9A%84%E5%9D%91/","excerpt":"æœ€è¿‘æƒ³ç”¨ github.io å»ºç«‹æˆ‘çš„ä¸ªäººåšå®¢ç«™ç‚¹ï¼Œå…·ä½“æ­¥éª¤æˆ‘å‚è€ƒäº†çŸ¥ä¹ä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼Œé‡Œé¢å†™çš„å¤Ÿæ¸…æ¥šäº†ï¼Œä¸‹é¢å°±å»ºç«™æ—¶ç¢°åˆ°çš„å‘å†™çš„ä¸å®Œå…¨æ€»ç»“ï¼Œä¼°è®¡ä»¥åé™†ç»­å¢åŠ ","text":"æœ€è¿‘æƒ³ç”¨ github.io å»ºç«‹æˆ‘çš„ä¸ªäººåšå®¢ç«™ç‚¹ï¼Œå…·ä½“æ­¥éª¤æˆ‘å‚è€ƒäº†çŸ¥ä¹ä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼Œé‡Œé¢å†™çš„å¤Ÿæ¸…æ¥šäº†ï¼Œä¸‹é¢å°±å»ºç«™æ—¶ç¢°åˆ°çš„å‘å†™çš„ä¸å®Œå…¨æ€»ç»“ï¼Œä¼°è®¡ä»¥åé™†ç»­å¢åŠ  ys558.github.ioæ”¹ä¸ºè‡ªå·±çš„åŸŸåå»é˜¿é‡Œäº‘ç”³è¯·ä¸€ä¸ªè‡ªå·±çš„åŸŸååç»‘å®šåŸç†çš„ys558.github.ioåŸŸåï¼Œæ­¥éª¤ï¼š ç™»é™†é˜¿é‡Œäº‘çš„ä¸‡ç½‘ï¼ŒæŒ‘ä¸€ä¸ªå–œæ¬¢ä¾¿å®œçš„åŸŸåæ³¨å†Œï¼Œæˆ‘çš„åŸŸå zyzy.info ä¸€å¹´åªèŠ±21å…ƒï¼Œæ³¨å†Œå®Œæˆåé€‰æ‹©ä¸ªäººç«™ç‚¹ï¼Œé¡ºä¾¿ä¹Ÿå°±å¼€é€šäº†é˜¿é‡Œäº‘è´¦å·ï¼Œå¦‚å…¶ä»–åŸŸåæœåŠ¡å•†ï¼Œå¦‚ç”³è¯·.meç»“å°¾çš„ä¸ªäººç½‘ç«™ï¼Œåº”è¯¥å»GoDaddyç­‰ ä¾æ¬¡è¿›å…¥å³ä¸Šè§’çš„ æ§åˆ¶å° =&gt; è¿ç»´ç®¡ç† é€‰é¡¹å¡ä¸‹æ‰¾åˆ° åŸŸå æ ‡ç­¾ =&gt; ç‚¹å‡» è§£æï¼Œå¦‚ä¸‹ï¼š =&gt; ç‚¹å‡»æ·»åŠ è®°å½•ï¼Œ åœ¨ è®°å½•å€¼ å¤„å¡«ä¸‹ys558.github.ioï¼Œå¦‚ä¸‹ï¼Œç‚¹å‡»ç¡®å®šã€‚è¿™æ ·å°±æŠŠä½ github.ioä¸Šçš„é¡µé¢ç»‘å®šäº†è´­ä¹°çš„åŸŸåä¸‹ ç”¨ping ä¹Ÿå¯æŸ¥è¯¢åˆ°æ–°ç»‘å®šçš„åŸŸåç½‘å€IPï¼š æŒ‰ä»¥ä¸‹å‘½ä»¤åœ¨è‡ªå·±çš„githubä»“åº“ä¸­æ·»åŠ CNAMEæ–‡ä»¶ï¼Œå…¶ä¸­å¡«å…¥è´­ä¹°çš„åŸŸåã€‚æˆ–è€…å¯ä»¥åœ¨ä»“åº“çš„settingsä¸­è®¾ç½®Custom Domainè®¾ç½®å¥½è‡ªå·±çš„åŸŸåï¼Œgithubä¼šè‡ªåŠ¨æ·»åŠ CNAMEæ–‡ä»¶ã€‚ 12touch CNAMEecho &#x27;zyzy.info&#x27;&gt; CNAME å›¾ç‰‡æ˜¾ç¤ºé”™è¯¯ï¼šï¼ï¼ï¼è¯¥æ–¹æ³•ä¹Ÿæ˜¯åœ¨ç½‘ä¸Šæœç´¢å¾—åˆ°ï¼Œè™½å¯è¡Œï¼Œä½†è§£æä¸­æ–‡è·¯å¾„æ—¶ç»å¸¸ä¼šå‡ºé”™ï¼Œåæ¥è¿˜æ˜¯è½¬ç”¨CDNï¼ŒæŠŠå›¾ç‰‡å…¨éƒ¨ç§»åˆ°å¦ä¸€ä¸ªrepoï¼Œæ¨èç”¨CDNçš„æ–¹æ³•ï¼Œå…·ä½“æ“ä½œåŠæ³•çœ‹æˆ‘å¦ä¸€ç¯‡æ–‡ç«  éœ€è¦å®‰è£…ä¸€ä¸ªå›¾ç‰‡è·¯å¾„è½¬æ¢çš„æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶åå­—æ˜¯ hexo-asset-image 123npm i hexo-asset-image --save# oryarn add hexo-asset-image --save _config.ymlæ–‡ä»¶ï¼Œä¿®æ”¹ä¸‹è¿°å†…å®¹ï¼Œç”¨ hexo n &lt;åšå®¢æ–‡ç« åå­—&gt; ç”Ÿæˆæ–°åšå®¢æ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œå°†å›¾ç‰‡æ”¾å…¥è¯¥æ–‡ä»¶å¤¹å¼•ç”¨å³å¯ï¼š 1post_asset_folder: true ä¿®æ”¹åšå®¢ç›®å½•ä¸‹node_modules\\hexo-asset-image\\index.js (hexoæ–‡ä»¶æœ‰bug) è¯ä¹¦é”™è¯¯ï¼Œä¸æ˜¯ç§å¯†è¿æ¥Githubå»ºç«™å¥½ä¹‹åï¼Œç»å¸¸ä¼šç¢°åˆ°æ‰“å¼€é¡µé¢æµè§ˆå™¨æ˜¾ç¤ºä¸æ˜¯ç§å¯†é“¾æ¥çš„æƒ…å†µï¼Œæœæ¥æœå»ï¼Œè¯´æ˜¯GitHubçš„SSLè¯ä¹¦ä¸ç¨³å®šï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å¢™çš„åŸå› ã€‚ æœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥è§£å†³ï¼šä¸€æ˜¯ç”³è¯· cloudfare çš„å…è´¹è¯ä¹¦ï¼ŒäºŒæ˜¯è‡ªå·±ä¹°è¯ä¹¦ï¼Œä¸¤ç§æ–¹æ³•éƒ½ä»‹ç»ä»¥ä¸‹ æ–¹æ³•ä¸€ï¼š æŸå®ä¹°è¯ä¹¦å»æŸå®ä¹°äº†è¯ä¹¦ï¼Œï¼ˆp.s. ä¸å·®é’±ä¹Ÿå¯ä»¥ç›´æ¥ä¹°é˜¿é‡Œäº‘çš„è¯ä¹¦ï¼Œä¸¤å¹´2000å¤šï¼‰ï¼Œè¯ä¹¦æ˜¯æœ‰æœ‰æ•ˆæœŸçš„ï¼Œæˆ‘ä¹°çš„é‚£å®¶è¯ä¹¦ä¸€å¹´80å…ƒï¼Œä¸¤å¹´140å…ƒï¼Œ5å¹´300å…ƒã€‚é€‰ä¸ªè‡ªå·±èƒ½æ¥å—ï¼Œä¸å¤ªè´µçš„ä»·æ ¼å³å¯ã€‚ä¸€èˆ¬é”€é‡é«˜çš„åº—å®¶éƒ½æœ‰æ•™ä½ æ€ä¹ˆé…ç½®ï¼Œæˆ‘è¿™é‡ŒæŠŠå…¶é…ç½®è®°å½•äº†ä¸‹æ¥ï¼š 1. åœ¨ Github Page ä¸Šå–æ¶ˆå‹¾é€‰ Enforce HTTPS æœåŠ¡ä½ç½®å¦‚ä¸‹å›¾ï¼š 2. å°†ä¹°åˆ°çš„è¯ä¹¦åœ¨é˜¿é‡Œäº‘ä¸Šè®¾ç½®å¦‚ä¸‹å›¾é¡ºåºè®¾ç½®ä¾¿å¯å®Œæˆï¼š æ–¹æ³•äºŒï¼šè¹­ cloudfare çš„å…è´¹è¯ä¹¦1. ç”³è¯·ä¸ª cloudfare è´¦å·ï¼Œå¹¶æ·»åŠ DNScloudfare æˆ‘çš„cloudfareæ˜¯ä»¥å‰æ³¨å†Œçš„ï¼Œå¿˜äº†ä¸€æ­¥æ­¥æˆªå›¾ï¼Œä½†æœ‰ä¸­æ–‡ç•Œé¢è·Ÿç€æç¤ºæ“ä½œå³å¯ï¼Œä¸ä¼šå¾ˆéš¾ï¼Œæ³¨å†Œå®Œæˆåï¼Œåœ¨ä»¥ä¸‹ç•Œé¢æ“ä½œï¼š æ‰¾åˆ°githubçš„ipv4çš„åœ°å€ä¸ºä»¥ä¸‹å‡ ä¸ªï¼Œä¹Ÿä¸çŸ¥é“è®¿é—®æ—¶ä¼šåˆ†é…åˆ°å“ªä¸ªipï¼Œç´¢æ€§Aç±»åœ°å€å…¨éƒ¨æ·»åŠ ä¸Šï¼Œåƒé˜¿é‡Œäº‘ä»¥ä¸‹ï¼ŒæŠŠ CHAME ç±»åœ°å€ä¹Ÿæ·»åŠ ä¸Šï¼Œå¦‚ä¸‹ï¼š 2. è¿”å›é˜¿é‡Œäº‘æ·»åŠ  cloudfare ç”³è¯·çš„DNSæœåŠ¡å™¨","categories":[],"tags":[{"name":"Hexo","slug":"Hexo","permalink":"https://zyzy.info/tags/Hexo/"},{"name":"Github Page","slug":"Github-Page","permalink":"https://zyzy.info/tags/Github-Page/"}]}],"categories":[],"tags":[{"name":"esbuild","slug":"esbuild","permalink":"https://zyzy.info/tags/esbuild/"},{"name":"webpack","slug":"webpack","permalink":"https://zyzy.info/tags/webpack/"},{"name":"mono repo","slug":"mono-repo","permalink":"https://zyzy.info/tags/mono-repo/"},{"name":"yarn","slug":"yarn","permalink":"https://zyzy.info/tags/yarn/"},{"name":"lerna","slug":"lerna","permalink":"https://zyzy.info/tags/lerna/"},{"name":"conventional commit","slug":"conventional-commit","permalink":"https://zyzy.info/tags/conventional-commit/"},{"name":"React","slug":"React","permalink":"https://zyzy.info/tags/React/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://zyzy.info/tags/%E9%9D%A2%E8%AF%95/"},{"name":"Webæ€§èƒ½ä¼˜åŒ–","slug":"Webæ€§èƒ½ä¼˜åŒ–","permalink":"https://zyzy.info/tags/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"},{"name":"node cli","slug":"node-cli","permalink":"https://zyzy.info/tags/node-cli/"},{"name":"ssr","slug":"ssr","permalink":"https://zyzy.info/tags/ssr/"},{"name":"react","slug":"react","permalink":"https://zyzy.info/tags/react/"},{"name":"node","slug":"node","permalink":"https://zyzy.info/tags/node/"},{"name":"ES6","slug":"ES6","permalink":"https://zyzy.info/tags/ES6/"},{"name":"ESM","slug":"ESM","permalink":"https://zyzy.info/tags/ESM/"},{"name":"CJS","slug":"CJS","permalink":"https://zyzy.info/tags/CJS/"},{"name":"eventEmitter","slug":"eventEmitter","permalink":"https://zyzy.info/tags/eventEmitter/"},{"name":"npm package","slug":"npm-package","permalink":"https://zyzy.info/tags/npm-package/"},{"name":"JWT","slug":"JWT","permalink":"https://zyzy.info/tags/JWT/"},{"name":"Token","slug":"Token","permalink":"https://zyzy.info/tags/Token/"},{"name":"HOC","slug":"HOC","permalink":"https://zyzy.info/tags/HOC/"},{"name":"Webpack","slug":"Webpack","permalink":"https://zyzy.info/tags/Webpack/"},{"name":"Vue","slug":"Vue","permalink":"https://zyzy.info/tags/Vue/"},{"name":"Electron","slug":"Electron","permalink":"https://zyzy.info/tags/Electron/"},{"name":"åç«¯","slug":"åç«¯","permalink":"https://zyzy.info/tags/%E5%90%8E%E7%AB%AF/"},{"name":"Nginx","slug":"Nginx","permalink":"https://zyzy.info/tags/Nginx/"},{"name":"åå‘ä»£ç†","slug":"åå‘ä»£ç†","permalink":"https://zyzy.info/tags/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"},{"name":"Dart","slug":"Dart","permalink":"https://zyzy.info/tags/Dart/"},{"name":"flutter","slug":"flutter","permalink":"https://zyzy.info/tags/flutter/"},{"name":"Flutter","slug":"Flutter","permalink":"https://zyzy.info/tags/Flutter/"},{"name":"è·¨ç«¯","slug":"è·¨ç«¯","permalink":"https://zyzy.info/tags/%E8%B7%A8%E7%AB%AF/"},{"name":"type script","slug":"type-script","permalink":"https://zyzy.info/tags/type-script/"},{"name":"ES","slug":"ES","permalink":"https://zyzy.info/tags/ES/"},{"name":"Babel","slug":"Babel","permalink":"https://zyzy.info/tags/Babel/"},{"name":"Type Script","slug":"Type-Script","permalink":"https://zyzy.info/tags/Type-Script/"},{"name":"React Query","slug":"React-Query","permalink":"https://zyzy.info/tags/React-Query/"},{"name":"Swagger UI","slug":"Swagger-UI","permalink":"https://zyzy.info/tags/Swagger-UI/"},{"name":"Nodejs","slug":"Nodejs","permalink":"https://zyzy.info/tags/Nodejs/"},{"name":"swagger-jsdoc","slug":"swagger-jsdoc","permalink":"https://zyzy.info/tags/swagger-jsdoc/"},{"name":"React Hooks","slug":"React-Hooks","permalink":"https://zyzy.info/tags/React-Hooks/"},{"name":"IntersectionObserver","slug":"IntersectionObserver","permalink":"https://zyzy.info/tags/IntersectionObserver/"},{"name":"CDN","slug":"CDN","permalink":"https://zyzy.info/tags/CDN/"},{"name":"GraphQL","slug":"GraphQL","permalink":"https://zyzy.info/tags/GraphQL/"},{"name":"Hexo","slug":"Hexo","permalink":"https://zyzy.info/tags/Hexo/"},{"name":"Github Page","slug":"Github-Page","permalink":"https://zyzy.info/tags/Github-Page/"}]}